{"paragraphs":[{"text":"import org.apache.spark.sql.expressions.Window;\r\nimport org.apache.spark.sql.types.TimestampType;\r\n// import org.apache.spark.sql.expressions.Window","user":"anonymous","dateUpdated":"2020-03-20T06:48:15+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.expressions.Window\nimport org.apache.spark.sql.types.TimestampType\n"}]},"apps":[],"jobName":"paragraph_1583209125392_1390109426","id":"20200229-023639_871760853","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T06:48:15+0000","dateFinished":"2020-03-20T06:48:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:261"},{"text":"//Get the bus_parent.csv into a dataframe \nvar bus_parent_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/bus_parent.csv\");\nbus_parent_df = bus_parent_df.select(\n            bus_parent_df.col(\"PARENT_ID\").as(\"PARENT_BUS_ID\"),\n            bus_parent_df.col(\"BUS_ID\").as(\"HIER_BUS_ID\")\n    );\nbus_parent_df.show();","user":"anonymous","dateUpdated":"2020-03-20T06:39:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-----------+\n|PARENT_BUS_ID|HIER_BUS_ID|\n+-------------+-----------+\n|         1914|       5793|\n|        14748|       9873|\n|         1914|      10354|\n|         1914|      10615|\n|         1914|      11376|\n|        29710|      11839|\n|        29710|      11840|\n|         1914|      11841|\n|         1914|      11895|\n|        34872|      11896|\n|         1914|      12175|\n|         1914|      13615|\n|         1914|      14035|\n|         1914|      14655|\n|        29710|      14912|\n|        29710|      14913|\n|        29710|      14923|\n|        29710|      14924|\n|        29710|      14925|\n|        29710|      14929|\n+-------------+-----------+\nonly showing top 20 rows\n\nbus_parent_df: org.apache.spark.sql.DataFrame = [PARENT_BUS_ID: string, HIER_BUS_ID: string]\nbus_parent_df: org.apache.spark.sql.DataFrame = [PARENT_BUS_ID: string, HIER_BUS_ID: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=0","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1583209125393_-1216793151","id":"20200226-060757_2141589333","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T06:39:00+0000","dateFinished":"2020-03-20T06:39:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:262"},{"text":"//Get the customer.csv into a dataframe \nvar customer_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/customer.csv\");\ncustomer_df = customer_df.select(\n            customer_df.col(\"RECONCILIATION_ID\"),\n            customer_df.col(\"BUS_ID\").as(\"BUS_ID\")\n    );\ncustomer_df.show();","user":"anonymous","dateUpdated":"2020-03-20T06:44:38+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------+\n|   RECONCILIATION_ID|BUS_ID|\n+--------------------+------+\n|OI-FDF0CAB69CEF11...| 37146|\n|OI-D723D6129D9911...| 38023|\n|OI-6E3509E09CF011...| 16715|\n|OI-343704B49CF011...| 19922|\n|OI-6F5224DE9CF011...| 37373|\n|OI-3170ECAE9CF011...| 35140|\n|OI-7E74093C9CF011...| 35663|\n|OI-64074C4E9CF011...| 34807|\n|OI-8A2BBAF49DA411...| 38177|\n|OI-498348969CF011...| 35562|\n|OI-6D8C65069CF011...| 34821|\n|OI-8698CEEA9CF011...| 27010|\n|OI-1A354A3A9CF011...| 35574|\n|OI-6BD775709CF011...| 36024|\n|OI-3F5DC0F89CF011...| 35310|\n|OI-7F198BE69DA411...| 32710|\n|OI-8943417A9DA411...| 35383|\n|OI-39EFEBAA9CF011...| 35376|\n|OI-0406791E9CF011...| 37018|\n|OI-1AEC4C3A9CF011...| 10615|\n+--------------------+------+\nonly showing top 20 rows\n\ncustomer_df: org.apache.spark.sql.DataFrame = [RECONCILIATION_ID: string, BUS_ID: string]\ncustomer_df: org.apache.spark.sql.DataFrame = [RECONCILIATION_ID: string, BUS_ID: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=4","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=5"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1583209125394_1839209746","id":"20200226-060821_1073898764","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T06:44:39+0000","dateFinished":"2020-03-20T06:44:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:263"},{"text":"//Get the device.csv into a dataframe \nvar device_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/device.csv\");\ndevice_df = device_df.select(\n            device_df.col(\"TARGET_ID\").as(\"DEVICE_TARGET_ID\"),\n            device_df.col(\"RECON_ID\")\n    )\ndevice_df.show();","user":"anonymous","dateUpdated":"2020-03-20T06:44:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+--------------+\n|DEVICE_TARGET_ID|      RECON_ID|\n+----------------+--------------+\n|            2777|PREATLAS_22811|\n|            2778|PREATLAS_22811|\n|            2779|PREATLAS_22811|\n|            2780|PREATLAS_22811|\n|            2781|PREATLAS_22811|\n|            2782|PREATLAS_22811|\n|            2783|PREATLAS_22811|\n|            2784|PREATLAS_22811|\n|            2785|PREATLAS_22811|\n|            2786|PREATLAS_22811|\n|            2787|PREATLAS_22811|\n|            2788|PREATLAS_22811|\n|            2789|PREATLAS_22811|\n|            2790|PREATLAS_22811|\n|            2791|PREATLAS_22811|\n|            2792|PREATLAS_22811|\n|            2793|PREATLAS_22811|\n|            2794|PREATLAS_22811|\n|            2795|PREATLAS_22811|\n|            2796|PREATLAS_22811|\n+----------------+--------------+\nonly showing top 20 rows\n\ndevice_df: org.apache.spark.sql.DataFrame = [DEVICE_TARGET_ID: string, RECON_ID: string]\ndevice_df: org.apache.spark.sql.DataFrame = [DEVICE_TARGET_ID: string, RECON_ID: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=6","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=7"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1583209125394_272449346","id":"20200226-060859_2104217724","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T06:44:45+0000","dateFinished":"2020-03-20T06:44:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:264"},{"text":"//Get the device_location.csv into a dataframe \nvar device_location_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/device_location.csv\");\ndevice_location_df = device_location_df.select(\n    col(\"BUS_ID\").as(\"BUS_ID_DEV\"),\n    col(\"DEVICE_TYPE\"),\n    col(\"OPERATING_SYSTEM\"),\n    col(\"RECONCILIATION_ID\"),\n    col(\"SITE\"),\n    col(\"TYPE_NAME\"),\n    col(\"IS_VIRTUAL\")\n    );\ndevice_location_df.show();","user":"anonymous","dateUpdated":"2020-03-20T08:52:40+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\n|BUS_ID_DEV|         DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|                SITE|           TYPE_NAME|IS_VIRTUAL|\n+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\n|     37146|   RAIDStorageDevice|            null|OI-FDF0CAB69CEF11...| MM-400 Minuteman Rd|   RAIDStorageDevice|         N|\n|     38023|              Server|            null|OI-D723D6129D9911...| MM-400 Minuteman Rd|              Server|         Y|\n|     16715|              Server|            null|OI-6E3509E09CF011...|    RHUK01-Unit 3 St|              Server|         Y|\n|     19922|              Router|            null|OI-343704B49CF011...| MM-400 Minuteman Rd|              Router|         N|\n|     37373|              Server|            null|OI-6F5224DE9CF011...| MM-400 Minuteman Rd|              Server|         Y|\n|     35140|              Switch|            null|OI-3170ECAE9CF011...| MM-400 Minuteman Rd|              Switch|         N|\n|     35663|       Load Balancer|            null|OI-7E74093C9CF011...|WOKING-Digital Re...|       Load Balancer|         Y|\n|     34807|              Server|            null|OI-64074C4E9CF011...| MM-400 Minuteman Rd|              Server|         Y|\n|     38177|Link Aggregation Tap|            null|OI-8A2BBAF49DA411...| MM-400 Minuteman Rd|Link Aggregation Tap|         N|\n|     35562|              Server|            null|OI-498348969CF011...|SCCA130-2805 Lafa...|              Server|         Y|\n|     34821|              Switch|            null|OI-6D8C65069CF011...| MM-400 Minuteman Rd|              Switch|         N|\n|     27010|              Server|            null|OI-8698CEEA9CF011...| MM-400 Minuteman Rd|              Server|         N|\n|     35574|             Network|            null|OI-1A354A3A9CF011...| MM-400 Minuteman Rd|             Network|         N|\n|     36024|              Server|            null|OI-6BD775709CF011...| MM-400 Minuteman Rd|              Server|         Y|\n|     35310|              Server|            null|OI-3F5DC0F89CF011...|    RHUK01-Unit 3 St|              Server|         N|\n|     32710|            Firewall|            null|OI-7F198BE69DA411...|LOUK01-East India...|            Firewall|         N|\n|     35383|              Router|            null|OI-8943417A9DA411...| MM-400 Minuteman Rd|              Router|         N|\n|     35376|     Processing unit|            null|OI-39EFEBAA9CF011...| MM-400 Minuteman Rd|     Processing unit|         N|\n|     37018|              Server|            null|OI-0406791E9CF011...|SCCA120-2805 Lafa...|              Server|         Y|\n|     10615|              Server|            null|OI-1AEC4C3A9CF011...| MM-400 Minuteman Rd|              Server|         N|\n+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\ndevice_location_df: org.apache.spark.sql.DataFrame = [BUS_ID_DEV: string, DEVICE_TYPE: string ... 5 more fields]\ndevice_location_df: org.apache.spark.sql.DataFrame = [BUS_ID_DEV: string, DEVICE_TYPE: string ... 5 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=223","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=224"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1583209125395_-239952028","id":"20200226-060859_1373866278","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T08:52:40+0000","dateFinished":"2020-03-20T08:52:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:265"},{"text":"// get distinct site values\nval distinctSiteVals = device_location_df.select(\"SITE\").distinct().toDF(\"distinct_site\").sort(asc(\"distinct_site\"))","user":"anonymous","dateUpdated":"2020-03-20T08:52:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"distinctSiteVals: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [distinct_site: string]\n"}]},"apps":[],"jobName":"paragraph_1584692152655_1322596595","id":"20200320-081552_133888429","dateCreated":"2020-03-20T08:15:52+0000","dateStarted":"2020-03-20T08:52:58+0000","dateFinished":"2020-03-20T08:52:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:266"},{"text":"distinctSiteVals.show(distinctSiteVals.count().toInt, false)","user":"anonymous","dateUpdated":"2020-03-20T08:52:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------------------------------------------+\n|distinct_site                                        |\n+-----------------------------------------------------+\n|null                                                 |\n|-Clarendon House                                     |\n|1914-100 Brickstone Sq                               |\n|1914-Thameside House                                 |\n|200MM-200 Minuteman Rd                               |\n|35562-230 Park Ave Fl 12                             |\n|38376-Artisan                                        |\n|ASVA1-21711 Filigree Ct                              |\n|ATGA1-2300 Windy Ridge Pkwy SE Ste 695S              |\n|Azure - Canada Central                               |\n|Azure - Central US                                   |\n|Azure - East US                                      |\n|Azure - East US 2                                    |\n|Azure - North Europe                                 |\n|Azure - Southeast Asia                               |\n|Azure - West Europe                                  |\n|BAMD-10 E Baltimore St Ste 1000                      |\n|CHIL01-725 S Wells St Ste 300                        |\n|CHIL2-350 E Cermak Rd                                |\n|DLTX01-1950 N Stemmons Fwy Ste 1032 # DLTX01         |\n|GUIN01-Fl 1 Golf Course Road                         |\n|GUIN02-St Floor                                      |\n|HNTX02-1301 Fannin St Ste 700                        |\n|LACA01-1200 W 7th St Ste 130                         |\n|LOUK01-East India Dock House                         |\n|LOUK02 - Telehouse                                   |\n|LOUK04-Kbc Exchange                                  |\n|LOUK05-240 East India Dock Road                      |\n|LVNV01-7185 Pollock Dr                               |\n|MENTORRMM-331 2nd Ave S Ste 540                      |\n|MIMN01-1200 Washington Ave S                         |\n|MM - 400 Minuteman Road                              |\n|MM-400 Minuteman Rd                                  |\n|MMSB-400 Minuteman Rd                                |\n|MSFT-MicroSoft Azure                                 |\n|NCDANMA-400 Minuteman Road                           |\n|NCDSCCA-2805 Lafayette St                            |\n|NCDWOUK-Digital Realty                               |\n|NYNY01-395 Hudson St Frnt 3                          |\n|OAIL01-800 Jorie Blvd Ste 120 # OAIL01               |\n|PACA1 - PAIX                                         |\n|REMOTE DC - Non-NaviSite/Customer-Managed Datacenters|\n|REMOTE DC-Non-NaviSite/Customer-Managed Datacenters  |\n|REVA1-12007 Sunrise Valley Dr Ste 375                |\n|RHUK01 - Digital Realty/Navisite                     |\n|RHUK01-Unit 3 St                                     |\n|SCCA02 - Former CXN facility                         |\n|SCCA110-2805 Lafayette St                            |\n|SCCA120 - 2805 Lafayette St                          |\n|SCCA120-2805 Lafayette St                            |\n|SCCA130 - 2805 Lafayette St                          |\n|SCCA130-2805 Lafayette St                            |\n|SDCA01-9725 Scranton Rd Ste 100                      |\n|SFCA01-650 Townsend St Ste 180                       |\n|SIRVA Abu Dubai DC                                   |\n|SIRVA Adelaide DC                                    |\n|SIRVA Auckland DC                                    |\n|SIRVA Battery Park DC                                |\n|SIRVA Beijing DC                                     |\n|SIRVA Brisbane - Richlands DC                        |\n|SIRVA Brisbane - Salisbury DC                        |\n|SIRVA Canberra DC                                    |\n|SIRVA Cheshire DC                                    |\n|SIRVA Chicago DC                                     |\n|SIRVA Christchurch DC                                |\n|SIRVA Cleveland DC                                   |\n|SIRVA Dandenong DC                                   |\n|SIRVA Darwin  DC                                     |\n|SIRVA Devonport DC                                   |\n|SIRVA Dubai DC                                       |\n|SIRVA Dubai WH DC                                    |\n|SIRVA Dunedin DC                                     |\n|SIRVA Edmonton DC                                    |\n|SIRVA Fort Wayne - DT DC                             |\n|SIRVA Fort Wayne US30 DC                             |\n|SIRVA GM - Michigan DC                               |\n|SIRVA Gladstone DC                                   |\n|SIRVA Guangzhou DC                                   |\n|SIRVA Hamilton DC                                    |\n|SIRVA Hobart DC                                      |\n|SIRVA Hoboken DC                                     |\n|SIRVA Hong Kong DC                                   |\n|SIRVA Kalgoorlie DC                                  |\n|SIRVA Keppel Towers DC                               |\n|SIRVA Kuala Lumpur DC                                |\n|SIRVA Lebour DC                                      |\n|SIRVA Manila DC                                      |\n|SIRVA Munich DC                                      |\n|SIRVA Nelson DC                                      |\n|SIRVA New York City DC                               |\n|SIRVA Next DC                                        |\n|SIRVA Onx DC                                         |\n|SIRVA Palmerston North DC                            |\n|SIRVA Perth SR DC                                    |\n|SIRVA Plymouth DC                                    |\n|SIRVA Port Headland DC                               |\n|SIRVA Prague DC                                      |\n|SIRVA San Ramon DC                                   |\n|SIRVA Shanghai DC                                    |\n|SIRVA South Geelong DC                               |\n|SIRVA South Melbourne DC                             |\n|SIRVA St. Louis DC                                   |\n|SIRVA Sunshine Coast DC                              |\n|SIRVA Swindon DC                                     |\n|SIRVA Sydney Pemulway DC                             |\n|SIRVA Sydney Smithfield DC                           |\n|SIRVA Tauranga DC                                    |\n|SIRVA Timaru DC                                      |\n|SIRVA Tokyo DC                                       |\n|SIRVA Toronto DC                                     |\n|SIRVA Walmart DC                                     |\n|SIRVA Wellington DC                                  |\n|SIRVA Welshpool DC                                   |\n|SJ-2720 Zanker Rd                                    |\n|SYNY01 - 125 Elwood Davis Road                       |\n|SYNY01-125 Elwood Davis Rd                           |\n|SYNY02-224 Harrison St                               |\n|SYNY03-100 Elwood Davis Rd                           |\n|TOCA1 - Cologix                                      |\n|TOCA1-905 King Street West Cologix                   |\n|Topps -Brazil Office                                 |\n|Topps -Germany Office                                |\n|Topps -India Office                                  |\n|Topps -Italy Office                                  |\n|Topps -Milton Keynes-UK Office                       |\n|Topps -New York Office                               |\n|Topps -Richmond-UK Office                            |\n|Topps -Scranton-PA Office                            |\n|VACA1 - Cologix                                      |\n|VACA1-Cologix                                        |\n|VIVA01-8619 Westwood Center Dr Ste 200 # VIVA01      |\n|WLMA01-187 Ballardvale St Bldg B                     |\n|WOKING - Digital Realty                              |\n|WOKING-Digital Realty                                |\n+-----------------------------------------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=228","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=229","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=230"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584692211856_387123564","id":"20200320-081651_307346347","dateCreated":"2020-03-20T08:16:51+0000","dateStarted":"2020-03-20T08:53:00+0000","dateFinished":"2020-03-20T08:53:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:267"},{"text":"// clean SITE values by 1. removing leading and trailing space; 2.\ndevice_location_df =  device_location_df.withColumn(\"SITE\" ,regexp_replace(col(\"SITE\"), \" - \", \"-\"))\ndevice_location_df =  device_location_df.withColumn(\"SITE\" ,regexp_replace(col(\"SITE\"), \" -\", \"-\"))\ndevice_location_df =  device_location_df.withColumn(\"SITE\" ,regexp_replace(col(\"SITE\"), \"MM-400 Minuteman Road\", \"MM-400 Minuteman Rd\"))\ndevice_location_df =  device_location_df.withColumn(\"SITE\" ,regexp_replace(col(\"SITE\"), \"-Clarendon House\", \"Clarendon House\"))","user":"anonymous","dateUpdated":"2020-03-20T08:55:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"device_location_df: org.apache.spark.sql.DataFrame = [BUS_ID_DEV: string, DEVICE_TYPE: string ... 5 more fields]\ndevice_location_df: org.apache.spark.sql.DataFrame = [BUS_ID_DEV: string, DEVICE_TYPE: string ... 5 more fields]\ndevice_location_df: org.apache.spark.sql.DataFrame = [BUS_ID_DEV: string, DEVICE_TYPE: string ... 5 more fields]\ndevice_location_df: org.apache.spark.sql.DataFrame = [BUS_ID_DEV: string, DEVICE_TYPE: string ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1584692349312_1878369173","id":"20200320-081909_66271464","dateCreated":"2020-03-20T08:19:09+0000","dateStarted":"2020-03-20T08:55:59+0000","dateFinished":"2020-03-20T08:55:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:268"},{"text":"val distinctSiteVals_clean = device_location_df.select(\"SITE\").distinct().toDF(\"distinct_site\").sort(asc(\"distinct_site\"))\ndistinctSiteVals_clean.show(distinctSiteVals_clean.count().toInt, false)","user":"anonymous","dateUpdated":"2020-03-20T08:56:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------------------------------------+\n|distinct_site                                      |\n+---------------------------------------------------+\n|null                                               |\n|1914-100 Brickstone Sq                             |\n|1914-Thameside House                               |\n|200MM-200 Minuteman Rd                             |\n|35562-230 Park Ave Fl 12                           |\n|38376-Artisan                                      |\n|ASVA1-21711 Filigree Ct                            |\n|ATGA1-2300 Windy Ridge Pkwy SE Ste 695S            |\n|Azure-Canada Central                               |\n|Azure-Central US                                   |\n|Azure-East US                                      |\n|Azure-East US 2                                    |\n|Azure-North Europe                                 |\n|Azure-Southeast Asia                               |\n|Azure-West Europe                                  |\n|BAMD-10 E Baltimore St Ste 1000                    |\n|CHIL01-725 S Wells St Ste 300                      |\n|CHIL2-350 E Cermak Rd                              |\n|Clarendon House                                    |\n|DLTX01-1950 N Stemmons Fwy Ste 1032 # DLTX01       |\n|GUIN01-Fl 1 Golf Course Road                       |\n|GUIN02-St Floor                                    |\n|HNTX02-1301 Fannin St Ste 700                      |\n|LACA01-1200 W 7th St Ste 130                       |\n|LOUK01-East India Dock House                       |\n|LOUK02-Telehouse                                   |\n|LOUK04-Kbc Exchange                                |\n|LOUK05-240 East India Dock Road                    |\n|LVNV01-7185 Pollock Dr                             |\n|MENTORRMM-331 2nd Ave S Ste 540                    |\n|MIMN01-1200 Washington Ave S                       |\n|MM-400 Minuteman Rd                                |\n|MMSB-400 Minuteman Rd                              |\n|MSFT-MicroSoft Azure                               |\n|NCDANMA-400 Minuteman Road                         |\n|NCDSCCA-2805 Lafayette St                          |\n|NCDWOUK-Digital Realty                             |\n|NYNY01-395 Hudson St Frnt 3                        |\n|OAIL01-800 Jorie Blvd Ste 120 # OAIL01             |\n|PACA1-PAIX                                         |\n|REMOTE DC-Non-NaviSite/Customer-Managed Datacenters|\n|REVA1-12007 Sunrise Valley Dr Ste 375              |\n|RHUK01-Digital Realty/Navisite                     |\n|RHUK01-Unit 3 St                                   |\n|SCCA02-Former CXN facility                         |\n|SCCA110-2805 Lafayette St                          |\n|SCCA120-2805 Lafayette St                          |\n|SCCA130-2805 Lafayette St                          |\n|SDCA01-9725 Scranton Rd Ste 100                    |\n|SFCA01-650 Townsend St Ste 180                     |\n|SIRVA Abu Dubai DC                                 |\n|SIRVA Adelaide DC                                  |\n|SIRVA Auckland DC                                  |\n|SIRVA Battery Park DC                              |\n|SIRVA Beijing DC                                   |\n|SIRVA Brisbane-Richlands DC                        |\n|SIRVA Brisbane-Salisbury DC                        |\n|SIRVA Canberra DC                                  |\n|SIRVA Cheshire DC                                  |\n|SIRVA Chicago DC                                   |\n|SIRVA Christchurch DC                              |\n|SIRVA Cleveland DC                                 |\n|SIRVA Dandenong DC                                 |\n|SIRVA Darwin  DC                                   |\n|SIRVA Devonport DC                                 |\n|SIRVA Dubai DC                                     |\n|SIRVA Dubai WH DC                                  |\n|SIRVA Dunedin DC                                   |\n|SIRVA Edmonton DC                                  |\n|SIRVA Fort Wayne US30 DC                           |\n|SIRVA Fort Wayne-DT DC                             |\n|SIRVA GM-Michigan DC                               |\n|SIRVA Gladstone DC                                 |\n|SIRVA Guangzhou DC                                 |\n|SIRVA Hamilton DC                                  |\n|SIRVA Hobart DC                                    |\n|SIRVA Hoboken DC                                   |\n|SIRVA Hong Kong DC                                 |\n|SIRVA Kalgoorlie DC                                |\n|SIRVA Keppel Towers DC                             |\n|SIRVA Kuala Lumpur DC                              |\n|SIRVA Lebour DC                                    |\n|SIRVA Manila DC                                    |\n|SIRVA Munich DC                                    |\n|SIRVA Nelson DC                                    |\n|SIRVA New York City DC                             |\n|SIRVA Next DC                                      |\n|SIRVA Onx DC                                       |\n|SIRVA Palmerston North DC                          |\n|SIRVA Perth SR DC                                  |\n|SIRVA Plymouth DC                                  |\n|SIRVA Port Headland DC                             |\n|SIRVA Prague DC                                    |\n|SIRVA San Ramon DC                                 |\n|SIRVA Shanghai DC                                  |\n|SIRVA South Geelong DC                             |\n|SIRVA South Melbourne DC                           |\n|SIRVA St. Louis DC                                 |\n|SIRVA Sunshine Coast DC                            |\n|SIRVA Swindon DC                                   |\n|SIRVA Sydney Pemulway DC                           |\n|SIRVA Sydney Smithfield DC                         |\n|SIRVA Tauranga DC                                  |\n|SIRVA Timaru DC                                    |\n|SIRVA Tokyo DC                                     |\n|SIRVA Toronto DC                                   |\n|SIRVA Walmart DC                                   |\n|SIRVA Wellington DC                                |\n|SIRVA Welshpool DC                                 |\n|SJ-2720 Zanker Rd                                  |\n|SYNY01-125 Elwood Davis Rd                         |\n|SYNY01-125 Elwood Davis Road                       |\n|SYNY02-224 Harrison St                             |\n|SYNY03-100 Elwood Davis Rd                         |\n|TOCA1-905 King Street West Cologix                 |\n|TOCA1-Cologix                                      |\n|Topps-Brazil Office                                |\n|Topps-Germany Office                               |\n|Topps-India Office                                 |\n|Topps-Italy Office                                 |\n|Topps-Milton Keynes-UK Office                      |\n|Topps-New York Office                              |\n|Topps-Richmond-UK Office                           |\n|Topps-Scranton-PA Office                           |\n|VACA1-Cologix                                      |\n|VIVA01-8619 Westwood Center Dr Ste 200 # VIVA01    |\n|WLMA01-187 Ballardvale St Bldg B                   |\n|WOKING-Digital Realty                              |\n+---------------------------------------------------+\n\ndistinctSiteVals_clean: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [distinct_site: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=237","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=238","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=239"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584692394456_-1243270382","id":"20200320-081954_1302714552","dateCreated":"2020-03-20T08:19:54+0000","dateStarted":"2020-03-20T08:56:01+0000","dateFinished":"2020-03-20T08:56:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:269"},{"text":"//Get the parent.csv into a dataframe \nvar parent_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/parent.csv\");\n\nparent_df = parent_df.select(\n            parent_df.col(\"PARENT_ID\").as(\"PARENT_TARGET_ID\"),\n            parent_df.col(\"TARGET_ID\").as(\"CHILD_TARGET_ID\")\n    );","user":"anonymous","dateUpdated":"2020-03-20T06:44:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"parent_df: org.apache.spark.sql.DataFrame = [PARENT_TARGET_ID: string, CHILD_TARGET_ID: string]\nparent_df: org.apache.spark.sql.DataFrame = [PARENT_TARGET_ID: string, CHILD_TARGET_ID: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=10"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1583209125398_1492149861","id":"20200226-060858_614673072","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T06:44:58+0000","dateFinished":"2020-03-20T06:44:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:270"},{"text":"//Get the type.csv into a dataframe \nvar type_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/type.csv\");\n\ntype_df = type_df.select(\n            type_df.col(\"TARGET_ID\").as(\"MONITOR_ID\"),\n            type_df.col(\"TYPE\").as(\"MONITOR_DESC\")\n    );\n    ","user":"anonymous","dateUpdated":"2020-03-20T06:45:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"type_df: org.apache.spark.sql.DataFrame = [MONITOR_ID: string, MONITOR_DESC: string]\ntype_df: org.apache.spark.sql.DataFrame = [MONITOR_ID: string, MONITOR_DESC: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=11"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1583209125398_1361987988","id":"20200226-060858_967312711","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T06:45:04+0000","dateFinished":"2020-03-20T06:45:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:271"},{"text":"//Get the event_log.csv(partial) into a dataframe \nvar event_log_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/event.log.20190902031144_20000.csv\");\nevent_log_df = event_log_df.filter(\"policy_type != 'T'\" ).filter(\"metric_name != 'Started'\");\nevent_log_df.count()","user":"anonymous","dateUpdated":"2020-03-20T06:45:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_log_df: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 12 more fields]\nevent_log_df: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 12 more fields]\nres6: Long = 149\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=12","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=13"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1583209125399_-1901900209","id":"20200226-060855_595029811","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T06:45:09+0000","dateFinished":"2020-03-20T06:45:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:272"},{"text":"// Get the event_log.csv(whole set) into tp a dataframe\nvar event_log_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/event.log.20190902031144.csv\");\nevent_log_df = event_log_df.filter(\"policy_type != 'T'\" ).filter(\"metric_name != 'Started'\");\nevent_log_df.count()","user":"anonymous","dateUpdated":"2020-03-20T06:45:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_log_df: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 12 more fields]\nevent_log_df: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 12 more fields]\nres7: Long = 6675044\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=14","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=15"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1583273972618_-1815058812","id":"20200303-221932_1321605959","dateCreated":"2020-03-03T22:19:32+0000","dateStarted":"2020-03-20T06:45:15+0000","dateFinished":"2020-03-20T06:47:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:273"},{"text":"// get top customers from top_clients.csv\nvar top_clients_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/top_clients.csv\");\ntop_clients_df.show();","user":"anonymous","dateUpdated":"2020-03-20T06:48:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+------------------+-------+------------------+----+\n|NEW_BUS_ID|RECONCILIATION_NUM|PERCENT|CUMULATIVE_PERCENT|RANK|\n+----------+------------------+-------+------------------+----+\n|     34807|              2778|  0.049|             0.049|   1|\n|     35574|              2601|  0.046|             0.095|   2|\n|     35140|              2336|  0.041|             0.136|   3|\n|      1914|              1863|  0.033|             0.169|   4|\n|     29710|              1376|  0.024|             0.193|   5|\n|     32890|              1308|  0.023|             0.216|   6|\n|     35383|              1174|  0.021|             0.237|   7|\n|     11838|               659|  0.012|             0.248|   8|\n|     35821|               615|  0.011|             0.259|   9|\n|     33554|               612|  0.011|             0.270|  10|\n|     33617|               603|  0.011|             0.281|  11|\n|     15804|               592|  0.010|             0.291|  12|\n|     35340|               554|  0.010|             0.301|  13|\n|     36973|               544|  0.010|             0.311|  14|\n|     35562|               521|  0.009|             0.320|  15|\n|     35698|               435|  0.008|             0.327|  16|\n|     11876|               429|  0.008|             0.335|  17|\n|     16715|               405|  0.007|             0.342|  18|\n|     35183|               373|  0.007|             0.349|  19|\n|     14748|               325|  0.006|             0.354|  20|\n+----------+------------------+-------+------------------+----+\nonly showing top 20 rows\n\ntop_clients_df: org.apache.spark.sql.DataFrame = [NEW_BUS_ID: string, RECONCILIATION_NUM: string ... 3 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=16","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=17"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1583209125400_1758443770","id":"20200226-063855_62253060","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T06:48:22+0000","dateFinished":"2020-03-20T06:48:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:274"},{"text":"// Get EventCode and an associated intger mapping\nvar event_code_mapped = event_log_df.select(\"event_code\").distinct();\nevent_code_mapped = event_code_mapped.withColumn(\"event_code_id\", row_number().over(Window.orderBy(\"event_code\")));\nevent_code_mapped = event_code_mapped.select(\n         event_code_mapped.col(\"event_code_id\"),\n       event_code_mapped.col(\"event_code\").as(\"mapping_event_code\")\n    )\n    \nregexp_replace(event_code_mapped(\"mapping_event_code\"),\"\\\\s+\",\" \");","user":"anonymous","dateUpdated":"2020-03-20T06:48:27+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: int, mapping_event_code: string]\nevent_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: int, mapping_event_code: string]\nevent_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: int, mapping_event_code: string]\nres9: org.apache.spark.sql.Column = regexp_replace(mapping_event_code, \\s+,  )\n"}]},"apps":[],"jobName":"paragraph_1583209125400_576245102","id":"20200226-065423_868519549","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T06:48:28+0000","dateFinished":"2020-03-20T06:48:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:275"},{"text":"event_code_mapped.show()","user":"anonymous","dateUpdated":"2020-03-20T06:48:31+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+------------------+\n|event_code_id|mapping_event_code|\n+-------------+------------------+\n|            1|           APPL-72|\n|            2|            ESM-18|\n|            3|            ESM-51|\n|            4|            ESM-70|\n|            5|            ESM-71|\n|            6|            ESM-72|\n|            7|            ESM-73|\n|            8|         INSYNC-01|\n|            9|            ISM-01|\n|           10|            ISM-02|\n|           11|            ISM-04|\n|           12|            ISM-05|\n|           13|            ISM-06|\n|           14|            ISM-08|\n|           15|            ISM-15|\n|           16|            ISM-18|\n|           17|            ISM-19|\n|           18|            ISM-20|\n|           19|            ISM-30|\n|           20|            ISM-50|\n+-------------+------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=18"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1583209125400_-1199548336","id":"20200229-021209_2085882877","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T06:48:32+0000","dateFinished":"2020-03-20T06:50:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:276"},{"text":"var device_event_log = event_log_df.join(device_df, event_log_df.col(\"TARGET_ID\") === device_df.col(\"DEVICE_TARGET_ID\"), \"inner\")\n                            .drop(\"DEVICE_TARGET_ID\");\n// device_event_log.count();// : 47\ndevice_event_log.show();","user":"anonymous","dateUpdated":"2020-03-20T06:51:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+\n|destination| core_time|poller_time|target_id|policy_id|policy_type|detected_severity|propagated_severity|low_threshold|measured_value|high_threshold|propagated_flag|event_code|metric_name|            RECON_ID|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+\n|          1|1567408594| 1567408593|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567408894| 1567408893|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567409194| 1567409193|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567409494| 1567409493|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567409794| 1567409793|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567413394| 1567413393|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567413694| 1567413693|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567413994| 1567413993|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567414294| 1567414293|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567414594| 1567414593|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567414894| 1567414893|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567415194| 1567415193|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567415494| 1567415493|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567415794| 1567415793|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567416094| 1567416093|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567416394| 1567416393|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567416694| 1567416693|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567416994| 1567416993|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567417294| 1567417293|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n|          1|1567417594| 1567417593|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+\nonly showing top 20 rows\n\ndevice_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 13 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=19"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1583209125401_1483277987","id":"20200226-072006_528594224","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T06:51:59+0000","dateFinished":"2020-03-20T06:55:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:277"},{"text":"var cust_device_event_log = device_event_log\n    .join(customer_df, device_event_log.col(\"RECON_ID\") === customer_df.col(\"RECONCILIATION_ID\"), \"inner\").drop(\"RECONCILIATION_ID\");\n//  cust_device_event_log.count(); // 47\ncust_device_event_log.show();","user":"anonymous","dateUpdated":"2020-03-20T06:58:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+\n|destination| core_time|poller_time|target_id|policy_id|policy_type|detected_severity|propagated_severity|low_threshold|measured_value|high_threshold|propagated_flag|event_code|metric_name|            RECON_ID|BUS_ID|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+\n|          1|1567411594| 1567411593|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567411894| 1567411893|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567412194| 1567412193|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567412494| 1567412493|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567412794| 1567412793|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567413094| 1567413093|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567408594| 1567408593|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567408894| 1567408893|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567409194| 1567409193|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567409494| 1567409493|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567409794| 1567409793|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567413394| 1567413393|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567413694| 1567413693|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567413994| 1567413993|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567414294| 1567414293|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567414594| 1567414593|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567418194| 1567418193|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567418494| 1567418493|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567418794| 1567418793|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n|          1|1567419094| 1567419093|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+\nonly showing top 20 rows\n\ncust_device_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 14 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=20","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=21"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1583209125401_883896947","id":"20200226-075401_853406802","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T06:58:04+0000","dateFinished":"2020-03-20T07:01:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:278"},{"text":"var cust_detail_device_event_log = cust_device_event_log\n    .join(bus_parent_df, cust_device_event_log.col(\"BUS_ID\") === bus_parent_df.col(\"HIER_BUS_ID\"), \"left_outer\").drop(\"HIER_BUS_ID\");\ncust_detail_device_event_log.show();\n","user":"anonymous","dateUpdated":"2020-03-20T07:03:17+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+\n|destination| core_time|poller_time|target_id|policy_id|policy_type|detected_severity|propagated_severity|low_threshold|measured_value|high_threshold|propagated_flag|event_code|metric_name|            RECON_ID|BUS_ID|PARENT_BUS_ID|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+\n|          1|1567411594| 1567411593|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567411894| 1567411893|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567412194| 1567412193|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567412494| 1567412493|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567412794| 1567412793|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567413094| 1567413093|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567418194| 1567418193|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567418494| 1567418493|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567418794| 1567418793|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567419094| 1567419093|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567419394| 1567419393|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567424494| 1567424493|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567424794| 1567424793|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567425094| 1567425093|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567425394| 1567425393|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567425694| 1567425693|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567431094| 1567431093|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567431394| 1567431393|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567431694| 1567431693|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n|          1|1567431994| 1567431993|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+\nonly showing top 20 rows\n\ncust_detail_device_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 15 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=22","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=23","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=24"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1583209125402_790495700","id":"20200226-080124_1698475559","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T07:03:17+0000","dateFinished":"2020-03-20T07:06:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:279"},{"text":"var top_cust_detail_device_event_log = \ncust_detail_device_event_log.join(top_clients_df, cust_detail_device_event_log(\"BUS_ID\") === top_clients_df(\"NEW_BUS_ID\") || cust_detail_device_event_log(\"PARENT_BUS_ID\") === top_clients_df(\"NEW_BUS_ID\"), \"inner\").drop(\"CUMULATIVE_PERCENT\", \"RANK\", \"PERCENT\"); ","user":"anonymous","dateUpdated":"2020-03-20T07:07:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"top_cust_detail_device_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 17 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125403_-734859356","id":"20200229-022405_11824168","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T07:07:37+0000","dateFinished":"2020-03-20T07:07:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:280"},{"text":"top_cust_detail_device_event_log.show();\ntop_cust_detail_device_event_log.count();","user":"anonymous","dateUpdated":"2020-03-20T07:08:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.SparkException: Job 28 cancelled part of cancelled job group zeppelin-2F3Y18Z76-20200229-024822_1508795478\n  at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1661)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobCancellation(DAGScheduler.scala:1596)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply$mcVI$sp(DAGScheduler.scala:811)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:811)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:811)\n  at scala.collection.mutable.HashSet.foreach(HashSet.scala:78)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobGroupCancelled(DAGScheduler.scala:811)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1851)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1831)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1820)\n  at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n  at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:642)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2034)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2055)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2074)\n  at org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:363)\n  at org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n  at org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collectFromPlan(Dataset.scala:3284)\n  at org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2495)\n  at org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2495)\n  at org.apache.spark.sql.Dataset$$anonfun$51.apply(Dataset.scala:3265)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n  at org.apache.spark.sql.Dataset.withAction(Dataset.scala:3264)\n  at org.apache.spark.sql.Dataset.head(Dataset.scala:2495)\n  at org.apache.spark.sql.Dataset.take(Dataset.scala:2709)\n  at org.apache.spark.sql.Dataset.showString(Dataset.scala:254)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:729)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:688)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:697)\n  ... 47 elided\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=25","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=26","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=27","http://cluster-7b69-m.us-central1-b.c.cmu-rdx-2020.internal:4040/jobs/job?id=28"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1583209125403_813003408","id":"20200229-024822_1508795478","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T07:07:41+0000","dateFinished":"2020-03-20T07:07:57+0000","status":"ABORT","progressUpdateIntervalMs":500,"$$hashKey":"object:281"},{"text":"var top_cust_device_detail_event_log = top_cust_detail_device_event_log.join(device_location_df, top_cust_detail_device_event_log(\"RECON_ID\") === device_location_df(\"RECONCILIATION_ID\"), \"left_outer\").drop(\"BUS_ID_DEV\");","user":"anonymous","dateUpdated":"2020-03-20T07:08:07+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"top_cust_device_detail_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 23 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125404_136304909","id":"20200229-024946_1459553842","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T07:08:07+0000","dateFinished":"2020-03-20T07:08:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:282"},{"text":"var top_cust_device_monitor_event_log \n= top_cust_device_detail_event_log.join(parent_df, top_cust_device_detail_event_log(\"TARGET_ID\") === parent_df(\"CHILD_TARGET_ID\"), \"left_outer\").drop(\"CHILD_TARGET_ID\");","user":"anonymous","dateUpdated":"2020-03-20T07:08:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"top_cust_device_monitor_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 24 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125405_409572048","id":"20200229-030552_960796511","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-20T07:08:11+0000","dateFinished":"2020-03-20T07:08:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:283"},{"text":"top_cust_device_monitor_event_log.count();\ntop_cust_device_monitor_event_log.show();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+\n|DESTINATION| CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|            RECON_ID|BUS_ID|PARENT_BUS_ID|NEW_BUS_ID|RECONCILIATION_NUM|BUS_ID|    DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|                SITE|      TYPE_NAME|IS_VIRTUAL|PARENT_TARGET_ID|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+\n|          1|1567408304| 1567408304|  1868540|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-0B8933709CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-0B8933709CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408304| 1567408300|  2262378|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|OI-3E65DFB49CF011...| 11838|         null|     11838|               659| 11838|         Server|            null|OI-3E65DFB49CF011...| MM-400 Minuteman Rd|         Server|         N|            null|\n|          1|1567408304| 1567408304|  2131840|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-7E26ACDC9CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-7E26ACDC9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408304| 1567408304|  1547990|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-07D424569CF011...| 35672|         null|     35672|               111| 35672|Processing unit|            null|OI-07D424569CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408304| 1567408303|  2084968|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F53A1CBA9CEF11...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-F53A1CBA9CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408304| 1567408304|  1924187|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-38AAAA8C9CF011...| 35140|         null|     35140|              2336| 35140|Processing unit|            null|OI-38AAAA8C9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|\n|          1|1567408304| 1567408304|  1522543|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-E8B332D89CEF11...| 36027|        35574|     35574|              2601| 36027|Processing unit|            null|OI-E8B332D89CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408305| 1567408305|  2072090|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-ED76B0A69CEF11...| 36918|         null|     36918|                62| 36918|Processing unit|            null|OI-ED76B0A69CEF11...|SCCA130-2805 Lafa...|Processing unit|         Y|            null|\n|          1|1567408304| 1567408304|  1256994|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F52680389CEF11...| 34807|         null|     34807|              2778| 34807|Processing unit|            null|OI-F52680389CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408304| 1567408304|  1793904|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-84D85E229CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-84D85E229CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|\n|          1|1567408304| 1567408304|  2143559|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-4A1BF33E9CF011...| 19718|        34041|     34041|                82| 19718|Processing unit|            null|OI-4A1BF33E9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|\n|          1|1567408304| 1567408304|  1987081|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-F58BF5589CEF11...| 35698|         null|     35698|               435| 35698|         Server|            null|OI-F58BF5589CEF11...|WOKING-Digital Re...|         Server|         N|            null|\n|          1|1567408306| 1567408305|  2155212|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-7E9C17749CF011...| 37961|         null|     37961|               307| 37961|Processing unit|            null|OI-7E9C17749CF011...|    RHUK01-Unit 3 St|Processing unit|         Y|            null|\n|          1|1567408304| 1567408304|  2187477|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-53C9511A9CF011...| 34807|         null|     34807|              2778| 34807|Processing unit|            null|OI-53C9511A9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408305| 1567408304|  2095816|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-1DC9A6829CF011...| 22842|         null|     22842|                71| 22842|Processing unit|            null|OI-1DC9A6829CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408305| 1567408304|  1834560|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     PREATLAS_138792| 35140|         null|     35140|              2336| 35140|        CHASSIS|   VMWARE ESXi 6|     PREATLAS_138792|SCCA130 - 2805 La...|           null|         Y|            null|\n|          1|1567408305| 1567408305|  2247668|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-B2291F929E4E11...| 35563|        35664|     35664|               155| 35563|Processing unit|            null|OI-B2291F929E4E11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408305| 1567408305|  1423122|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-01AA97EA9CF011...| 35655|         null|     35655|               153| 35655|Processing unit|            null|OI-01AA97EA9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408304| 1567408304|  1614961|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-1B79482E9CF011...| 35140|         null|     35140|              2336| 35140|Processing unit|            null|OI-1B79482E9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408305| 1567408305|  2170316|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-3A3FD37C9CF011...| 37018|         null|     37018|               236| 37018|Processing unit|            null|OI-3A3FD37C9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1583209125405_-1610741895","id":"20200229-033940_2133138157","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:284"},{"text":"var event_logs_desc\n= top_cust_device_monitor_event_log.join(type_df, top_cust_device_monitor_event_log(\"TARGET_ID\") === type_df(\"MONITOR_ID\"), \"left_outer\").drop(\"MONITOR_ID\");","user":"anonymous","dateUpdated":"2020-03-03T22:47:32+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_logs_desc: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 25 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125406_-1290518672","id":"20200229-035222_303729447","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-03T22:47:33+0000","dateFinished":"2020-03-03T22:47:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:287"},{"text":"event_logs_desc.count();\nevent_logs_desc.show();\n","user":"anonymous","dateUpdated":"2020-03-04T00:40:09+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":344,"optionOpen":false}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\n|DESTINATION| CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|            RECON_ID|BUS_ID|PARENT_BUS_ID|NEW_BUS_ID|RECONCILIATION_NUM|BUS_ID|    DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|                SITE|      TYPE_NAME|IS_VIRTUAL|PARENT_TARGET_ID|        MONITOR_DESC|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\n|          1|1567408304| 1567408304|  1868540|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-0B8933709CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-0B8933709CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|              Server|\n|          1|1567408304| 1567408300|  2262378|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|OI-3E65DFB49CF011...| 11838|         null|     11838|               659| 11838|         Server|            null|OI-3E65DFB49CF011...| MM-400 Minuteman Rd|         Server|         N|            null|  HTTP Page Download|\n|          1|1567408304| 1567408304|  2131840|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-7E26ACDC9CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-7E26ACDC9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304| 1567408304|  1547990|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-07D424569CF011...| 35672|         null|     35672|               111| 35672|Processing unit|            null|OI-07D424569CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|         WMI: Server|\n|          1|1567408304| 1567408303|  2084968|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F53A1CBA9CEF11...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-F53A1CBA9CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304| 1567408304|  1924187|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-38AAAA8C9CF011...| 35140|         null|     35140|              2336| 35140|Processing unit|            null|OI-38AAAA8C9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567408304| 1567408304|  1522543|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-E8B332D89CEF11...| 36027|        35574|     35574|              2601| 36027|Processing unit|            null|OI-E8B332D89CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408305| 1567408305|  2072090|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-ED76B0A69CEF11...| 36918|         null|     36918|                62| 36918|Processing unit|            null|OI-ED76B0A69CEF11...|SCCA130-2805 Lafa...|Processing unit|         Y|            null|                Ping|\n|          1|1567408304| 1567408304|  1256994|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F52680389CEF11...| 34807|         null|     34807|              2778| 34807|Processing unit|            null|OI-F52680389CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304| 1567408304|  1793904|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-84D85E229CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-84D85E229CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|         WMI: Server|\n|          1|1567408304| 1567408304|  2143559|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-4A1BF33E9CF011...| 19718|        34041|     34041|                82| 19718|Processing unit|            null|OI-4A1BF33E9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|            Protocol|\n|          1|1567408304| 1567408304|  1987081|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-F58BF5589CEF11...| 35698|         null|     35698|               435| 35698|         Server|            null|OI-F58BF5589CEF11...|WOKING-Digital Re...|         Server|         N|            null|Hardware Status M...|\n|          1|1567408306| 1567408305|  2155212|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-7E9C17749CF011...| 37961|         null|     37961|               307| 37961|Processing unit|            null|OI-7E9C17749CF011...|    RHUK01-Unit 3 St|Processing unit|         Y|            null|WMI: Service Monitor|\n|          1|1567408304| 1567408304|  2187477|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-53C9511A9CF011...| 34807|         null|     34807|              2778| 34807|Processing unit|            null|OI-53C9511A9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|         WMI: Server|\n|          1|1567408305| 1567408304|  2095816|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-1DC9A6829CF011...| 22842|         null|     22842|                71| 22842|Processing unit|            null|OI-1DC9A6829CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|WMI: Service Monitor|\n|          1|1567408305| 1567408304|  1834560|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     PREATLAS_138792| 35140|         null|     35140|              2336| 35140|        CHASSIS|   VMWARE ESXi 6|     PREATLAS_138792|SCCA130 - 2805 La...|           null|         Y|            null|                Ping|\n|          1|1567408305| 1567408305|  2247668|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-B2291F929E4E11...| 35563|        35664|     35664|               155| 35563|Processing unit|            null|OI-B2291F929E4E11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|              Server|\n|          1|1567408305| 1567408305|  1423122|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-01AA97EA9CF011...| 35655|         null|     35655|               153| 35655|Processing unit|            null|OI-01AA97EA9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304| 1567408304|  1614961|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-1B79482E9CF011...| 35140|         null|     35140|              2336| 35140|Processing unit|            null|OI-1B79482E9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|            Protocol|\n|          1|1567408305| 1567408305|  2170316|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-3A3FD37C9CF011...| 37018|         null|     37018|               236| 37018|Processing unit|            null|OI-3A3FD37C9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1583209125406_-773087386","id":"20200229-035219_594502101","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:288"},{"text":"/*var event_logs_df = event_logs_desc.select(\n    col(\"DESTINATION\"),\n    col(\"CORE_TIME\"),\n    //col(\"CORE_TIME\").cast(\"TimestampType\").as(\"CORE_TIMESTAMP\"),\n    to_date(col(\"CORE_TIME\").cast(TimestampType)).as(\"CORE_TIMESTAMP\"),\n    to_date(from_unixtime($\"CORE_TIME\", \"dd-MM-yyyy\")).as(\"CORE_TIMESTAMP2\"),\n    unix_timestamp(col(\"CORE_TIME\")).as(\"CORE_TIMESTAMP3\"),\n    to_date(from_unixtime($\"CORE_TIME\")).as(\"CORE_TIMESTAMP4\"),  /////////////gold\n    to_date(from_unixtime($\"CORE_TIME\"), \"YYYY-MM-dd HH:mm:ss\").as(\"CORE_TIMESTAMP5\"),\n    // to_date(from_unixtime($\"CORE_TIME\", \"dd-MMM-yyyy HH:mm:ss\")).as(\"CORE_TIMESTAMP6\"),\n     to_timestamp(from_unixtime($\"CORE_TIME\")).as(\"CORE_TIMESTAMP7\"),  \n    col(\"POLLER_TIME\"),\n    col(\"POLLER_TIME\").cast(\"timestamp\").as(\"POLLER_TIMESTAMP\"),\n    col(\"TARGET_ID\"));\n    \nevent_logs_df.show();*/\nvar event_logs_df = event_logs_desc.select(\n    col(\"DESTINATION\"),\n    col(\"CORE_TIME\"),\n    to_timestamp(from_unixtime($\"CORE_TIME\")).as(\"CORE_TIMESTAMP\"),\n    col(\"POLLER_TIME\"),\n    to_timestamp(from_unixtime($\"POLLER_TIME\")).as(\"POLLER_TIMESTAMP\"),\n    col(\"TARGET_ID\"),\n    col(\"POLICY_ID\"),\n    col(\"POLICY_TYPE\"),\n    col(\"DETECTED_SEVERITY\"),\n    col(\"PROPAGATED_SEVERITY\"),\n    col(\"LOW_THRESHOLD\"),\n    col(\"MEASURED_VALUE\"),\n    col(\"HIGH_THRESHOLD\"),\n    col(\"PROPAGATED_FLAG\"),\n    col(\"EVENT_CODE\"),\n    col(\"METRIC_NAME\"),\n    col(\"RECON_ID\"),\n    col(\"BUS_ID\"),\n    col(\"PARENT_BUS_ID\"),\n    col(\"NEW_BUS_ID\"),\n    col(\"RECONCILIATION_NUM\"),\n    col(\"BUS_ID\"),\n    col(\"DEVICE_TYPE\"),\n    col(\"OPERATING_SYSTEM\"),\n    col(\"RECONCILIATION_ID\"),\n    col(\"SITE\"),\n    col(\"TYPE_NAME\"),\n    col(\"IS_VIRTUAL\"),\n    col(\"PARENT_TARGET_ID\"),\n    col(\"MONITOR_DESC\")\n    ); \n    \nevent_logs_df.show();","user":"anonymous","dateUpdated":"2020-03-03T22:47:43+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-------------------+-----------+-------------------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+-------------------+---------------+----------+----------------+--------------------+\n|DESTINATION| CORE_TIME|     CORE_TIMESTAMP|POLLER_TIME|   POLLER_TIMESTAMP|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|            RECON_ID|BUS_ID|PARENT_BUS_ID|NEW_BUS_ID|RECONCILIATION_NUM|BUS_ID|    DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|               SITE|      TYPE_NAME|IS_VIRTUAL|PARENT_TARGET_ID|        MONITOR_DESC|\n+-----------+----------+-------------------+-----------+-------------------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+-------------------+---------------+----------+----------------+--------------------+\n|          1|1567408594|2019-09-02 07:16:34| 1567408593|2019-09-02 07:16:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567408894|2019-09-02 07:21:34| 1567408893|2019-09-02 07:21:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567409194|2019-09-02 07:26:34| 1567409193|2019-09-02 07:26:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567409494|2019-09-02 07:31:34| 1567409493|2019-09-02 07:31:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567409794|2019-09-02 07:36:34| 1567409793|2019-09-02 07:36:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567413394|2019-09-02 08:36:34| 1567413393|2019-09-02 08:36:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567413694|2019-09-02 08:41:34| 1567413693|2019-09-02 08:41:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567413994|2019-09-02 08:46:34| 1567413993|2019-09-02 08:46:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567414294|2019-09-02 08:51:34| 1567414293|2019-09-02 08:51:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567414594|2019-09-02 08:56:34| 1567414593|2019-09-02 08:56:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567414894|2019-09-02 09:01:34| 1567414893|2019-09-02 09:01:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567415194|2019-09-02 09:06:34| 1567415193|2019-09-02 09:06:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567415494|2019-09-02 09:11:34| 1567415493|2019-09-02 09:11:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567415794|2019-09-02 09:16:34| 1567415793|2019-09-02 09:16:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567416094|2019-09-02 09:21:34| 1567416093|2019-09-02 09:21:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567419694|2019-09-02 10:21:34| 1567419693|2019-09-02 10:21:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567419994|2019-09-02 10:26:34| 1567419993|2019-09-02 10:26:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567420294|2019-09-02 10:31:34| 1567420293|2019-09-02 10:31:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567420594|2019-09-02 10:36:34| 1567420593|2019-09-02 10:36:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567420894|2019-09-02 10:41:34| 1567420893|2019-09-02 10:41:33|  1006422|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-2A02B6969CF011...| 35109|        35326|     35326|               142| 35109|Processing unit|            null|OI-2A02B6969CF011...|MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n+-----------+----------+-------------------+-----------+-------------------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+-------------------+---------------+----------+----------------+--------------------+\nonly showing top 20 rows\n\nevent_logs_df: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 28 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125406_-590000831","id":"20200229-042344_1009022911","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-03T22:47:43+0000","dateFinished":"2020-03-03T22:51:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:289"},{"text":"event_logs_df.show();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+--------------+-----------+----------------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\n|DESTINATION| CORE_TIME|CORE_TIMESTAMP|POLLER_TIME|POLLER_TIMESTAMP|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|            RECON_ID|BUS_ID|PARENT_BUS_ID|NEW_BUS_ID|RECONCILIATION_NUM|BUS_ID|    DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|                SITE|      TYPE_NAME|IS_VIRTUAL|PARENT_TARGET_ID|        MONITOR_DESC|\n+-----------+----------+--------------+-----------+----------------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\n|          1|1567408304|          null| 1567408304|            null|  1868540|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-0B8933709CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-0B8933709CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|              Server|\n|          1|1567408304|          null| 1567408300|            null|  2262378|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|OI-3E65DFB49CF011...| 11838|         null|     11838|               659| 11838|         Server|            null|OI-3E65DFB49CF011...| MM-400 Minuteman Rd|         Server|         N|            null|  HTTP Page Download|\n|          1|1567408304|          null| 1567408304|            null|  2131840|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-7E26ACDC9CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-7E26ACDC9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|          null| 1567408304|            null|  1547990|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-07D424569CF011...| 35672|         null|     35672|               111| 35672|Processing unit|            null|OI-07D424569CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|         WMI: Server|\n|          1|1567408304|          null| 1567408303|            null|  2084968|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F53A1CBA9CEF11...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-F53A1CBA9CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|          null| 1567408304|            null|  1924187|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-38AAAA8C9CF011...| 35140|         null|     35140|              2336| 35140|Processing unit|            null|OI-38AAAA8C9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567408304|          null| 1567408304|            null|  1522543|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-E8B332D89CEF11...| 36027|        35574|     35574|              2601| 36027|Processing unit|            null|OI-E8B332D89CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408305|          null| 1567408305|            null|  2072090|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-ED76B0A69CEF11...| 36918|         null|     36918|                62| 36918|Processing unit|            null|OI-ED76B0A69CEF11...|SCCA130-2805 Lafa...|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|          null| 1567408304|            null|  1256994|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F52680389CEF11...| 34807|         null|     34807|              2778| 34807|Processing unit|            null|OI-F52680389CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|          null| 1567408304|            null|  1793904|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-84D85E229CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-84D85E229CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|         WMI: Server|\n|          1|1567408304|          null| 1567408304|            null|  2143559|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-4A1BF33E9CF011...| 19718|        34041|     34041|                82| 19718|Processing unit|            null|OI-4A1BF33E9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|            Protocol|\n|          1|1567408304|          null| 1567408304|            null|  1987081|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-F58BF5589CEF11...| 35698|         null|     35698|               435| 35698|         Server|            null|OI-F58BF5589CEF11...|WOKING-Digital Re...|         Server|         N|            null|Hardware Status M...|\n|          1|1567408306|          null| 1567408305|            null|  2155212|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-7E9C17749CF011...| 37961|         null|     37961|               307| 37961|Processing unit|            null|OI-7E9C17749CF011...|    RHUK01-Unit 3 St|Processing unit|         Y|            null|WMI: Service Monitor|\n|          1|1567408304|          null| 1567408304|            null|  2187477|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-53C9511A9CF011...| 34807|         null|     34807|              2778| 34807|Processing unit|            null|OI-53C9511A9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|         WMI: Server|\n|          1|1567408305|          null| 1567408304|            null|  2095816|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-1DC9A6829CF011...| 22842|         null|     22842|                71| 22842|Processing unit|            null|OI-1DC9A6829CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|WMI: Service Monitor|\n|          1|1567408305|          null| 1567408304|            null|  1834560|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     PREATLAS_138792| 35140|         null|     35140|              2336| 35140|        CHASSIS|   VMWARE ESXi 6|     PREATLAS_138792|SCCA130 - 2805 La...|           null|         Y|            null|                Ping|\n|          1|1567408305|          null| 1567408305|            null|  2247668|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-B2291F929E4E11...| 35563|        35664|     35664|               155| 35563|Processing unit|            null|OI-B2291F929E4E11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|              Server|\n|          1|1567408305|          null| 1567408305|            null|  1423122|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-01AA97EA9CF011...| 35655|         null|     35655|               153| 35655|Processing unit|            null|OI-01AA97EA9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|          null| 1567408304|            null|  1614961|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-1B79482E9CF011...| 35140|         null|     35140|              2336| 35140|Processing unit|            null|OI-1B79482E9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|            Protocol|\n|          1|1567408305|          null| 1567408305|            null|  2170316|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-3A3FD37C9CF011...| 37018|         null|     37018|               236| 37018|Processing unit|            null|OI-3A3FD37C9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n+-----------+----------+--------------+-----------+----------------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1583209125407_1979694281","id":"20200229-044633_490756168","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:290"},{"text":"// S0 join event_log and device based on target id : OK\n// S1 join S0 and customer based on target id : OK\n// S2 join S1 and customer_parent based on bus_id : OK\n// S3 join S2 and top_customers where bus_id = custid or parent_bus_id = top_customers.bus_id :OK\n// S4 S3 join device_location_data :OK\n// add type and device hierarchy","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583209125412_-1191008880","id":"20200226-071605_293215532","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:291"},{"text":"//Get the incident.csv into a dataframe \nvar incident_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/incidents.csv\");\nincident_df = incident_df.select(\n            incident_df.col(\"incident_id\").as(\"INCIDENT_ID\"),\n            incident_df.col(\"submit_date\").as(\"SUBMIT_DATE\"),\n            incident_df.col(\"bus_id\").as(\"BUS_ID\"),\n            incident_df.col(\"event_code\").as(\"EVENT_CODE\")\n    );\nincident_df.show();","user":"anonymous","dateUpdated":"2020-03-03T22:51:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------------+------+----------+\n|    INCIDENT_ID|         SUBMIT_DATE|BUS_ID|EVENT_CODE|\n+---------------+--------------------+------+----------+\n|CRQ001000044016|22-Aug-2019 04:29:38| 36944|    DDT-11|\n|INC001000000002|14-Aug-2018 09:22:15|  9873|   APPL-85|\n|INC001000000007|16-Aug-2018 12:10:16| 35574|   NAVI-32|\n|INC001000000008|17-Aug-2018 11:50:12| 35574|    ESM-22|\n|INC001000000009|17-Aug-2018 11:59:37| 35574|    ESM-22|\n|INC001000000010|17-Aug-2018 14:26:09| 35574|    ESM-22|\n|INC001000000011|17-Aug-2018 16:12:45| 35574|   NAVI-21|\n|INC001000000012|18-Aug-2018 02:45:57| 35574|    ISM-50|\n|INC001000000013|18-Aug-2018 12:34:06| 35574|    ISM-50|\n|INC001000000015|18-Aug-2018 15:57:00| 35574|   NTWK-58|\n|INC001000000016|19-Aug-2018 05:12:33| 35574|  WLLOG-06|\n|INC001000000017|19-Aug-2018 11:59:18| 35574|   WINT-06|\n|INC001000000018|19-Aug-2018 12:26:45| 35574|    APP-01|\n|INC001000000019|19-Aug-2018 20:19:33| 35574|   WINT-07|\n|INC001000000020|20-Aug-2018 03:24:16| 35574|    ISM-50|\n|INC001000000021|20-Aug-2018 05:43:12| 35574|   WINT-07|\n|INC001000000022|20-Aug-2018 09:36:33| 35574|   WINT-07|\n|INC001000000023|20-Aug-2018 09:48:35| 35574|    APP-01|\n|INC001000000024|20-Aug-2018 09:58:00| 35574|   NTWK-58|\n|INC001000000025|20-Aug-2018 10:13:38| 35574|    APP-01|\n+---------------+--------------------+------+----------+\nonly showing top 20 rows\n\nincident_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 2 more fields]\nincident_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125413_-608311154","id":"20200229-035705_296817465","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-03T22:51:59+0000","dateFinished":"2020-03-03T22:52:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:292"},{"text":"//Get the incident_device.csv into a dataframe \nvar incident_device_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/incident-device.csv\");\nincident_device_df = incident_device_df.select(\n            incident_device_df.col(\"incident_id\").as(\"INCIDENT_DEV_ID\"),\n            incident_device_df.col(\"recon_id\").as(\"RECON_ID\")\n    );\nincident_device_df.show();","user":"anonymous","dateUpdated":"2020-03-03T22:52:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------------+\n|INCIDENT_DEV_ID|            RECON_ID|\n+---------------+--------------------+\n|CRQ001000044016|OI-88A7FF529D1411...|\n|CRQ001000044016|OI-257C0BF49CF011...|\n|INC001000000002|OI-6C1981C69D1411...|\n|INC001000000002|OI-3C69EAF29CF011...|\n|INC001000000007|OI-64139C789D1411...|\n|INC001000000011|OI-764453A69D1411...|\n|INC001000000012|OI-51F629489D1411...|\n|INC001000000015|OI-059C5A0A9CF011...|\n|INC001000000018|OI-6D83470A9CF011...|\n|INC001000000018|OI-0ED62F4C9CF011...|\n|INC001000000020|OI-68D858669D1411...|\n|INC001000000021|OI-774EA86E9D1411...|\n|INC001000000023|OI-42156D329CF011...|\n|INC001000000024|OI-667027EE9CF011...|\n|INC001000000030|OI-68D858669D1411...|\n|INC001000000034|OI-E9C5499A9CEF11...|\n|INC001000000034|REGAA5V0GQ2KOAP33...|\n|INC001000000036|OI-68D858669D1411...|\n|INC001000000037|OI-64139C789D1411...|\n|INC001000000039|OI-68D858669D1411...|\n+---------------+--------------------+\nonly showing top 20 rows\n\nincident_device_df: org.apache.spark.sql.DataFrame = [INCIDENT_DEV_ID: string, RECON_ID: string]\nincident_device_df: org.apache.spark.sql.DataFrame = [INCIDENT_DEV_ID: string, RECON_ID: string]\n"}]},"apps":[],"jobName":"paragraph_1583209125413_974318978","id":"20200229-035841_148039032","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-03T22:52:04+0000","dateFinished":"2020-03-03T22:52:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:293"},{"text":"var incident_recon_df = incident_df.join(incident_device_df, incident_df(\"INCIDENT_ID\") === incident_device_df(\"INCIDENT_DEV_ID\"), \"inner\").drop(\"INCIDENT_DEV_ID\");","user":"anonymous","dateUpdated":"2020-03-03T22:52:09+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"incident_recon_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125413_2142259119","id":"20200229-035949_1007395544","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-03T22:52:10+0000","dateFinished":"2020-03-03T22:52:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:294"},{"text":"// incident_df.count();     //224770\nincident_device_df.count(); //388200","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res56: Long = 388200\n"}]},"apps":[],"jobName":"paragraph_1583209125414_-1228508049","id":"20200229-040410_2031397542","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:295"},{"text":"var incident_details = incident_recon_df.join(event_code_mapped, incident_recon_df(\"EVENT_CODE\") === event_code_mapped(\"mapping_event_code\"), \"left_outer\").drop(\"mapping_event_code\");","user":"anonymous","dateUpdated":"2020-03-03T22:52:17+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"incident_details: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 4 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125414_1904715440","id":"20200229-040435_790463357","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-03T22:52:18+0000","dateFinished":"2020-03-03T22:52:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:296"},{"text":"incident_details.show();\nincident_details.count();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------------+------+----------+--------------------+-------------+\n|    INCIDENT_ID|         SUBMIT_DATE|BUS_ID|EVENT_CODE|            RECON_ID|event_code_id|\n+---------------+--------------------+------+----------+--------------------+-------------+\n|INC001000000289|12-Aug-2018 21:18:52| 11838|   MSQL-12|OI-61BACA609CF011...|         null|\n|INC001000000289|12-Aug-2018 21:18:52| 11838|   MSQL-12|OI-6AEEC7F29D1411...|         null|\n|INC001000000417|13-Aug-2018 04:42:21| 35376|   UNIX-02|OI-596F5EA29CF011...|         null|\n|INC001000000417|13-Aug-2018 04:42:21| 35376|   UNIX-02|OI-563564EC9D1411...|         null|\n|INC001000000445|13-Aug-2018 06:03:09| 37048|   SNMP-08|OI-791C64849CF011...|           11|\n|INC001000000445|13-Aug-2018 06:03:09| 37048|   SNMP-08|OI-55DCCE9A9D1411...|           11|\n|INC001000000670|13-Aug-2018 11:38:28| 35140|    ESX-01|OI-209C10E89CF011...|         null|\n|INC001000000670|13-Aug-2018 11:38:28| 35140|    ESX-01|OI-6F7CA4BA9D1411...|         null|\n|INC001000001313|14-Aug-2018 05:24:07| 36027|   UNIX-12|OI-6FBCD6769CF011...|         null|\n|INC001000001313|14-Aug-2018 05:24:07| 36027|   UNIX-12|OI-857A2EF49D1411...|         null|\n|INC001000001370|14-Aug-2018 09:30:34| 35383|    ATS-08|OI-7F69431A9D1411...|         null|\n|INC001000001370|14-Aug-2018 09:30:34| 35383|    ATS-08|OI-278851969CF011...|         null|\n|INC001000001452|14-Aug-2018 11:30:47| 35383|    ATS-08|OI-7F69431A9D1411...|         null|\n|INC001000001452|14-Aug-2018 11:30:47| 35383|    ATS-08|OI-278851969CF011...|         null|\n|INC001000001671|14-Aug-2018 15:43:20| 35383|    ESM-18|OI-25D032889CF011...|            1|\n|INC001000001671|14-Aug-2018 15:43:20| 35383|    ESM-18|OI-591A411E9D1411...|            1|\n|INC001000002000|15-Aug-2018 07:56:07| 16715|   FRCR-01|OI-10A90B009CF011...|         null|\n|INC001000002000|15-Aug-2018 07:56:07| 16715|   FRCR-01|OI-5A10AF729D1411...|         null|\n|INC001000002223|15-Aug-2018 15:29:24| 34611|    ACM-04|OI-34A5D1FA9CF011...|         null|\n|INC001000002223|15-Aug-2018 15:29:24| 34611|    ACM-04|OI-59B19D8E9D1411...|         null|\n+---------------+--------------------+------+----------+--------------------+-------------+\nonly showing top 20 rows\n\nres59: Long = 388200\n"}]},"apps":[],"jobName":"paragraph_1583209125415_-48917811","id":"20200229-041807_1722846343","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:297"},{"text":"var incident_details_df = incident_details.select(\n            col(\"INCIDENT_ID\"),\n            col(\"SUBMIT_DATE\"), \n            unix_timestamp(col(\"SUBMIT_DATE\"), \"dd-MMM-yyyy HH:mm:ss\").as(\"SUBMIT_DATE_MS\"),\n            col(\"BUS_ID\"),\n            col(\"EVENT_CODE\"),\n            col(\"RECON_ID\"),\n            col(\"event_code_id\").as(\"EVENT_CODE_ID\")\n            );\nincident_details_df.show()","user":"anonymous","dateUpdated":"2020-03-03T22:52:23+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------------+--------------+------+----------+--------------------+-------------+\n|    INCIDENT_ID|         SUBMIT_DATE|SUBMIT_DATE_MS|BUS_ID|EVENT_CODE|            RECON_ID|EVENT_CODE_ID|\n+---------------+--------------------+--------------+------+----------+--------------------+-------------+\n|INC001000005831|22-Aug-2018 10:42:13|    1534934533| 35383|    ATS-02|OI-687AD84E9D1411...|         null|\n|INC001000006826|24-Aug-2018 12:42:13|    1535114533| 35383|    ATS-02|OI-7F69431A9D1411...|         null|\n|INC001000006826|24-Aug-2018 12:42:13|    1535114533| 35383|    ATS-02|OI-278851969CF011...|         null|\n|INC001000619352|19-Oct-2019 12:02:26|    1571486546| 35562|   CALL-02|REGAA5V0GQ2KOAP33...|         null|\n|INC001000691656|17-Jan-2020 14:11:07|    1579270267| 24585|    HRD-10|OI-674BE9909D1411...|         null|\n|INC001000698606|23-Jan-2020 09:23:27|    1579771407| 24585|    HRD-10|OI-674BE9909D1411...|         null|\n|INC001000138079| 9-Jan-2019 10:15:04|    1547028904| 24585|    HRD-10|OI-674BE9909D1411...|         null|\n|INC001000025003|28-Sep-2018 09:04:34|    1538125474| 24585|    HRD-10|OI-74F974B89D1411...|         null|\n|INC001000543638| 6-Jun-2019 12:07:00|    1559822820| 24585|    HRD-10|OI-674BE9909D1411...|         null|\n|INC001000673116|12-Dec-2019 11:43:06|    1576150986| 24585|    HRD-10|OI-674BE9909D1411...|         null|\n|INC001000677019|19-Dec-2019 09:59:43|    1576749583| 24585|    HRD-10|OI-674BE9909D1411...|         null|\n|INC001000545493|12-Jun-2019 08:30:19|    1560328219| 24585|    HRD-10|OI-674BE9909D1411...|         null|\n|INC001000521824|18-Apr-2019 15:20:18|    1555600818| 24585|    HRD-10|OI-674BE9909D1411...|         null|\n|INC001000575783|20-Aug-2019 16:49:05|    1566319745| 11839|    HRD-10|OI-570D5D709D1411...|         null|\n|INC001000575783|20-Aug-2019 16:49:05|    1566319745| 11839|    HRD-10|OI-6194FA569CF011...|         null|\n|INC001000575783|20-Aug-2019 16:49:05|    1566319745| 11839|    HRD-10|REGAA5V0GQ2KOAP33...|         null|\n|INC001000546529|13-Jun-2019 12:45:43|    1560429943| 24585|    HRD-10|OI-674BE9909D1411...|         null|\n|INC001000611595|16-Oct-2019 10:43:18|    1571222598| 35821|    HRD-10|OI-029789929CF011...|         null|\n|INC001000611595|16-Oct-2019 10:43:18|    1571222598| 35821|    HRD-10|OI-807618789D1411...|         null|\n|INC001000546076|14-Jun-2019 09:55:00|    1560506100| 24585|    HRD-10|OI-674BE9909D1411...|         null|\n+---------------+--------------------+--------------+------+----------+--------------------+-------------+\nonly showing top 20 rows\n\nincident_details_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125416_184501197","id":"20200229-042419_1640347198","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-03T22:52:23+0000","dateFinished":"2020-03-03T22:54:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:298"},{"text":"/* TODO ::: \nDataframes to load to database :\n1. event_logs_desc\n2. incident_details_df\n*/","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583209125416_-846069194","id":"20200229-041934_1171294660","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:299"},{"text":"//create properties object\nval prop = new java.util.Properties\nprop.setProperty(\"driver\", \"com.mysql.jdbc.Driver\")\nprop.setProperty(\"user\", \"root\")\nprop.setProperty(\"password\", \"rdx-mysql\") \n \nval mysqlDBName = \"\"\nval url = \"jdbc:mysql://localhost:3306/\" + mysqlDBName","user":"anonymous","dateUpdated":"2020-03-03T07:29:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"prop: java.util.Properties = {user=root, password=rdx-mysql, driver=com.mysql.jdbc.Driver}\nmysqlDBName: String = \"\"\nurl: String = jdbc:mysql://localhost:3306/\n"}]},"apps":[],"jobName":"paragraph_1583209125416_371162679","id":"20200229-041820_525116366","dateCreated":"2020-03-03T04:18:45+0000","dateStarted":"2020-03-03T07:29:03+0000","dateFinished":"2020-03-03T07:29:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:300"},{"text":"// load(append) event_logs_df into table - \nval EventTableName = \"\"\nevent_logs_df.write.mode(\"append\").jdbc(url, EventTableName, prop)","user":"anonymous","dateUpdated":"2020-03-03T07:27:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583219426825_-2079543279","id":"20200303-071026_1856232868","dateCreated":"2020-03-03T07:10:26+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:301"},{"text":"// load(append) incident_details_df into table - \nval IncidentTableName = \"\"\nevent_logs_df.write.mode(\"append\").jdbc(url, IncidentTableName, prop)","user":"anonymous","dateUpdated":"2020-03-03T07:29:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583219519916_-450214272","id":"20200303-071159_1018100970","dateCreated":"2020-03-03T07:11:59+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:302"},{"text":"/************************\n * write dataframe to .csv\n ************************/","user":"anonymous","dateUpdated":"2020-03-03T20:11:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583266222121_-1019647491","id":"20200303-201022_2144387572","dateCreated":"2020-03-03T20:10:22+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:303"},{"text":"import org.apache.hadoop.conf.Configuration\nimport org.apache.hadoop.fs._","user":"anonymous","dateUpdated":"2020-03-03T20:38:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.hadoop.conf.Configuration\nimport org.apache.hadoop.fs._\n"}]},"apps":[],"jobName":"paragraph_1583267917325_-1712122512","id":"20200303-203837_1483383489","dateCreated":"2020-03-03T20:38:37+0000","dateStarted":"2020-03-03T20:38:43+0000","dateFinished":"2020-03-03T20:38:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:304"},{"text":"// write event_logs_desc to event-logs.csv\nevent_logs_desc.write.format(\"com.databricks.spark.csv\").save(\"gs://rdx-cmu-2020-dataset/event-logs.csv\")","user":"anonymous","dateUpdated":"2020-03-03T20:37:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1583266271819_-1130870616","id":"20200303-201111_824696589","dateCreated":"2020-03-03T20:11:11+0000","dateStarted":"2020-03-03T20:37:52+0000","dateFinished":"2020-03-03T20:38:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:305"},{"text":"// save output into a single csv file\nevent_logs_desc.repartition(1).write.format(\"com.databricks.spark.csv\").save(\"gs://rdx-cmu-2020-dataset/event-logs-merged.csv\")","user":"anonymous","dateUpdated":"2020-03-03T22:55:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1583269535838_2020473700","id":"20200303-210535_1445221666","dateCreated":"2020-03-03T21:05:35+0000","dateStarted":"2020-03-03T22:55:43+0000","dateFinished":"2020-03-03T23:00:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:306"},{"text":"// write incident_details_df to incident-details.csv\n incident_details_df.write.format(\"com.databricks.spark.csv\").save(\"gs://rdx-cmu-2020-dataset/incident-details.csv\")","user":"anonymous","dateUpdated":"2020-03-03T22:55:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1583266550693_-1719809244","id":"20200303-201550_647587879","dateCreated":"2020-03-03T20:15:50+0000","dateStarted":"2020-03-03T21:04:14+0000","dateFinished":"2020-03-03T21:04:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:307"},{"text":" // save output into a single csv file\n incident_details_df.repartition(1).coalesce(1).write.format(\"com.databricks.spark.csv\").save(\"gs://rdx-cmu-2020-dataset/incident-details-merged.csv\")","user":"anonymous","dateUpdated":"2020-03-03T23:00:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1583269630399_49568068","id":"20200303-210710_447329219","dateCreated":"2020-03-03T21:07:10+0000","dateStarted":"2020-03-03T23:00:14+0000","dateFinished":"2020-03-03T23:02:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:308"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583266996682_1751459629","id":"20200303-202316_674903915","dateCreated":"2020-03-03T20:23:16+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:309"}],"name":"ETL2","id":"2F3Y18Z76","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}