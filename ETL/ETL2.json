{"paragraphs":[{"text":"//Get the bus_parent.csv into a dataframe \nvar bus_parent_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/bus_parent.csv\");\nbus_parent_df = bus_parent_df.select(\n            bus_parent_df.col(\"PARENT_ID\").as(\"PARENT_BUS_ID\"),\n            bus_parent_df.col(\"BUS_ID\").as(\"HIER_BUS_ID\")\n    );\nbus_parent_df.show();","user":"anonymous","dateUpdated":"2020-02-26T08:07:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-----------+\n|PARENT_BUS_ID|HIER_BUS_ID|\n+-------------+-----------+\n|         1914|       5793|\n|        14748|       9873|\n|         1914|      10354|\n|         1914|      10615|\n|         1914|      11376|\n|        29710|      11839|\n|        29710|      11840|\n|         1914|      11841|\n|         1914|      11895|\n|        34872|      11896|\n|         1914|      12175|\n|         1914|      13615|\n|         1914|      14035|\n|         1914|      14655|\n|        29710|      14912|\n|        29710|      14913|\n|        29710|      14923|\n|        29710|      14924|\n|        29710|      14925|\n|        29710|      14929|\n+-------------+-----------+\nonly showing top 20 rows\n\nbus_parent_df: org.apache.spark.sql.DataFrame = [PARENT_BUS_ID: string, HIER_BUS_ID: string]\nbus_parent_df: org.apache.spark.sql.DataFrame = [PARENT_BUS_ID: string, HIER_BUS_ID: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=232","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=233"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582697277477_-2032699223","id":"20200226-060757_2141589333","dateCreated":"2020-02-26T06:07:57+0000","dateStarted":"2020-02-26T08:07:10+0000","dateFinished":"2020-02-26T08:07:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16756"},{"text":"//Get the customer.csv into a dataframe \nvar customer_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/customer.csv\");\ncustomer_df = customer_df.select(\n            customer_df.col(\"RECONCILIATION_ID\"),\n            customer_df.col(\"BUS_ID\").as(\"BUS_ID\")\n    );\ncustomer_df.show();","user":"anonymous","dateUpdated":"2020-02-26T08:05:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------+\n|   RECONCILIATION_ID|BUS_ID|\n+--------------------+------+\n|OI-FDF0CAB69CEF11...| 37146|\n|OI-D723D6129D9911...| 38023|\n|OI-6E3509E09CF011...| 16715|\n|OI-343704B49CF011...| 19922|\n|OI-6F5224DE9CF011...| 37373|\n|OI-3170ECAE9CF011...| 35140|\n|OI-7E74093C9CF011...| 35663|\n|OI-64074C4E9CF011...| 34807|\n|OI-8A2BBAF49DA411...| 38177|\n|OI-498348969CF011...| 35562|\n|OI-6D8C65069CF011...| 34821|\n|OI-8698CEEA9CF011...| 27010|\n|OI-1A354A3A9CF011...| 35574|\n|OI-6BD775709CF011...| 36024|\n|OI-3F5DC0F89CF011...| 35310|\n|OI-7F198BE69DA411...| 32710|\n|OI-8943417A9DA411...| 35383|\n|OI-39EFEBAA9CF011...| 35376|\n|OI-0406791E9CF011...| 37018|\n|OI-1AEC4C3A9CF011...| 10615|\n+--------------------+------+\nonly showing top 20 rows\n\ncustomer_df: org.apache.spark.sql.DataFrame = [RECONCILIATION_ID: string, BUS_ID: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=204","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=205"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582697301566_481813380","id":"20200226-060821_1073898764","dateCreated":"2020-02-26T06:08:21+0000","dateStarted":"2020-02-26T07:11:09+0000","dateFinished":"2020-02-26T07:11:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16757"},{"text":"//Get the device.csv into a dataframe \nvar device_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/device.csv\");\ndevice_df = device_df.select(\n            device_df.col(\"TARGET_ID\").as(\"DEVICE_TARGET_ID\"),\n            device_df.col(\"RECON_ID\")\n    )\ndevice_df.show();","user":"anonymous","dateUpdated":"2020-02-26T07:50:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+--------------+\n|DEVICE_TARGET_ID|      RECON_ID|\n+----------------+--------------+\n|            2777|PREATLAS_22811|\n|            2778|PREATLAS_22811|\n|            2779|PREATLAS_22811|\n|            2780|PREATLAS_22811|\n|            2781|PREATLAS_22811|\n|            2782|PREATLAS_22811|\n|            2783|PREATLAS_22811|\n|            2784|PREATLAS_22811|\n|            2785|PREATLAS_22811|\n|            2786|PREATLAS_22811|\n|            2787|PREATLAS_22811|\n|            2788|PREATLAS_22811|\n|            2789|PREATLAS_22811|\n|            2790|PREATLAS_22811|\n|            2791|PREATLAS_22811|\n|            2792|PREATLAS_22811|\n|            2793|PREATLAS_22811|\n|            2794|PREATLAS_22811|\n|            2795|PREATLAS_22811|\n|            2796|PREATLAS_22811|\n+----------------+--------------+\nonly showing top 20 rows\n\ndevice_df: org.apache.spark.sql.DataFrame = [DEVICE_TARGET_ID: string, RECON_ID: string]\ndevice_df: org.apache.spark.sql.DataFrame = [DEVICE_TARGET_ID: string, RECON_ID: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=214","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=215"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582697339440_158657273","id":"20200226-060859_2104217724","dateCreated":"2020-02-26T06:08:59+0000","dateStarted":"2020-02-26T07:50:45+0000","dateFinished":"2020-02-26T07:50:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16758"},{"text":"//Get the device_location.csv into a dataframe \nval device_location_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/device_location.csv\")","user":"anonymous","dateUpdated":"2020-02-26T07:09:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"device_location_df: org.apache.spark.sql.DataFrame = [BUS_ID: string, DEVICE_TYPE: string ... 5 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=198"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582697339058_-201236515","id":"20200226-060859_1373866278","dateCreated":"2020-02-26T06:08:59+0000","dateStarted":"2020-02-26T06:37:58+0000","dateFinished":"2020-02-26T06:37:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16759"},{"text":"//Get the parent.csv into a dataframe \nvar parent_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/parent.csv\")","user":"anonymous","dateUpdated":"2020-02-26T07:45:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"parent_df: org.apache.spark.sql.DataFrame = [TARGET_ID: string, PARENT_ID: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=199"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582697338856_1846673362","id":"20200226-060858_614673072","dateCreated":"2020-02-26T06:08:58+0000","dateStarted":"2020-02-26T06:38:08+0000","dateFinished":"2020-02-26T06:38:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16760"},{"text":"//Get the type.csv into a dataframe \nvar type_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/type.csv\")","user":"anonymous","dateUpdated":"2020-02-26T07:45:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"type_df: org.apache.spark.sql.DataFrame = [TARGET_ID: string, TYPE: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=201"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582697338287_2053233717","id":"20200226-060858_967312711","dateCreated":"2020-02-26T06:08:58+0000","dateStarted":"2020-02-26T06:38:39+0000","dateFinished":"2020-02-26T06:38:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16761"},{"text":"//Get the event_log.csv into a dataframe \nvar event_log_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/event.log.20190902031144_20000.csv\");\nevent_log_df = event_log_df.filter(\"policy_type != 'T'\" ).filter(\"metric_name != 'Started'\");\n","user":"anonymous","dateUpdated":"2020-02-26T07:14:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_log_df: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 12 more fields]\nevent_log_df: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 12 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=208"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582697335618_-1507761762","id":"20200226-060855_595029811","dateCreated":"2020-02-26T06:08:55+0000","dateStarted":"2020-02-26T07:14:23+0000","dateFinished":"2020-02-26T07:14:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16762"},{"text":"// get top customers from top_clients.csv\nvar top_clients_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/top_clients.csv\")","user":"anonymous","dateUpdated":"2020-02-26T07:45:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"top_clients_df: org.apache.spark.sql.DataFrame = [NEW_BUS_ID: string, RECONCILIATION_NUM: string ... 3 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=203"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582699135800_-1414196775","id":"20200226-063855_62253060","dateCreated":"2020-02-26T06:38:55+0000","dateStarted":"2020-02-26T06:54:23+0000","dateFinished":"2020-02-26T06:54:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16763"},{"text":"// Get EventCode and an associated intger mapping\nvar event_code_mapped = event_log_df.select(\"event_code\").distinct();\nevent_code_mapped = event_code_mapped.withColumn(\"event_code_id\", monotonically_increasing_id);\nevent_code_mapped = event_code_mapped.select(\n         event_code_mapped.col(\"event_code_id\"),\n       event_code_mapped.col(\"event_code\").as(\"mapping_event_code\")\n    )\n    \nregexp_replace(event_code_mapped(\"mapping_event_code\"),\"\\\\s+\",\" \");","user":"anonymous","dateUpdated":"2020-02-26T07:16:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: bigint, mapping_event_code: string]\nevent_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: bigint, mapping_event_code: string]\nevent_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: bigint, mapping_event_code: string]\nres65: org.apache.spark.sql.Column = regexp_replace(mapping_event_code, \\s+,  )\n"}]},"apps":[],"jobName":"paragraph_1582700063548_460713524","id":"20200226-065423_868519549","dateCreated":"2020-02-26T06:54:23+0000","dateStarted":"2020-02-26T07:16:05+0000","dateFinished":"2020-02-26T07:16:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16764"},{"text":"var device_event_log = event_log_df.join(device_df, event_log_df.col(\"TARGET_ID\") === device_df.col(\"DEVICE_TARGET_ID\"), \"inner\")\n                            .drop(\"DEVICE_TARGET_ID\");\n// device_event_log.count(); : 47\ndevice_event_log.show();","user":"anonymous","dateUpdated":"2020-02-26T07:56:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+\n|DESTINATION| CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|            RECON_ID|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+\n|          1|1567408305| 1567408305|   818882|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-EE2AD7169CEF11...|\n|          1|1567408305| 1567408304|   941646|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-080ADC1C9CF011...|\n|          1|1567408305| 1567408305|  1027003|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-1EB30E629CF011...|\n|          1|1567408305| 1567408305|  1044381|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-F80D583A9CEF11...|\n|          1|1567408304| 1567408304|  1180040|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-1CDF89629CF011...|\n|          1|1567408304| 1567408304|  1256994|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F52680389CEF11...|\n|          1|1567408305| 1567408305|  1376484|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-1121013C9CF011...|\n|          1|1567408304| 1567408304|  1407391|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-3A7579289CF011...|\n|          1|1567408305| 1567408305|  1423122|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-01AA97EA9CF011...|\n|          1|1567408305| 1567408305|  1441239|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-79E2BF949CF011...|\n|          1|1567408304| 1567408304|  1466342|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-F708BEE89CEF11...|\n|          1|1567408305| 1567408305|  1529123|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-FC4F5BC89CEF11...|\n|          1|1567408304| 1567408304|  1522543|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-E8B332D89CEF11...|\n|          1|1567408304| 1567408304|  1547990|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-07D424569CF011...|\n|          1|1567408304| 1567408304|  1590408|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|OI-4ECBA8489CF011...|\n|          1|1567408304| 1567408304|  1614961|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-1B79482E9CF011...|\n|          1|1567408305| 1567408305|  1654710|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-037672F69CF011...|\n|          1|1567408305| 1567408304|  1800652|     1460|          A|                0|                  0|            0|             0|             0|              0|    ESM-71|       None|OI-FCEF5CE09CEF11...|\n|          1|1567408304| 1567408304|  1793904|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-84D85E229CF011...|\n|          1|1567408305| 1567408304|  1834560|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     PREATLAS_138792|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+\nonly showing top 20 rows\n\ndevice_event_log: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 13 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=222","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=223","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=224"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582701606327_353534351","id":"20200226-072006_528594224","dateCreated":"2020-02-26T07:20:06+0000","dateStarted":"2020-02-26T07:56:56+0000","dateFinished":"2020-02-26T07:57:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16765"},{"text":"var cust_device_event_log = device_event_log\n    .join(customer_df, device_event_log.col(\"RECON_ID\") === customer_df.col(\"RECONCILIATION_ID\"), \"inner\").drop(\"RECONCILIATION_ID\");\n// cust_device_event_log.count(); // 47","user":"anonymous","dateUpdated":"2020-02-26T08:01:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cust_device_event_log: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 14 more fields]\n"}]},"apps":[],"jobName":"paragraph_1582703641226_-1368982","id":"20200226-075401_853406802","dateCreated":"2020-02-26T07:54:01+0000","dateStarted":"2020-02-26T08:00:49+0000","dateFinished":"2020-02-26T08:00:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16766"},{"text":"var cust_detail_device_event_log = cust_device_event_log\n    .join(bus_parent_df, cust_device_event_log.col(\"BUS_ID\") === bus_parent_df.col(\"HIER_BUS_ID\"), \"left_outer\").drop(\"HIER_BUS_ID\");\ncust_detail_device_event_log.show();","user":"anonymous","dateUpdated":"2020-02-26T08:07:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+\n|DESTINATION| CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|            RECON_ID|BUS_ID|PARENT_BUS_ID|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+\n|          1|1567408305| 1567408305|   818882|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-EE2AD7169CEF11...| 34447|         null|\n|          1|1567408305| 1567408304|   941646|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-080ADC1C9CF011...| 35310|        29711|\n|          1|1567408305| 1567408305|  1027003|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-1EB30E629CF011...| 20439|         null|\n|          1|1567408305| 1567408305|  1044381|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-F80D583A9CEF11...| 27070|         null|\n|          1|1567408304| 1567408304|  1180040|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-1CDF89629CF011...| 35508|        27070|\n|          1|1567408304| 1567408304|  1256994|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F52680389CEF11...| 34807|         null|\n|          1|1567408305| 1567408305|  1376484|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-1121013C9CF011...| 23824|        21077|\n|          1|1567408304| 1567408304|  1407391|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-3A7579289CF011...| 35655|         null|\n|          1|1567408305| 1567408305|  1423122|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-01AA97EA9CF011...| 35655|         null|\n|          1|1567408305| 1567408305|  1441239|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-79E2BF949CF011...| 35672|         null|\n|          1|1567408304| 1567408304|  1466342|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-F708BEE89CEF11...| 35698|         null|\n|          1|1567408305| 1567408305|  1529123|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-FC4F5BC89CEF11...| 36027|        35574|\n|          1|1567408304| 1567408304|  1522543|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-E8B332D89CEF11...| 36027|        35574|\n|          1|1567408304| 1567408304|  1547990|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-07D424569CF011...| 35672|         null|\n|          1|1567408304| 1567408304|  1590408|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|OI-4ECBA8489CF011...|  9873|        14748|\n|          1|1567408304| 1567408304|  1614961|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-1B79482E9CF011...| 35140|         null|\n|          1|1567408305| 1567408305|  1654710|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-037672F69CF011...| 35696|         null|\n|          1|1567408305| 1567408304|  1800652|     1460|          A|                0|                  0|            0|             0|             0|              0|    ESM-71|       None|OI-FCEF5CE09CEF11...| 36024|        35574|\n|          1|1567408304| 1567408304|  1793904|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-84D85E229CF011...| 36024|        35574|\n|          1|1567408305| 1567408304|  1834560|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     PREATLAS_138792| 35140|         null|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+\nonly showing top 20 rows\n\ncust_detail_device_event_log: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 15 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=234","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=235","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=236","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=237","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=238"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582704084868_1235217851","id":"20200226-080124_1698475559","dateCreated":"2020-02-26T08:01:24+0000","dateStarted":"2020-02-26T08:07:40+0000","dateFinished":"2020-02-26T08:07:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16767"},{"text":"// S0 join event_log and device based on target id : OK\n// S1 join S0 and customer based on target id : OK\n// S2 join S1 and customer_parent based on bus_id : \n// S3 join S2 and top_customers where bus_id = custid or parent_bus_id = top_customers.bus_id\n// S4 ","user":"anonymous","dateUpdated":"2020-02-26T08:01:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582701365511_1657480340","id":"20200226-071605_293215532","dateCreated":"2020-02-26T07:16:05+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:16768"}],"name":"ETL2","id":"2F4R2WADJ","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}