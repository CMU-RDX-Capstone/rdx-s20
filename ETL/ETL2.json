{"paragraphs":[{"text":"import org.apache.spark.sql.expressions.Window;\r\nimport org.apache.spark.sql.types.TimestampType;\r\n// import org.apache.spark.sql.expressions.Window","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.expressions.Window\nimport org.apache.spark.sql.types.TimestampType\n"}]},"apps":[],"jobName":"paragraph_1583209125392_1390109426","id":"20200229-023639_871760853","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:257"},{"text":"//Get the bus_parent.csv into a dataframe \nvar bus_parent_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/bus_parent.csv\");\nbus_parent_df = bus_parent_df.select(\n            bus_parent_df.col(\"PARENT_ID\").as(\"PARENT_BUS_ID\"),\n            bus_parent_df.col(\"BUS_ID\").as(\"HIER_BUS_ID\")\n    );\nbus_parent_df.show();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-----------+\n|PARENT_BUS_ID|HIER_BUS_ID|\n+-------------+-----------+\n|         1914|       5793|\n|        14748|       9873|\n|         1914|      10354|\n|         1914|      10615|\n|         1914|      11376|\n|        29710|      11839|\n|        29710|      11840|\n|         1914|      11841|\n|         1914|      11895|\n|        34872|      11896|\n|         1914|      12175|\n|         1914|      13615|\n|         1914|      14035|\n|         1914|      14655|\n|        29710|      14912|\n|        29710|      14913|\n|        29710|      14923|\n|        29710|      14924|\n|        29710|      14925|\n|        29710|      14929|\n+-------------+-----------+\nonly showing top 20 rows\n\nbus_parent_df: org.apache.spark.sql.DataFrame = [PARENT_BUS_ID: string, HIER_BUS_ID: string]\nbus_parent_df: org.apache.spark.sql.DataFrame = [PARENT_BUS_ID: string, HIER_BUS_ID: string]\n"}]},"apps":[],"jobName":"paragraph_1583209125393_-1216793151","id":"20200226-060757_2141589333","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:258"},{"text":"//Get the customer.csv into a dataframe \nvar customer_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/customer.csv\");\ncustomer_df = customer_df.select(\n            customer_df.col(\"RECONCILIATION_ID\"),\n            customer_df.col(\"BUS_ID\").as(\"BUS_ID\")\n    );\ncustomer_df.show();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------+\n|   RECONCILIATION_ID|BUS_ID|\n+--------------------+------+\n|OI-FDF0CAB69CEF11...| 37146|\n|OI-D723D6129D9911...| 38023|\n|OI-6E3509E09CF011...| 16715|\n|OI-343704B49CF011...| 19922|\n|OI-6F5224DE9CF011...| 37373|\n|OI-3170ECAE9CF011...| 35140|\n|OI-7E74093C9CF011...| 35663|\n|OI-64074C4E9CF011...| 34807|\n|OI-8A2BBAF49DA411...| 38177|\n|OI-498348969CF011...| 35562|\n|OI-6D8C65069CF011...| 34821|\n|OI-8698CEEA9CF011...| 27010|\n|OI-1A354A3A9CF011...| 35574|\n|OI-6BD775709CF011...| 36024|\n|OI-3F5DC0F89CF011...| 35310|\n|OI-7F198BE69DA411...| 32710|\n|OI-8943417A9DA411...| 35383|\n|OI-39EFEBAA9CF011...| 35376|\n|OI-0406791E9CF011...| 37018|\n|OI-1AEC4C3A9CF011...| 10615|\n+--------------------+------+\nonly showing top 20 rows\n\ncustomer_df: org.apache.spark.sql.DataFrame = [RECONCILIATION_ID: string, BUS_ID: string]\ncustomer_df: org.apache.spark.sql.DataFrame = [RECONCILIATION_ID: string, BUS_ID: string]\n"}]},"apps":[],"jobName":"paragraph_1583209125394_1839209746","id":"20200226-060821_1073898764","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:259"},{"text":"//Get the device.csv into a dataframe \nvar device_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/device.csv\");\ndevice_df = device_df.select(\n            device_df.col(\"TARGET_ID\").as(\"DEVICE_TARGET_ID\"),\n            device_df.col(\"RECON_ID\")\n    )\ndevice_df.show();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+--------------+\n|DEVICE_TARGET_ID|      RECON_ID|\n+----------------+--------------+\n|            2777|PREATLAS_22811|\n|            2778|PREATLAS_22811|\n|            2779|PREATLAS_22811|\n|            2780|PREATLAS_22811|\n|            2781|PREATLAS_22811|\n|            2782|PREATLAS_22811|\n|            2783|PREATLAS_22811|\n|            2784|PREATLAS_22811|\n|            2785|PREATLAS_22811|\n|            2786|PREATLAS_22811|\n|            2787|PREATLAS_22811|\n|            2788|PREATLAS_22811|\n|            2789|PREATLAS_22811|\n|            2790|PREATLAS_22811|\n|            2791|PREATLAS_22811|\n|            2792|PREATLAS_22811|\n|            2793|PREATLAS_22811|\n|            2794|PREATLAS_22811|\n|            2795|PREATLAS_22811|\n|            2796|PREATLAS_22811|\n+----------------+--------------+\nonly showing top 20 rows\n\ndevice_df: org.apache.spark.sql.DataFrame = [DEVICE_TARGET_ID: string, RECON_ID: string]\ndevice_df: org.apache.spark.sql.DataFrame = [DEVICE_TARGET_ID: string, RECON_ID: string]\n"}]},"apps":[],"jobName":"paragraph_1583209125394_272449346","id":"20200226-060859_2104217724","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:260"},{"text":"//Get the device_location.csv into a dataframe \nvar device_location_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/device_location.csv\");\ndevice_location_df = device_location_df.select(\n    col(\"BUS_ID\").as(\"BUS_ID_DEV\"),\n    col(\"DEVICE_TYPE\"),\n    col(\"OPERATING_SYSTEM\"),\n    col(\"RECONCILIATION_ID\"),\n    col(\"SITE\"),\n    col(\"TYPE_NAME\"),\n    col(\"IS_VIRTUAL\")\n    );\ndevice_location_df.show();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\n|BUS_ID_DEV|         DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|                SITE|           TYPE_NAME|IS_VIRTUAL|\n+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\n|     37146|   RAIDStorageDevice|            null|OI-FDF0CAB69CEF11...| MM-400 Minuteman Rd|   RAIDStorageDevice|         N|\n|     38023|              Server|            null|OI-D723D6129D9911...| MM-400 Minuteman Rd|              Server|         Y|\n|     16715|              Server|            null|OI-6E3509E09CF011...|    RHUK01-Unit 3 St|              Server|         Y|\n|     19922|              Router|            null|OI-343704B49CF011...| MM-400 Minuteman Rd|              Router|         N|\n|     37373|              Server|            null|OI-6F5224DE9CF011...| MM-400 Minuteman Rd|              Server|         Y|\n|     35140|              Switch|            null|OI-3170ECAE9CF011...| MM-400 Minuteman Rd|              Switch|         N|\n|     35663|       Load Balancer|            null|OI-7E74093C9CF011...|WOKING-Digital Re...|       Load Balancer|         Y|\n|     34807|              Server|            null|OI-64074C4E9CF011...| MM-400 Minuteman Rd|              Server|         Y|\n|     38177|Link Aggregation Tap|            null|OI-8A2BBAF49DA411...| MM-400 Minuteman Rd|Link Aggregation Tap|         N|\n|     35562|              Server|            null|OI-498348969CF011...|SCCA130-2805 Lafa...|              Server|         Y|\n|     34821|              Switch|            null|OI-6D8C65069CF011...| MM-400 Minuteman Rd|              Switch|         N|\n|     27010|              Server|            null|OI-8698CEEA9CF011...| MM-400 Minuteman Rd|              Server|         N|\n|     35574|             Network|            null|OI-1A354A3A9CF011...| MM-400 Minuteman Rd|             Network|         N|\n|     36024|              Server|            null|OI-6BD775709CF011...| MM-400 Minuteman Rd|              Server|         Y|\n|     35310|              Server|            null|OI-3F5DC0F89CF011...|    RHUK01-Unit 3 St|              Server|         N|\n|     32710|            Firewall|            null|OI-7F198BE69DA411...|LOUK01-East India...|            Firewall|         N|\n|     35383|              Router|            null|OI-8943417A9DA411...| MM-400 Minuteman Rd|              Router|         N|\n|     35376|     Processing unit|            null|OI-39EFEBAA9CF011...| MM-400 Minuteman Rd|     Processing unit|         N|\n|     37018|              Server|            null|OI-0406791E9CF011...|SCCA120-2805 Lafa...|              Server|         Y|\n|     10615|              Server|            null|OI-1AEC4C3A9CF011...| MM-400 Minuteman Rd|              Server|         N|\n+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\ndevice_location_df: org.apache.spark.sql.DataFrame = [BUS_ID_DEV: string, DEVICE_TYPE: string ... 5 more fields]\ndevice_location_df: org.apache.spark.sql.DataFrame = [BUS_ID_DEV: string, DEVICE_TYPE: string ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125395_-239952028","id":"20200226-060859_1373866278","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:261"},{"text":"//Get the parent.csv into a dataframe \nvar parent_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/parent.csv\");\n\nparent_df = parent_df.select(\n            parent_df.col(\"PARENT_ID\").as(\"PARENT_TARGET_ID\"),\n            parent_df.col(\"TARGET_ID\").as(\"CHILD_TARGET_ID\")\n    );","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"parent_df: org.apache.spark.sql.DataFrame = [PARENT_TARGET_ID: string, CHILD_TARGET_ID: string]\nparent_df: org.apache.spark.sql.DataFrame = [PARENT_TARGET_ID: string, CHILD_TARGET_ID: string]\n"}]},"apps":[],"jobName":"paragraph_1583209125398_1492149861","id":"20200226-060858_614673072","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:262"},{"text":"//Get the type.csv into a dataframe \nvar type_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/type.csv\");\n\ntype_df = type_df.select(\n            type_df.col(\"TARGET_ID\").as(\"MONITOR_ID\"),\n            type_df.col(\"TYPE\").as(\"MONITOR_DESC\")\n    );\n    ","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"type_df: org.apache.spark.sql.DataFrame = [MONITOR_ID: string, MONITOR_DESC: string]\ntype_df: org.apache.spark.sql.DataFrame = [MONITOR_ID: string, MONITOR_DESC: string]\n"}]},"apps":[],"jobName":"paragraph_1583209125398_1361987988","id":"20200226-060858_967312711","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:263"},{"text":"//Get the event_log.csv into a dataframe \nvar event_log_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/event.log.20190902031144_20000.csv\");\nevent_log_df = event_log_df.filter(\"policy_type != 'T'\" ).filter(\"metric_name != 'Started'\");\nevent_log_df.count()","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_log_df: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 12 more fields]\nevent_log_df: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 12 more fields]\nres5: Long = 149\n"}]},"apps":[],"jobName":"paragraph_1583209125399_-1901900209","id":"20200226-060855_595029811","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:264"},{"text":"// get top customers from top_clients.csv\nvar top_clients_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/top_clients.csv\");\ntop_clients_df.show();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+------------------+-------+------------------+----+\n|NEW_BUS_ID|RECONCILIATION_NUM|PERCENT|CUMULATIVE_PERCENT|RANK|\n+----------+------------------+-------+------------------+----+\n|     34807|              2778|  0.049|             0.049|   1|\n|     35574|              2601|  0.046|             0.095|   2|\n|     35140|              2336|  0.041|             0.136|   3|\n|      1914|              1863|  0.033|             0.169|   4|\n|     29710|              1376|  0.024|             0.193|   5|\n|     32890|              1308|  0.023|             0.216|   6|\n|     35383|              1174|  0.021|             0.237|   7|\n|     11838|               659|  0.012|             0.248|   8|\n|     35821|               615|  0.011|             0.259|   9|\n|     33554|               612|  0.011|             0.270|  10|\n|     33617|               603|  0.011|             0.281|  11|\n|     15804|               592|  0.010|             0.291|  12|\n|     35340|               554|  0.010|             0.301|  13|\n|     36973|               544|  0.010|             0.311|  14|\n|     35562|               521|  0.009|             0.320|  15|\n|     35698|               435|  0.008|             0.327|  16|\n|     11876|               429|  0.008|             0.335|  17|\n|     16715|               405|  0.007|             0.342|  18|\n|     35183|               373|  0.007|             0.349|  19|\n|     14748|               325|  0.006|             0.354|  20|\n+----------+------------------+-------+------------------+----+\nonly showing top 20 rows\n\ntop_clients_df: org.apache.spark.sql.DataFrame = [NEW_BUS_ID: string, RECONCILIATION_NUM: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125400_1758443770","id":"20200226-063855_62253060","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:265"},{"text":"// Get EventCode and an associated intger mapping\nvar event_code_mapped = event_log_df.select(\"event_code\").distinct();\nevent_code_mapped = event_code_mapped.withColumn(\"event_code_id\", row_number().over(Window.orderBy(\"event_code\")));\nevent_code_mapped = event_code_mapped.select(\n         event_code_mapped.col(\"event_code_id\"),\n       event_code_mapped.col(\"event_code\").as(\"mapping_event_code\")\n    )\n    \nregexp_replace(event_code_mapped(\"mapping_event_code\"),\"\\\\s+\",\" \");","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: int, mapping_event_code: string]\nevent_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: int, mapping_event_code: string]\nevent_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: int, mapping_event_code: string]\nres23: org.apache.spark.sql.Column = regexp_replace(mapping_event_code, \\s+,  )\n"}]},"apps":[],"jobName":"paragraph_1583209125400_576245102","id":"20200226-065423_868519549","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:266"},{"text":"event_code_mapped.show()","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+------------------+\n|event_code_id|mapping_event_code|\n+-------------+------------------+\n|            1|            ESM-18|\n|            2|            ESM-70|\n|            3|            ESM-71|\n|            4|            ESM-72|\n|            5|            ESM-73|\n|            6|            ISM-04|\n|            7|            ISM-05|\n|            8|            ISM-30|\n|            9|         NCDISM-30|\n|           10|            NLB-01|\n|           11|           SNMP-08|\n+-------------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1583209125400_-1199548336","id":"20200229-021209_2085882877","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:267"},{"text":"var device_event_log = event_log_df.join(device_df, event_log_df.col(\"TARGET_ID\") === device_df.col(\"DEVICE_TARGET_ID\"), \"inner\")\n                            .drop(\"DEVICE_TARGET_ID\");\n// device_event_log.count();// : 47\ndevice_event_log.show();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+\n|DESTINATION| CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|            RECON_ID|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+\n|          1|1567408305| 1567408305|   818882|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-EE2AD7169CEF11...|\n|          1|1567408305| 1567408304|   941646|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-080ADC1C9CF011...|\n|          1|1567408305| 1567408305|  1027003|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-1EB30E629CF011...|\n|          1|1567408305| 1567408305|  1044381|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-F80D583A9CEF11...|\n|          1|1567408304| 1567408304|  1180040|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-1CDF89629CF011...|\n|          1|1567408304| 1567408304|  1256994|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F52680389CEF11...|\n|          1|1567408305| 1567408305|  1376484|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-1121013C9CF011...|\n|          1|1567408304| 1567408304|  1407391|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-3A7579289CF011...|\n|          1|1567408305| 1567408305|  1423122|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-01AA97EA9CF011...|\n|          1|1567408305| 1567408305|  1441239|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-79E2BF949CF011...|\n|          1|1567408304| 1567408304|  1466342|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-F708BEE89CEF11...|\n|          1|1567408305| 1567408305|  1529123|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-FC4F5BC89CEF11...|\n|          1|1567408304| 1567408304|  1522543|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-E8B332D89CEF11...|\n|          1|1567408304| 1567408304|  1547990|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-07D424569CF011...|\n|          1|1567408304| 1567408304|  1590408|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|OI-4ECBA8489CF011...|\n|          1|1567408304| 1567408304|  1614961|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-1B79482E9CF011...|\n|          1|1567408305| 1567408305|  1654710|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-037672F69CF011...|\n|          1|1567408305| 1567408304|  1800652|     1460|          A|                0|                  0|            0|             0|             0|              0|    ESM-71|       None|OI-FCEF5CE09CEF11...|\n|          1|1567408304| 1567408304|  1793904|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-84D85E229CF011...|\n|          1|1567408305| 1567408304|  1834560|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     PREATLAS_138792|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+\nonly showing top 20 rows\n\ndevice_event_log: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125401_1483277987","id":"20200226-072006_528594224","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:268"},{"text":"var cust_device_event_log = device_event_log\n    .join(customer_df, device_event_log.col(\"RECON_ID\") === customer_df.col(\"RECONCILIATION_ID\"), \"inner\").drop(\"RECONCILIATION_ID\");\n//  cust_device_event_log.count(); // 47\ncust_device_event_log.show();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+\n|DESTINATION| CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|            RECON_ID|BUS_ID|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+\n|          1|1567408305| 1567408305|   818882|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-EE2AD7169CEF11...| 34447|\n|          1|1567408305| 1567408304|   941646|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-080ADC1C9CF011...| 35310|\n|          1|1567408305| 1567408305|  1027003|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-1EB30E629CF011...| 20439|\n|          1|1567408305| 1567408305|  1044381|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-F80D583A9CEF11...| 27070|\n|          1|1567408304| 1567408304|  1180040|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-1CDF89629CF011...| 35508|\n|          1|1567408304| 1567408304|  1256994|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F52680389CEF11...| 34807|\n|          1|1567408305| 1567408305|  1376484|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-1121013C9CF011...| 23824|\n|          1|1567408304| 1567408304|  1407391|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-3A7579289CF011...| 35655|\n|          1|1567408305| 1567408305|  1423122|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-01AA97EA9CF011...| 35655|\n|          1|1567408305| 1567408305|  1441239|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-79E2BF949CF011...| 35672|\n|          1|1567408304| 1567408304|  1466342|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-F708BEE89CEF11...| 35698|\n|          1|1567408305| 1567408305|  1529123|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-FC4F5BC89CEF11...| 36027|\n|          1|1567408304| 1567408304|  1522543|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-E8B332D89CEF11...| 36027|\n|          1|1567408304| 1567408304|  1547990|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-07D424569CF011...| 35672|\n|          1|1567408304| 1567408304|  1590408|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|OI-4ECBA8489CF011...|  9873|\n|          1|1567408304| 1567408304|  1614961|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-1B79482E9CF011...| 35140|\n|          1|1567408305| 1567408305|  1654710|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-037672F69CF011...| 35696|\n|          1|1567408305| 1567408304|  1800652|     1460|          A|                0|                  0|            0|             0|             0|              0|    ESM-71|       None|OI-FCEF5CE09CEF11...| 36024|\n|          1|1567408304| 1567408304|  1793904|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-84D85E229CF011...| 36024|\n|          1|1567408305| 1567408304|  1834560|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     PREATLAS_138792| 35140|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+\nonly showing top 20 rows\n\ncust_device_event_log: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 14 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125401_883896947","id":"20200226-075401_853406802","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:269"},{"text":"var cust_detail_device_event_log = cust_device_event_log\n    .join(bus_parent_df, cust_device_event_log.col(\"BUS_ID\") === bus_parent_df.col(\"HIER_BUS_ID\"), \"left_outer\").drop(\"HIER_BUS_ID\");\ncust_detail_device_event_log.show();\n","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+\n|DESTINATION| CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|            RECON_ID|BUS_ID|PARENT_BUS_ID|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+\n|          1|1567408305| 1567408305|   818882|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-EE2AD7169CEF11...| 34447|         null|\n|          1|1567408305| 1567408304|   941646|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-080ADC1C9CF011...| 35310|        29711|\n|          1|1567408305| 1567408305|  1027003|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-1EB30E629CF011...| 20439|         null|\n|          1|1567408305| 1567408305|  1044381|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-F80D583A9CEF11...| 27070|         null|\n|          1|1567408304| 1567408304|  1180040|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-1CDF89629CF011...| 35508|        27070|\n|          1|1567408304| 1567408304|  1256994|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F52680389CEF11...| 34807|         null|\n|          1|1567408305| 1567408305|  1376484|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-1121013C9CF011...| 23824|        21077|\n|          1|1567408304| 1567408304|  1407391|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-3A7579289CF011...| 35655|         null|\n|          1|1567408305| 1567408305|  1423122|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-01AA97EA9CF011...| 35655|         null|\n|          1|1567408305| 1567408305|  1441239|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-79E2BF949CF011...| 35672|         null|\n|          1|1567408304| 1567408304|  1466342|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-F708BEE89CEF11...| 35698|         null|\n|          1|1567408305| 1567408305|  1529123|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-FC4F5BC89CEF11...| 36027|        35574|\n|          1|1567408304| 1567408304|  1522543|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-E8B332D89CEF11...| 36027|        35574|\n|          1|1567408304| 1567408304|  1547990|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-07D424569CF011...| 35672|         null|\n|          1|1567408304| 1567408304|  1590408|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|OI-4ECBA8489CF011...|  9873|        14748|\n|          1|1567408304| 1567408304|  1614961|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-1B79482E9CF011...| 35140|         null|\n|          1|1567408305| 1567408305|  1654710|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-037672F69CF011...| 35696|         null|\n|          1|1567408305| 1567408304|  1800652|     1460|          A|                0|                  0|            0|             0|             0|              0|    ESM-71|       None|OI-FCEF5CE09CEF11...| 36024|        35574|\n|          1|1567408304| 1567408304|  1793904|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-84D85E229CF011...| 36024|        35574|\n|          1|1567408305| 1567408304|  1834560|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     PREATLAS_138792| 35140|         null|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+\nonly showing top 20 rows\n\ncust_detail_device_event_log: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 15 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125402_790495700","id":"20200226-080124_1698475559","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:270"},{"text":"var top_cust_detail_device_event_log = \ncust_detail_device_event_log.join(top_clients_df, cust_detail_device_event_log(\"BUS_ID\") === top_clients_df(\"NEW_BUS_ID\") || cust_detail_device_event_log(\"PARENT_BUS_ID\") === top_clients_df(\"NEW_BUS_ID\"), \"inner\").drop(\"CUMULATIVE_PERCENT\", \"RANK\", \"PERCENT\"); ","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"top_cust_detail_device_event_log: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 17 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125403_-734859356","id":"20200229-022405_11824168","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:271"},{"text":"top_cust_detail_device_event_log.show();\ntop_cust_detail_device_event_log.count();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+\n|DESTINATION| CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|            RECON_ID|BUS_ID|PARENT_BUS_ID|NEW_BUS_ID|RECONCILIATION_NUM|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+\n|          1|1567408305| 1567408304|   941646|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-080ADC1C9CF011...| 35310|        29711|     29711|               215|\n|          1|1567408305| 1567408305|  1044381|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-F80D583A9CEF11...| 27070|         null|     27070|               156|\n|          1|1567408304| 1567408304|  1180040|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-1CDF89629CF011...| 35508|        27070|     27070|               156|\n|          1|1567408304| 1567408304|  1256994|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F52680389CEF11...| 34807|         null|     34807|              2778|\n|          1|1567408304| 1567408304|  1407391|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-3A7579289CF011...| 35655|         null|     35655|               153|\n|          1|1567408305| 1567408305|  1423122|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-01AA97EA9CF011...| 35655|         null|     35655|               153|\n|          1|1567408305| 1567408305|  1441239|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-79E2BF949CF011...| 35672|         null|     35672|               111|\n|          1|1567408304| 1567408304|  1466342|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-F708BEE89CEF11...| 35698|         null|     35698|               435|\n|          1|1567408305| 1567408305|  1529123|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-FC4F5BC89CEF11...| 36027|        35574|     35574|              2601|\n|          1|1567408304| 1567408304|  1522543|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-E8B332D89CEF11...| 36027|        35574|     35574|              2601|\n|          1|1567408304| 1567408304|  1547990|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-07D424569CF011...| 35672|         null|     35672|               111|\n|          1|1567408304| 1567408304|  1590408|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|OI-4ECBA8489CF011...|  9873|        14748|     14748|               325|\n|          1|1567408304| 1567408304|  1614961|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-1B79482E9CF011...| 35140|         null|     35140|              2336|\n|          1|1567408305| 1567408304|  1800652|     1460|          A|                0|                  0|            0|             0|             0|              0|    ESM-71|       None|OI-FCEF5CE09CEF11...| 36024|        35574|     35574|              2601|\n|          1|1567408304| 1567408304|  1793904|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-84D85E229CF011...| 36024|        35574|     35574|              2601|\n|          1|1567408305| 1567408304|  1834560|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     PREATLAS_138792| 35140|         null|     35140|              2336|\n|          1|1567408305| 1567408303|  1958790|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-06D1DF309CF011...| 35663|         null|     35663|                70|\n|          1|1567408305| 1567408305|  1873486|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F47D432E9CEF11...| 36024|        35574|     35574|              2601|\n|          1|1567408304| 1567408304|  1868540|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-0B8933709CF011...| 36024|        35574|     35574|              2601|\n|          1|1567408304| 1567408304|  1871569|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-85E7431E9CF011...|  9873|        14748|     14748|               325|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+\nonly showing top 20 rows\n\nres35: Long = 41\n"}]},"apps":[],"jobName":"paragraph_1583209125403_813003408","id":"20200229-024822_1508795478","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:272"},{"text":"var top_cust_device_detail_event_log = top_cust_detail_device_event_log.join(device_location_df, top_cust_detail_device_event_log(\"RECON_ID\") === device_location_df(\"RECONCILIATION_ID\"), \"left_outer\").drop(\"BUS_ID_DEV\");","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"top_cust_device_detail_event_log: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 23 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125404_136304909","id":"20200229-024946_1459553842","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:273"},{"text":"","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583209125404_1887632568","id":"20200229-030112_1895518751","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274"},{"text":"var top_cust_device_monitor_event_log \n= top_cust_device_detail_event_log.join(parent_df, top_cust_device_detail_event_log(\"TARGET_ID\") === parent_df(\"CHILD_TARGET_ID\"), \"left_outer\").drop(\"CHILD_TARGET_ID\");","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"top_cust_device_monitor_event_log: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 24 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125405_409572048","id":"20200229-030552_960796511","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:275"},{"text":"top_cust_device_monitor_event_log.count();\ntop_cust_device_monitor_event_log.show();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+\n|DESTINATION| CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|            RECON_ID|BUS_ID|PARENT_BUS_ID|NEW_BUS_ID|RECONCILIATION_NUM|BUS_ID|    DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|                SITE|      TYPE_NAME|IS_VIRTUAL|PARENT_TARGET_ID|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+\n|          1|1567408304| 1567408304|  1868540|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-0B8933709CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-0B8933709CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408304| 1567408300|  2262378|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|OI-3E65DFB49CF011...| 11838|         null|     11838|               659| 11838|         Server|            null|OI-3E65DFB49CF011...| MM-400 Minuteman Rd|         Server|         N|            null|\n|          1|1567408304| 1567408304|  2131840|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-7E26ACDC9CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-7E26ACDC9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408304| 1567408304|  1547990|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-07D424569CF011...| 35672|         null|     35672|               111| 35672|Processing unit|            null|OI-07D424569CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408304| 1567408303|  2084968|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F53A1CBA9CEF11...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-F53A1CBA9CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408304| 1567408304|  1924187|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-38AAAA8C9CF011...| 35140|         null|     35140|              2336| 35140|Processing unit|            null|OI-38AAAA8C9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|\n|          1|1567408304| 1567408304|  1522543|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-E8B332D89CEF11...| 36027|        35574|     35574|              2601| 36027|Processing unit|            null|OI-E8B332D89CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408305| 1567408305|  2072090|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-ED76B0A69CEF11...| 36918|         null|     36918|                62| 36918|Processing unit|            null|OI-ED76B0A69CEF11...|SCCA130-2805 Lafa...|Processing unit|         Y|            null|\n|          1|1567408304| 1567408304|  1256994|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F52680389CEF11...| 34807|         null|     34807|              2778| 34807|Processing unit|            null|OI-F52680389CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408304| 1567408304|  1793904|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-84D85E229CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-84D85E229CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|\n|          1|1567408304| 1567408304|  2143559|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-4A1BF33E9CF011...| 19718|        34041|     34041|                82| 19718|Processing unit|            null|OI-4A1BF33E9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|\n|          1|1567408304| 1567408304|  1987081|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-F58BF5589CEF11...| 35698|         null|     35698|               435| 35698|         Server|            null|OI-F58BF5589CEF11...|WOKING-Digital Re...|         Server|         N|            null|\n|          1|1567408306| 1567408305|  2155212|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-7E9C17749CF011...| 37961|         null|     37961|               307| 37961|Processing unit|            null|OI-7E9C17749CF011...|    RHUK01-Unit 3 St|Processing unit|         Y|            null|\n|          1|1567408304| 1567408304|  2187477|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-53C9511A9CF011...| 34807|         null|     34807|              2778| 34807|Processing unit|            null|OI-53C9511A9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408305| 1567408304|  2095816|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-1DC9A6829CF011...| 22842|         null|     22842|                71| 22842|Processing unit|            null|OI-1DC9A6829CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408305| 1567408304|  1834560|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     PREATLAS_138792| 35140|         null|     35140|              2336| 35140|        CHASSIS|   VMWARE ESXi 6|     PREATLAS_138792|SCCA130 - 2805 La...|           null|         Y|            null|\n|          1|1567408305| 1567408305|  2247668|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-B2291F929E4E11...| 35563|        35664|     35664|               155| 35563|Processing unit|            null|OI-B2291F929E4E11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408305| 1567408305|  1423122|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-01AA97EA9CF011...| 35655|         null|     35655|               153| 35655|Processing unit|            null|OI-01AA97EA9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408304| 1567408304|  1614961|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-1B79482E9CF011...| 35140|         null|     35140|              2336| 35140|Processing unit|            null|OI-1B79482E9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|\n|          1|1567408305| 1567408305|  2170316|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-3A3FD37C9CF011...| 37018|         null|     37018|               236| 37018|Processing unit|            null|OI-3A3FD37C9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1583209125405_-1610741895","id":"20200229-033940_2133138157","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:276"},{"text":"var event_logs_desc\n= top_cust_device_monitor_event_log.join(type_df, top_cust_device_monitor_event_log(\"TARGET_ID\") === type_df(\"MONITOR_ID\"), \"left_outer\").drop(\"MONITOR_ID\");","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_logs_desc: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 25 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125406_-1290518672","id":"20200229-035222_303729447","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:277"},{"text":"event_logs_desc.count();\nevent_logs_desc.show();\n","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\n|DESTINATION| CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|            RECON_ID|BUS_ID|PARENT_BUS_ID|NEW_BUS_ID|RECONCILIATION_NUM|BUS_ID|    DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|                SITE|      TYPE_NAME|IS_VIRTUAL|PARENT_TARGET_ID|        MONITOR_DESC|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\n|          1|1567408304| 1567408304|  1868540|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-0B8933709CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-0B8933709CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|              Server|\n|          1|1567408304| 1567408300|  2262378|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|OI-3E65DFB49CF011...| 11838|         null|     11838|               659| 11838|         Server|            null|OI-3E65DFB49CF011...| MM-400 Minuteman Rd|         Server|         N|            null|  HTTP Page Download|\n|          1|1567408304| 1567408304|  2131840|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-7E26ACDC9CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-7E26ACDC9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304| 1567408304|  1547990|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-07D424569CF011...| 35672|         null|     35672|               111| 35672|Processing unit|            null|OI-07D424569CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|         WMI: Server|\n|          1|1567408304| 1567408303|  2084968|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F53A1CBA9CEF11...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-F53A1CBA9CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304| 1567408304|  1924187|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-38AAAA8C9CF011...| 35140|         null|     35140|              2336| 35140|Processing unit|            null|OI-38AAAA8C9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567408304| 1567408304|  1522543|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-E8B332D89CEF11...| 36027|        35574|     35574|              2601| 36027|Processing unit|            null|OI-E8B332D89CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408305| 1567408305|  2072090|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-ED76B0A69CEF11...| 36918|         null|     36918|                62| 36918|Processing unit|            null|OI-ED76B0A69CEF11...|SCCA130-2805 Lafa...|Processing unit|         Y|            null|                Ping|\n|          1|1567408304| 1567408304|  1256994|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F52680389CEF11...| 34807|         null|     34807|              2778| 34807|Processing unit|            null|OI-F52680389CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304| 1567408304|  1793904|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-84D85E229CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-84D85E229CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|         WMI: Server|\n|          1|1567408304| 1567408304|  2143559|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-4A1BF33E9CF011...| 19718|        34041|     34041|                82| 19718|Processing unit|            null|OI-4A1BF33E9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|            Protocol|\n|          1|1567408304| 1567408304|  1987081|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-F58BF5589CEF11...| 35698|         null|     35698|               435| 35698|         Server|            null|OI-F58BF5589CEF11...|WOKING-Digital Re...|         Server|         N|            null|Hardware Status M...|\n|          1|1567408306| 1567408305|  2155212|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-7E9C17749CF011...| 37961|         null|     37961|               307| 37961|Processing unit|            null|OI-7E9C17749CF011...|    RHUK01-Unit 3 St|Processing unit|         Y|            null|WMI: Service Monitor|\n|          1|1567408304| 1567408304|  2187477|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-53C9511A9CF011...| 34807|         null|     34807|              2778| 34807|Processing unit|            null|OI-53C9511A9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|         WMI: Server|\n|          1|1567408305| 1567408304|  2095816|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-1DC9A6829CF011...| 22842|         null|     22842|                71| 22842|Processing unit|            null|OI-1DC9A6829CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|WMI: Service Monitor|\n|          1|1567408305| 1567408304|  1834560|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     PREATLAS_138792| 35140|         null|     35140|              2336| 35140|        CHASSIS|   VMWARE ESXi 6|     PREATLAS_138792|SCCA130 - 2805 La...|           null|         Y|            null|                Ping|\n|          1|1567408305| 1567408305|  2247668|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-B2291F929E4E11...| 35563|        35664|     35664|               155| 35563|Processing unit|            null|OI-B2291F929E4E11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|              Server|\n|          1|1567408305| 1567408305|  1423122|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-01AA97EA9CF011...| 35655|         null|     35655|               153| 35655|Processing unit|            null|OI-01AA97EA9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304| 1567408304|  1614961|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-1B79482E9CF011...| 35140|         null|     35140|              2336| 35140|Processing unit|            null|OI-1B79482E9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|            Protocol|\n|          1|1567408305| 1567408305|  2170316|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-3A3FD37C9CF011...| 37018|         null|     37018|               236| 37018|Processing unit|            null|OI-3A3FD37C9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1583209125406_-773087386","id":"20200229-035219_594502101","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:278"},{"text":"/*var event_logs_df = event_logs_desc.select(\n    col(\"DESTINATION\"),\n    col(\"CORE_TIME\"),\n    //col(\"CORE_TIME\").cast(\"TimestampType\").as(\"CORE_TIMESTAMP\"),\n    to_date(col(\"CORE_TIME\").cast(TimestampType)).as(\"CORE_TIMESTAMP\"),\n    to_date(from_unixtime($\"CORE_TIME\", \"dd-MM-yyyy\")).as(\"CORE_TIMESTAMP2\"),\n    unix_timestamp(col(\"CORE_TIME\")).as(\"CORE_TIMESTAMP3\"),\n    to_date(from_unixtime($\"CORE_TIME\")).as(\"CORE_TIMESTAMP4\"),  /////////////gold\n    to_date(from_unixtime($\"CORE_TIME\"), \"YYYY-MM-dd HH:mm:ss\").as(\"CORE_TIMESTAMP5\"),\n    // to_date(from_unixtime($\"CORE_TIME\", \"dd-MMM-yyyy HH:mm:ss\")).as(\"CORE_TIMESTAMP6\"),\n     to_timestamp(from_unixtime($\"CORE_TIME\")).as(\"CORE_TIMESTAMP7\"),  \n    col(\"POLLER_TIME\"),\n    col(\"POLLER_TIME\").cast(\"timestamp\").as(\"POLLER_TIMESTAMP\"),\n    col(\"TARGET_ID\"));\n    \nevent_logs_df.show();*/\nvar event_logs_df = event_logs_desc.select(\n    col(\"DESTINATION\"),\n    col(\"CORE_TIME\"),\n    to_timestamp(from_unixtime($\"CORE_TIME\")).as(\"CORE_TIMESTAMP\"),\n    col(\"POLLER_TIME\"),\n    to_timestamp(from_unixtime($\"POLLER_TIME\")).as(\"POLLER_TIMESTAMP\"),\n    col(\"TARGET_ID\"),\n    col(\"POLICY_ID\"),\n    col(\"POLICY_TYPE\"),\n    col(\"DETECTED_SEVERITY\"),\n    col(\"PROPAGATED_SEVERITY\"),\n    col(\"LOW_THRESHOLD\"),\n    col(\"MEASURED_VALUE\"),\n    col(\"HIGH_THRESHOLD\"),\n    col(\"PROPAGATED_FLAG\"),\n    col(\"EVENT_CODE\"),\n    col(\"METRIC_NAME\"),\n    col(\"RECON_ID\"),\n    col(\"BUS_ID\"),\n    col(\"PARENT_BUS_ID\"),\n    col(\"NEW_BUS_ID\"),\n    col(\"RECONCILIATION_NUM\"),\n    col(\"BUS_ID\"),\n    col(\"DEVICE_TYPE\"),\n    col(\"OPERATING_SYSTEM\"),\n    col(\"RECONCILIATION_ID\"),\n    col(\"SITE\"),\n    col(\"TYPE_NAME\"),\n    col(\"IS_VIRTUAL\"),\n    col(\"PARENT_TARGET_ID\"),\n    col(\"MONITOR_DESC\")\n    ); \n    \nevent_logs_df.show();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-------------------+-----------+-------------------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\n|DESTINATION| CORE_TIME|     CORE_TIMESTAMP|POLLER_TIME|   POLLER_TIMESTAMP|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|            RECON_ID|BUS_ID|PARENT_BUS_ID|NEW_BUS_ID|RECONCILIATION_NUM|BUS_ID|    DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|                SITE|      TYPE_NAME|IS_VIRTUAL|PARENT_TARGET_ID|        MONITOR_DESC|\n+-----------+----------+-------------------+-----------+-------------------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\n|          1|1567408304|2019-09-02 07:11:44| 1567408304|2019-09-02 07:11:44|  1868540|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-0B8933709CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-0B8933709CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|              Server|\n|          1|1567408304|2019-09-02 07:11:44| 1567408300|2019-09-02 07:11:40|  2262378|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|OI-3E65DFB49CF011...| 11838|         null|     11838|               659| 11838|         Server|            null|OI-3E65DFB49CF011...| MM-400 Minuteman Rd|         Server|         N|            null|  HTTP Page Download|\n|          1|1567408304|2019-09-02 07:11:44| 1567408304|2019-09-02 07:11:44|  2131840|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-7E26ACDC9CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-7E26ACDC9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|2019-09-02 07:11:44| 1567408304|2019-09-02 07:11:44|  1547990|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-07D424569CF011...| 35672|         null|     35672|               111| 35672|Processing unit|            null|OI-07D424569CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|         WMI: Server|\n|          1|1567408304|2019-09-02 07:11:44| 1567408303|2019-09-02 07:11:43|  2084968|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F53A1CBA9CEF11...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-F53A1CBA9CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|2019-09-02 07:11:44| 1567408304|2019-09-02 07:11:44|  1924187|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-38AAAA8C9CF011...| 35140|         null|     35140|              2336| 35140|Processing unit|            null|OI-38AAAA8C9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567408304|2019-09-02 07:11:44| 1567408304|2019-09-02 07:11:44|  1522543|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-E8B332D89CEF11...| 36027|        35574|     35574|              2601| 36027|Processing unit|            null|OI-E8B332D89CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408305|2019-09-02 07:11:45| 1567408305|2019-09-02 07:11:45|  2072090|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-ED76B0A69CEF11...| 36918|         null|     36918|                62| 36918|Processing unit|            null|OI-ED76B0A69CEF11...|SCCA130-2805 Lafa...|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|2019-09-02 07:11:44| 1567408304|2019-09-02 07:11:44|  1256994|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F52680389CEF11...| 34807|         null|     34807|              2778| 34807|Processing unit|            null|OI-F52680389CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|2019-09-02 07:11:44| 1567408304|2019-09-02 07:11:44|  1793904|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-84D85E229CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-84D85E229CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|         WMI: Server|\n|          1|1567408304|2019-09-02 07:11:44| 1567408304|2019-09-02 07:11:44|  2143559|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-4A1BF33E9CF011...| 19718|        34041|     34041|                82| 19718|Processing unit|            null|OI-4A1BF33E9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|            Protocol|\n|          1|1567408304|2019-09-02 07:11:44| 1567408304|2019-09-02 07:11:44|  1987081|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-F58BF5589CEF11...| 35698|         null|     35698|               435| 35698|         Server|            null|OI-F58BF5589CEF11...|WOKING-Digital Re...|         Server|         N|            null|Hardware Status M...|\n|          1|1567408306|2019-09-02 07:11:46| 1567408305|2019-09-02 07:11:45|  2155212|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-7E9C17749CF011...| 37961|         null|     37961|               307| 37961|Processing unit|            null|OI-7E9C17749CF011...|    RHUK01-Unit 3 St|Processing unit|         Y|            null|WMI: Service Monitor|\n|          1|1567408304|2019-09-02 07:11:44| 1567408304|2019-09-02 07:11:44|  2187477|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-53C9511A9CF011...| 34807|         null|     34807|              2778| 34807|Processing unit|            null|OI-53C9511A9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|         WMI: Server|\n|          1|1567408305|2019-09-02 07:11:45| 1567408304|2019-09-02 07:11:44|  2095816|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-1DC9A6829CF011...| 22842|         null|     22842|                71| 22842|Processing unit|            null|OI-1DC9A6829CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|WMI: Service Monitor|\n|          1|1567408305|2019-09-02 07:11:45| 1567408304|2019-09-02 07:11:44|  1834560|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     PREATLAS_138792| 35140|         null|     35140|              2336| 35140|        CHASSIS|   VMWARE ESXi 6|     PREATLAS_138792|SCCA130 - 2805 La...|           null|         Y|            null|                Ping|\n|          1|1567408305|2019-09-02 07:11:45| 1567408305|2019-09-02 07:11:45|  2247668|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-B2291F929E4E11...| 35563|        35664|     35664|               155| 35563|Processing unit|            null|OI-B2291F929E4E11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|              Server|\n|          1|1567408305|2019-09-02 07:11:45| 1567408305|2019-09-02 07:11:45|  1423122|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-01AA97EA9CF011...| 35655|         null|     35655|               153| 35655|Processing unit|            null|OI-01AA97EA9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|2019-09-02 07:11:44| 1567408304|2019-09-02 07:11:44|  1614961|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-1B79482E9CF011...| 35140|         null|     35140|              2336| 35140|Processing unit|            null|OI-1B79482E9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|            Protocol|\n|          1|1567408305|2019-09-02 07:11:45| 1567408305|2019-09-02 07:11:45|  2170316|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-3A3FD37C9CF011...| 37018|         null|     37018|               236| 37018|Processing unit|            null|OI-3A3FD37C9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n+-----------+----------+-------------------+-----------+-------------------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\nonly showing top 20 rows\n\nevent_logs_df: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 28 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125406_-590000831","id":"20200229-042344_1009022911","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:279"},{"text":"event_logs_df.show();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+--------------+-----------+----------------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\n|DESTINATION| CORE_TIME|CORE_TIMESTAMP|POLLER_TIME|POLLER_TIMESTAMP|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|            RECON_ID|BUS_ID|PARENT_BUS_ID|NEW_BUS_ID|RECONCILIATION_NUM|BUS_ID|    DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|                SITE|      TYPE_NAME|IS_VIRTUAL|PARENT_TARGET_ID|        MONITOR_DESC|\n+-----------+----------+--------------+-----------+----------------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\n|          1|1567408304|          null| 1567408304|            null|  1868540|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-0B8933709CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-0B8933709CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|              Server|\n|          1|1567408304|          null| 1567408300|            null|  2262378|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|OI-3E65DFB49CF011...| 11838|         null|     11838|               659| 11838|         Server|            null|OI-3E65DFB49CF011...| MM-400 Minuteman Rd|         Server|         N|            null|  HTTP Page Download|\n|          1|1567408304|          null| 1567408304|            null|  2131840|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-7E26ACDC9CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-7E26ACDC9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|          null| 1567408304|            null|  1547990|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-07D424569CF011...| 35672|         null|     35672|               111| 35672|Processing unit|            null|OI-07D424569CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|         WMI: Server|\n|          1|1567408304|          null| 1567408303|            null|  2084968|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F53A1CBA9CEF11...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-F53A1CBA9CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|          null| 1567408304|            null|  1924187|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-38AAAA8C9CF011...| 35140|         null|     35140|              2336| 35140|Processing unit|            null|OI-38AAAA8C9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n|          1|1567408304|          null| 1567408304|            null|  1522543|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-E8B332D89CEF11...| 36027|        35574|     35574|              2601| 36027|Processing unit|            null|OI-E8B332D89CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408305|          null| 1567408305|            null|  2072090|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-ED76B0A69CEF11...| 36918|         null|     36918|                62| 36918|Processing unit|            null|OI-ED76B0A69CEF11...|SCCA130-2805 Lafa...|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|          null| 1567408304|            null|  1256994|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-F52680389CEF11...| 34807|         null|     34807|              2778| 34807|Processing unit|            null|OI-F52680389CEF11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|          null| 1567408304|            null|  1793904|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-84D85E229CF011...| 36024|        35574|     35574|              2601| 36024|Processing unit|            null|OI-84D85E229CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|         WMI: Server|\n|          1|1567408304|          null| 1567408304|            null|  2143559|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-4A1BF33E9CF011...| 19718|        34041|     34041|                82| 19718|Processing unit|            null|OI-4A1BF33E9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|            Protocol|\n|          1|1567408304|          null| 1567408304|            null|  1987081|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-F58BF5589CEF11...| 35698|         null|     35698|               435| 35698|         Server|            null|OI-F58BF5589CEF11...|WOKING-Digital Re...|         Server|         N|            null|Hardware Status M...|\n|          1|1567408306|          null| 1567408305|            null|  2155212|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-7E9C17749CF011...| 37961|         null|     37961|               307| 37961|Processing unit|            null|OI-7E9C17749CF011...|    RHUK01-Unit 3 St|Processing unit|         Y|            null|WMI: Service Monitor|\n|          1|1567408304|          null| 1567408304|            null|  2187477|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-53C9511A9CF011...| 34807|         null|     34807|              2778| 34807|Processing unit|            null|OI-53C9511A9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|         WMI: Server|\n|          1|1567408305|          null| 1567408304|            null|  2095816|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-1DC9A6829CF011...| 22842|         null|     22842|                71| 22842|Processing unit|            null|OI-1DC9A6829CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|WMI: Service Monitor|\n|          1|1567408305|          null| 1567408304|            null|  1834560|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     PREATLAS_138792| 35140|         null|     35140|              2336| 35140|        CHASSIS|   VMWARE ESXi 6|     PREATLAS_138792|SCCA130 - 2805 La...|           null|         Y|            null|                Ping|\n|          1|1567408305|          null| 1567408305|            null|  2247668|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|OI-B2291F929E4E11...| 35563|        35664|     35664|               155| 35563|Processing unit|            null|OI-B2291F929E4E11...| MM-400 Minuteman Rd|Processing unit|         Y|            null|              Server|\n|          1|1567408305|          null| 1567408305|            null|  1423122|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|OI-01AA97EA9CF011...| 35655|         null|     35655|               153| 35655|Processing unit|            null|OI-01AA97EA9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|                Ping|\n|          1|1567408304|          null| 1567408304|            null|  1614961|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|OI-1B79482E9CF011...| 35140|         null|     35140|              2336| 35140|Processing unit|            null|OI-1B79482E9CF011...| MM-400 Minuteman Rd|Processing unit|         Y|            null|            Protocol|\n|          1|1567408305|          null| 1567408305|            null|  2170316|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|OI-3A3FD37C9CF011...| 37018|         null|     37018|               236| 37018|Processing unit|            null|OI-3A3FD37C9CF011...| MM-400 Minuteman Rd|Processing unit|         N|            null|WMI: Service Monitor|\n+-----------+----------+--------------+-----------+----------------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------------------+------+-------------+----------+------------------+------+---------------+----------------+--------------------+--------------------+---------------+----------+----------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1583209125407_1979694281","id":"20200229-044633_490756168","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:280"},{"text":"// S0 join event_log and device based on target id : OK\n// S1 join S0 and customer based on target id : OK\n// S2 join S1 and customer_parent based on bus_id : OK\n// S3 join S2 and top_customers where bus_id = custid or parent_bus_id = top_customers.bus_id :OK\n// S4 S3 join device_location_data :OK\n// add type and device hierarchy","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583209125412_-1191008880","id":"20200226-071605_293215532","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:281"},{"text":"//Get the incident.csv into a dataframe \nvar incident_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/incidents.csv\");\nincident_df = incident_df.select(\n            incident_df.col(\"incident_id\").as(\"INCIDENT_ID\"),\n            incident_df.col(\"submit_date\").as(\"SUBMIT_DATE\"),\n            incident_df.col(\"bus_id\").as(\"BUS_ID\"),\n            incident_df.col(\"event_code\").as(\"EVENT_CODE\")\n    );\nincident_df.show();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------------+------+----------+\n|    INCIDENT_ID|         SUBMIT_DATE|BUS_ID|EVENT_CODE|\n+---------------+--------------------+------+----------+\n|CRQ001000044016|22-Aug-2019 04:29:38| 36944|    DDT-11|\n|INC001000000002|14-Aug-2018 09:22:15|  9873|   APPL-85|\n|INC001000000007|16-Aug-2018 12:10:16| 35574|   NAVI-32|\n|INC001000000008|17-Aug-2018 11:50:12| 35574|    ESM-22|\n|INC001000000009|17-Aug-2018 11:59:37| 35574|    ESM-22|\n|INC001000000010|17-Aug-2018 14:26:09| 35574|    ESM-22|\n|INC001000000011|17-Aug-2018 16:12:45| 35574|   NAVI-21|\n|INC001000000012|18-Aug-2018 02:45:57| 35574|    ISM-50|\n|INC001000000013|18-Aug-2018 12:34:06| 35574|    ISM-50|\n|INC001000000015|18-Aug-2018 15:57:00| 35574|   NTWK-58|\n|INC001000000016|19-Aug-2018 05:12:33| 35574|  WLLOG-06|\n|INC001000000017|19-Aug-2018 11:59:18| 35574|   WINT-06|\n|INC001000000018|19-Aug-2018 12:26:45| 35574|    APP-01|\n|INC001000000019|19-Aug-2018 20:19:33| 35574|   WINT-07|\n|INC001000000020|20-Aug-2018 03:24:16| 35574|    ISM-50|\n|INC001000000021|20-Aug-2018 05:43:12| 35574|   WINT-07|\n|INC001000000022|20-Aug-2018 09:36:33| 35574|   WINT-07|\n|INC001000000023|20-Aug-2018 09:48:35| 35574|    APP-01|\n|INC001000000024|20-Aug-2018 09:58:00| 35574|   NTWK-58|\n|INC001000000025|20-Aug-2018 10:13:38| 35574|    APP-01|\n+---------------+--------------------+------+----------+\nonly showing top 20 rows\n\nincident_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 2 more fields]\nincident_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125413_-608311154","id":"20200229-035705_296817465","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:282"},{"text":"//Get the incident_device.csv into a dataframe \nvar incident_device_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/incident-device.csv\");\nincident_device_df = incident_device_df.select(\n            incident_device_df.col(\"incident_id\").as(\"INCIDENT_DEV_ID\"),\n            incident_device_df.col(\"recon_id\").as(\"RECON_ID\")\n    );\nincident_device_df.show();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------------+\n|INCIDENT_DEV_ID|            RECON_ID|\n+---------------+--------------------+\n|CRQ001000044016|OI-88A7FF529D1411...|\n|CRQ001000044016|OI-257C0BF49CF011...|\n|INC001000000002|OI-6C1981C69D1411...|\n|INC001000000002|OI-3C69EAF29CF011...|\n|INC001000000007|OI-64139C789D1411...|\n|INC001000000011|OI-764453A69D1411...|\n|INC001000000012|OI-51F629489D1411...|\n|INC001000000015|OI-059C5A0A9CF011...|\n|INC001000000018|OI-6D83470A9CF011...|\n|INC001000000018|OI-0ED62F4C9CF011...|\n|INC001000000020|OI-68D858669D1411...|\n|INC001000000021|OI-774EA86E9D1411...|\n|INC001000000023|OI-42156D329CF011...|\n|INC001000000024|OI-667027EE9CF011...|\n|INC001000000030|OI-68D858669D1411...|\n|INC001000000034|OI-E9C5499A9CEF11...|\n|INC001000000034|REGAA5V0GQ2KOAP33...|\n|INC001000000036|OI-68D858669D1411...|\n|INC001000000037|OI-64139C789D1411...|\n|INC001000000039|OI-68D858669D1411...|\n+---------------+--------------------+\nonly showing top 20 rows\n\nincident_device_df: org.apache.spark.sql.DataFrame = [INCIDENT_DEV_ID: string, RECON_ID: string]\nincident_device_df: org.apache.spark.sql.DataFrame = [INCIDENT_DEV_ID: string, RECON_ID: string]\n"}]},"apps":[],"jobName":"paragraph_1583209125413_974318978","id":"20200229-035841_148039032","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:283"},{"text":"var incident_recon_df = incident_df.join(incident_device_df, incident_df(\"INCIDENT_ID\") === incident_device_df(\"INCIDENT_DEV_ID\"), \"inner\").drop(\"INCIDENT_DEV_ID\");","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"incident_recon_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125413_2142259119","id":"20200229-035949_1007395544","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:284"},{"text":"// incident_df.count();     //224770\nincident_device_df.count(); //388200","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res56: Long = 388200\n"}]},"apps":[],"jobName":"paragraph_1583209125414_-1228508049","id":"20200229-040410_2031397542","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:285"},{"text":"var incident_details = incident_recon_df.join(event_code_mapped, incident_recon_df(\"EVENT_CODE\") === event_code_mapped(\"mapping_event_code\"), \"left_outer\").drop(\"mapping_event_code\");","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"incident_details: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 4 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125414_1904715440","id":"20200229-040435_790463357","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:286"},{"text":"incident_details.show();\nincident_details.count();","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------------+------+----------+--------------------+-------------+\n|    INCIDENT_ID|         SUBMIT_DATE|BUS_ID|EVENT_CODE|            RECON_ID|event_code_id|\n+---------------+--------------------+------+----------+--------------------+-------------+\n|INC001000000289|12-Aug-2018 21:18:52| 11838|   MSQL-12|OI-61BACA609CF011...|         null|\n|INC001000000289|12-Aug-2018 21:18:52| 11838|   MSQL-12|OI-6AEEC7F29D1411...|         null|\n|INC001000000417|13-Aug-2018 04:42:21| 35376|   UNIX-02|OI-596F5EA29CF011...|         null|\n|INC001000000417|13-Aug-2018 04:42:21| 35376|   UNIX-02|OI-563564EC9D1411...|         null|\n|INC001000000445|13-Aug-2018 06:03:09| 37048|   SNMP-08|OI-791C64849CF011...|           11|\n|INC001000000445|13-Aug-2018 06:03:09| 37048|   SNMP-08|OI-55DCCE9A9D1411...|           11|\n|INC001000000670|13-Aug-2018 11:38:28| 35140|    ESX-01|OI-209C10E89CF011...|         null|\n|INC001000000670|13-Aug-2018 11:38:28| 35140|    ESX-01|OI-6F7CA4BA9D1411...|         null|\n|INC001000001313|14-Aug-2018 05:24:07| 36027|   UNIX-12|OI-6FBCD6769CF011...|         null|\n|INC001000001313|14-Aug-2018 05:24:07| 36027|   UNIX-12|OI-857A2EF49D1411...|         null|\n|INC001000001370|14-Aug-2018 09:30:34| 35383|    ATS-08|OI-7F69431A9D1411...|         null|\n|INC001000001370|14-Aug-2018 09:30:34| 35383|    ATS-08|OI-278851969CF011...|         null|\n|INC001000001452|14-Aug-2018 11:30:47| 35383|    ATS-08|OI-7F69431A9D1411...|         null|\n|INC001000001452|14-Aug-2018 11:30:47| 35383|    ATS-08|OI-278851969CF011...|         null|\n|INC001000001671|14-Aug-2018 15:43:20| 35383|    ESM-18|OI-25D032889CF011...|            1|\n|INC001000001671|14-Aug-2018 15:43:20| 35383|    ESM-18|OI-591A411E9D1411...|            1|\n|INC001000002000|15-Aug-2018 07:56:07| 16715|   FRCR-01|OI-10A90B009CF011...|         null|\n|INC001000002000|15-Aug-2018 07:56:07| 16715|   FRCR-01|OI-5A10AF729D1411...|         null|\n|INC001000002223|15-Aug-2018 15:29:24| 34611|    ACM-04|OI-34A5D1FA9CF011...|         null|\n|INC001000002223|15-Aug-2018 15:29:24| 34611|    ACM-04|OI-59B19D8E9D1411...|         null|\n+---------------+--------------------+------+----------+--------------------+-------------+\nonly showing top 20 rows\n\nres59: Long = 388200\n"}]},"apps":[],"jobName":"paragraph_1583209125415_-48917811","id":"20200229-041807_1722846343","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:287"},{"text":"var incident_details_df = incident_details.select(\n            col(\"INCIDENT_ID\"),\n            col(\"SUBMIT_DATE\"), \n            unix_timestamp(col(\"SUBMIT_DATE\"), \"dd-MMM-yyyy HH:mm:ss\").as(\"SUBMIT_DATE_MS\"),\n            col(\"BUS_ID\"),\n            col(\"EVENT_CODE\"),\n            col(\"RECON_ID\"),\n            col(\"event_code_id\").as(\"EVENT_CODE_ID\")\n            );\nincident_details_df.show()","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------------+--------------+------+----------+--------------------+-------------+\n|    INCIDENT_ID|         SUBMIT_DATE|SUBMIT_DATE_MS|BUS_ID|EVENT_CODE|            RECON_ID|EVENT_CODE_ID|\n+---------------+--------------------+--------------+------+----------+--------------------+-------------+\n|INC001000000289|12-Aug-2018 21:18:52|    1534108732| 11838|   MSQL-12|OI-61BACA609CF011...|         null|\n|INC001000000289|12-Aug-2018 21:18:52|    1534108732| 11838|   MSQL-12|OI-6AEEC7F29D1411...|         null|\n|INC001000000417|13-Aug-2018 04:42:21|    1534135341| 35376|   UNIX-02|OI-596F5EA29CF011...|         null|\n|INC001000000417|13-Aug-2018 04:42:21|    1534135341| 35376|   UNIX-02|OI-563564EC9D1411...|         null|\n|INC001000000445|13-Aug-2018 06:03:09|    1534140189| 37048|   SNMP-08|OI-791C64849CF011...|           11|\n|INC001000000445|13-Aug-2018 06:03:09|    1534140189| 37048|   SNMP-08|OI-55DCCE9A9D1411...|           11|\n|INC001000000670|13-Aug-2018 11:38:28|    1534160308| 35140|    ESX-01|OI-209C10E89CF011...|         null|\n|INC001000000670|13-Aug-2018 11:38:28|    1534160308| 35140|    ESX-01|OI-6F7CA4BA9D1411...|         null|\n|INC001000001313|14-Aug-2018 05:24:07|    1534224247| 36027|   UNIX-12|OI-6FBCD6769CF011...|         null|\n|INC001000001313|14-Aug-2018 05:24:07|    1534224247| 36027|   UNIX-12|OI-857A2EF49D1411...|         null|\n|INC001000001370|14-Aug-2018 09:30:34|    1534239034| 35383|    ATS-08|OI-7F69431A9D1411...|         null|\n|INC001000001370|14-Aug-2018 09:30:34|    1534239034| 35383|    ATS-08|OI-278851969CF011...|         null|\n|INC001000001452|14-Aug-2018 11:30:47|    1534246247| 35383|    ATS-08|OI-7F69431A9D1411...|         null|\n|INC001000001452|14-Aug-2018 11:30:47|    1534246247| 35383|    ATS-08|OI-278851969CF011...|         null|\n|INC001000001671|14-Aug-2018 15:43:20|    1534261400| 35383|    ESM-18|OI-25D032889CF011...|            1|\n|INC001000001671|14-Aug-2018 15:43:20|    1534261400| 35383|    ESM-18|OI-591A411E9D1411...|            1|\n|INC001000002000|15-Aug-2018 07:56:07|    1534319767| 16715|   FRCR-01|OI-10A90B009CF011...|         null|\n|INC001000002000|15-Aug-2018 07:56:07|    1534319767| 16715|   FRCR-01|OI-5A10AF729D1411...|         null|\n|INC001000002223|15-Aug-2018 15:29:24|    1534346964| 34611|    ACM-04|OI-34A5D1FA9CF011...|         null|\n|INC001000002223|15-Aug-2018 15:29:24|    1534346964| 34611|    ACM-04|OI-59B19D8E9D1411...|         null|\n+---------------+--------------------+--------------+------+----------+--------------------+-------------+\nonly showing top 20 rows\n\nincident_details_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1583209125416_184501197","id":"20200229-042419_1640347198","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:288"},{"text":"/* TODO ::: \nDataframes to load to database :\n1. event_logs_desc\n2. incident_details_df\n*/","user":"anonymous","dateUpdated":"2020-03-03T04:18:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583209125416_-846069194","id":"20200229-041934_1171294660","dateCreated":"2020-03-03T04:18:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:289"},{"text":"//create properties object\nval prop = new java.util.Properties\nprop.setProperty(\"driver\", \"com.mysql.jdbc.Driver\")\nprop.setProperty(\"user\", \"root\")\nprop.setProperty(\"password\", \"rdx-mysql\") \n \nval mysqlDBName = \"\"\nval url = \"jdbc:mysql://localhost:3306/\" + mysqlDBName","user":"anonymous","dateUpdated":"2020-03-03T07:29:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583209125416_371162679","id":"20200229-041820_525116366","dateCreated":"2020-03-03T04:18:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:290","dateFinished":"2020-03-03T07:29:03+0000","dateStarted":"2020-03-03T07:29:03+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"prop: java.util.Properties = {user=root, password=rdx-mysql, driver=com.mysql.jdbc.Driver}\nmysqlDBName: String = \"\"\nurl: String = jdbc:mysql://localhost:3306/\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583219426825_-2079543279","id":"20200303-071026_1856232868","dateCreated":"2020-03-03T07:10:26+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3199","text":"// load(append) event_logs_df into table - \nval EventTableName = \"\"\nevent_logs_df.write.mode(\"append\").jdbc(url, EventTableName, prop)","dateUpdated":"2020-03-03T07:27:48+0000"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583219519916_-450214272","id":"20200303-071159_1018100970","dateCreated":"2020-03-03T07:11:59+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3271","text":"// load(append) incident_details_df into table - \nval IncidentTableName = \"\"\nevent_logs_df.write.mode(\"append\").jdbc(url, IncidentTableName, prop)","dateUpdated":"2020-03-03T07:29:28+0000"}],"name":"ETL2","id":"2F3Y18Z76","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}