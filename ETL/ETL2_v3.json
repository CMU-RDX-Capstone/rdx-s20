{"paragraphs":[{"text":"import org.apache.spark.sql.expressions.Window;\r\nimport org.apache.spark.sql.types.TimestampType;\r\n// import org.apache.spark.sql.expressions.Window","user":"anonymous","dateUpdated":"2020-03-24T15:30:23+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.expressions.Window\nimport org.apache.spark.sql.types.TimestampType\n"}]},"apps":[],"jobName":"paragraph_1584717386154_-156677206","id":"20200229-023639_871760853","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T15:30:23+0000","dateFinished":"2020-03-24T15:30:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20141"},{"text":"//Get the bus_parent.csv into a dataframe \nvar bus_parent_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/bus_parent.csv\");\nbus_parent_df = bus_parent_df.select(\n            bus_parent_df.col(\"PARENT_ID\").as(\"PARENT_BUS_ID\"),\n            bus_parent_df.col(\"BUS_ID\").as(\"HIER_BUS_ID\")\n    );\nbus_parent_df.show();","user":"anonymous","dateUpdated":"2020-03-24T15:30:24+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-----------+\n|PARENT_BUS_ID|HIER_BUS_ID|\n+-------------+-----------+\n|         1914|       5793|\n|        14748|       9873|\n|         1914|      10354|\n|         1914|      10615|\n|         1914|      11376|\n|        29710|      11839|\n|        29710|      11840|\n|         1914|      11841|\n|         1914|      11895|\n|        34872|      11896|\n|         1914|      12175|\n|         1914|      13615|\n|         1914|      14035|\n|         1914|      14655|\n|        29710|      14912|\n|        29710|      14913|\n|        29710|      14923|\n|        29710|      14924|\n|        29710|      14925|\n|        29710|      14929|\n+-------------+-----------+\nonly showing top 20 rows\n\nbus_parent_df: org.apache.spark.sql.DataFrame = [PARENT_BUS_ID: string, HIER_BUS_ID: string]\nbus_parent_df: org.apache.spark.sql.DataFrame = [PARENT_BUS_ID: string, HIER_BUS_ID: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=2","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386160_846613508","id":"20200226-060757_2141589333","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T15:30:24+0000","dateFinished":"2020-03-24T15:30:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20142"},{"text":"//Get the customer.csv into a dataframe \nvar customer_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/customer.csv\");\ncustomer_df = customer_df.select(\n            customer_df.col(\"RECONCILIATION_ID\"),\n            customer_df.col(\"BUS_ID\").as(\"BUS_ID\")\n    );\ncustomer_df.show();","user":"anonymous","dateUpdated":"2020-03-24T15:30:27+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------+\n|   RECONCILIATION_ID|BUS_ID|\n+--------------------+------+\n|OI-FDF0CAB69CEF11...| 37146|\n|OI-D723D6129D9911...| 38023|\n|OI-6E3509E09CF011...| 16715|\n|OI-343704B49CF011...| 19922|\n|OI-6F5224DE9CF011...| 37373|\n|OI-3170ECAE9CF011...| 35140|\n|OI-7E74093C9CF011...| 35663|\n|OI-64074C4E9CF011...| 34807|\n|OI-8A2BBAF49DA411...| 38177|\n|OI-498348969CF011...| 35562|\n|OI-6D8C65069CF011...| 34821|\n|OI-8698CEEA9CF011...| 27010|\n|OI-1A354A3A9CF011...| 35574|\n|OI-6BD775709CF011...| 36024|\n|OI-3F5DC0F89CF011...| 35310|\n|OI-7F198BE69DA411...| 32710|\n|OI-8943417A9DA411...| 35383|\n|OI-39EFEBAA9CF011...| 35376|\n|OI-0406791E9CF011...| 37018|\n|OI-1AEC4C3A9CF011...| 10615|\n+--------------------+------+\nonly showing top 20 rows\n\ncustomer_df: org.apache.spark.sql.DataFrame = [RECONCILIATION_ID: string, BUS_ID: string]\ncustomer_df: org.apache.spark.sql.DataFrame = [RECONCILIATION_ID: string, BUS_ID: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=4","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=5"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386161_-1028076798","id":"20200226-060821_1073898764","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T15:30:27+0000","dateFinished":"2020-03-24T15:30:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20143"},{"text":"//Get the device.csv into a dataframe \nvar device_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/device.csv\");\ndevice_df = device_df.select(\n            device_df.col(\"TARGET_ID\").as(\"DEVICE_TARGET_ID\"),\n            device_df.col(\"RECON_ID\")\n    )\ndevice_df.show();","user":"anonymous","dateUpdated":"2020-03-24T15:30:29+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+--------------+\n|DEVICE_TARGET_ID|      RECON_ID|\n+----------------+--------------+\n|            2777|PREATLAS_22811|\n|            2778|PREATLAS_22811|\n|            2779|PREATLAS_22811|\n|            2780|PREATLAS_22811|\n|            2781|PREATLAS_22811|\n|            2782|PREATLAS_22811|\n|            2783|PREATLAS_22811|\n|            2784|PREATLAS_22811|\n|            2785|PREATLAS_22811|\n|            2786|PREATLAS_22811|\n|            2787|PREATLAS_22811|\n|            2788|PREATLAS_22811|\n|            2789|PREATLAS_22811|\n|            2790|PREATLAS_22811|\n|            2791|PREATLAS_22811|\n|            2792|PREATLAS_22811|\n|            2793|PREATLAS_22811|\n|            2794|PREATLAS_22811|\n|            2795|PREATLAS_22811|\n|            2796|PREATLAS_22811|\n+----------------+--------------+\nonly showing top 20 rows\n\ndevice_df: org.apache.spark.sql.DataFrame = [DEVICE_TARGET_ID: string, RECON_ID: string]\ndevice_df: org.apache.spark.sql.DataFrame = [DEVICE_TARGET_ID: string, RECON_ID: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=6","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=7"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386162_569059071","id":"20200226-060859_2104217724","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T15:30:30+0000","dateFinished":"2020-03-24T15:30:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20144"},{"text":"//Get the device_location.csv into a dataframe \nvar device_location_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/device_location.csv\");\ndevice_location_df = device_location_df.select(\n    col(\"BUS_ID\").as(\"BUS_ID_DEV\"),\n    col(\"DEVICE_TYPE\"),\n    col(\"OPERATING_SYSTEM\"),\n    col(\"RECONCILIATION_ID\"),\n    col(\"SITE\"),\n    col(\"SITE\").as(\"SITE_DESC\"),\n    col(\"IS_VIRTUAL\")\n    );\ndevice_location_df.show();","user":"anonymous","dateUpdated":"2020-03-24T16:26:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\n|BUS_ID_DEV|         DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|                SITE|           SITE_DESC|IS_VIRTUAL|\n+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\n|     37146|   RAIDStorageDevice|            null|OI-FDF0CAB69CEF11...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     38023|              Server|            null|OI-D723D6129D9911...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         Y|\n|     16715|              Server|            null|OI-6E3509E09CF011...|    RHUK01-Unit 3 St|    RHUK01-Unit 3 St|         Y|\n|     19922|              Router|            null|OI-343704B49CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     37373|              Server|            null|OI-6F5224DE9CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         Y|\n|     35140|              Switch|            null|OI-3170ECAE9CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     35663|       Load Balancer|            null|OI-7E74093C9CF011...|WOKING-Digital Re...|WOKING-Digital Re...|         Y|\n|     34807|              Server|            null|OI-64074C4E9CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         Y|\n|     38177|Link Aggregation Tap|            null|OI-8A2BBAF49DA411...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     35562|              Server|            null|OI-498348969CF011...|SCCA130-2805 Lafa...|SCCA130-2805 Lafa...|         Y|\n|     34821|              Switch|            null|OI-6D8C65069CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     27010|              Server|            null|OI-8698CEEA9CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     35574|             Network|            null|OI-1A354A3A9CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     36024|              Server|            null|OI-6BD775709CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         Y|\n|     35310|              Server|            null|OI-3F5DC0F89CF011...|    RHUK01-Unit 3 St|    RHUK01-Unit 3 St|         N|\n|     32710|            Firewall|            null|OI-7F198BE69DA411...|LOUK01-East India...|LOUK01-East India...|         N|\n|     35383|              Router|            null|OI-8943417A9DA411...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     35376|     Processing unit|            null|OI-39EFEBAA9CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     37018|              Server|            null|OI-0406791E9CF011...|SCCA120-2805 Lafa...|SCCA120-2805 Lafa...|         Y|\n|     10615|              Server|            null|OI-1AEC4C3A9CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\ndevice_location_df: org.apache.spark.sql.DataFrame = [BUS_ID_DEV: string, DEVICE_TYPE: string ... 5 more fields]\ndevice_location_df: org.apache.spark.sql.DataFrame = [BUS_ID_DEV: string, DEVICE_TYPE: string ... 5 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=73","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=74"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386163_-1058557486","id":"20200226-060859_1373866278","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:26:34+0000","dateFinished":"2020-03-24T16:26:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20145"},{"text":"// clean SITE values\ndevice_location_df =  device_location_df.withColumn(\"SITE\" ,regexp_replace(col(\"SITE\"), \"[^0-9a-zA-Z]+\", \"\"));\ndevice_location_df.show();","user":"anonymous","dateUpdated":"2020-03-24T16:26:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\n|BUS_ID_DEV|         DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|                SITE|           SITE_DESC|IS_VIRTUAL|\n+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\n|     37146|   RAIDStorageDevice|            null|OI-FDF0CAB69CEF11...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     38023|              Server|            null|OI-D723D6129D9911...|    MM400MinutemanRd| MM-400 Minuteman Rd|         Y|\n|     16715|              Server|            null|OI-6E3509E09CF011...|       RHUK01Unit3St|    RHUK01-Unit 3 St|         Y|\n|     19922|              Router|            null|OI-343704B49CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     37373|              Server|            null|OI-6F5224DE9CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         Y|\n|     35140|              Switch|            null|OI-3170ECAE9CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     35663|       Load Balancer|            null|OI-7E74093C9CF011...| WOKINGDigitalRealty|WOKING-Digital Re...|         Y|\n|     34807|              Server|            null|OI-64074C4E9CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         Y|\n|     38177|Link Aggregation Tap|            null|OI-8A2BBAF49DA411...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     35562|              Server|            null|OI-498348969CF011...|SCCA1302805Lafaye...|SCCA130-2805 Lafa...|         Y|\n|     34821|              Switch|            null|OI-6D8C65069CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     27010|              Server|            null|OI-8698CEEA9CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     35574|             Network|            null|OI-1A354A3A9CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     36024|              Server|            null|OI-6BD775709CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         Y|\n|     35310|              Server|            null|OI-3F5DC0F89CF011...|       RHUK01Unit3St|    RHUK01-Unit 3 St|         N|\n|     32710|            Firewall|            null|OI-7F198BE69DA411...|LOUK01EastIndiaDo...|LOUK01-East India...|         N|\n|     35383|              Router|            null|OI-8943417A9DA411...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     35376|     Processing unit|            null|OI-39EFEBAA9CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     37018|              Server|            null|OI-0406791E9CF011...|SCCA1202805Lafaye...|SCCA120-2805 Lafa...|         Y|\n|     10615|              Server|            null|OI-1AEC4C3A9CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\ndevice_location_df: org.apache.spark.sql.DataFrame = [BUS_ID_DEV: string, DEVICE_TYPE: string ... 5 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=75"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717528691_486021037","id":"20200320-151848_49424552","dateCreated":"2020-03-20T15:18:48+0000","dateStarted":"2020-03-24T16:26:51+0000","dateFinished":"2020-03-24T16:26:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20146"},{"text":"//Get the parent.csv into a dataframe \nvar parent_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/parent.csv\");\n\nparent_df = parent_df.select(\n            parent_df.col(\"PARENT_ID\").as(\"PARENT_TARGET_ID\"),\n            parent_df.col(\"TARGET_ID\").as(\"CHILD_TARGET_ID\")\n    );","user":"anonymous","dateUpdated":"2020-03-24T16:26:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"parent_df: org.apache.spark.sql.DataFrame = [PARENT_TARGET_ID: string, CHILD_TARGET_ID: string]\nparent_df: org.apache.spark.sql.DataFrame = [PARENT_TARGET_ID: string, CHILD_TARGET_ID: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=76"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386163_1147370828","id":"20200226-060858_614673072","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:26:58+0000","dateFinished":"2020-03-24T16:26:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20147"},{"text":"//Get the type.csv into a dataframe \nvar type_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/type.csv\");\n\ntype_df = type_df.select(\n            type_df.col(\"TARGET_ID\").as(\"MONITOR_ID\"),\n            type_df.col(\"TYPE\").as(\"MONITOR_DESC\")\n    );\n    ","user":"anonymous","dateUpdated":"2020-03-24T16:27:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"type_df: org.apache.spark.sql.DataFrame = [MONITOR_ID: string, MONITOR_DESC: string]\ntype_df: org.apache.spark.sql.DataFrame = [MONITOR_ID: string, MONITOR_DESC: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=77"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386164_-441486153","id":"20200226-060858_967312711","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:27:04+0000","dateFinished":"2020-03-24T16:27:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20148"},{"text":"val test = type_df.select(\"MONITOR_DESC\").distinct();\ntest.show()","user":"anonymous","dateUpdated":"2020-03-24T15:30:39+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|        MONITOR_DESC|\n+--------------------+\n|        Power Supply|\n|   WMI: Logical Disk|\n|         Memory Pool|\n|      Dynamo Process|\n|      INSYNC Monitor|\n|BMC: Network Inte...|\n|                Ping|\n|Apache Server Status|\n|   Network Interface|\n|            Firewall|\n|WMI: Service Monitor|\n|   Generic Component|\n|       Voltage Probe|\n|      Protocol (NTP)|\n|             Disk IO|\n|      PeopleSoft Job|\n|   Temperature Probe|\n|           BMC: Disk|\n|   Dynamo SNMP Probe|\n|Alteon ISD Enviro...|\n+--------------------+\nonly showing top 20 rows\n\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [MONITOR_DESC: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=13","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=14","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=15","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=16"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386164_602633382","id":"20200304-235146_648570979","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T15:30:41+0000","dateFinished":"2020-03-24T15:30:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20149"},{"text":"//Get the event_log.csv into a dataframe \nvar event_log_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/event.log.20190902031144.csv\");\nevent_log_df = event_log_df.filter(\"policy_type == 'T'\" ).filter(\"metric_name != 'Started'\");\n// event_log_df.count();\nevent_log_df.show();","user":"anonymous","dateUpdated":"2020-03-24T15:30:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+------------+\n|destination| core_time|poller_time|target_id|policy_id|policy_type|detected_severity|propagated_severity|low_threshold|measured_value|high_threshold|propagated_flag|event_code| metric_name|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+------------+\n|          1|1567408304| 1567408304|  2718523|     1347|          T|                0|                  0|         -inf|       1281576|           inf|              0|   UNIX-03|memAvailReal|\n|          1|1567408304| 1567408304|  2718523|     1760|          T|                0|                  0|         -inf|     891074169|           inf|              0|   UNIX-10|   sysUptime|\n|          1|1567408304| 1567408304|  3550849|     4022|          T|                0|                  0|         -inf|       4937195|           inf|              0|   WINT-07|SystemUpTime|\n|          1|1567408304| 1567408304|  3550849|     4302|          T|                0|                  0|            0|         11.98|           inf|              0|   WINT-01|    PctTotal|\n|          1|1567408304| 1567408304|  3550849|     4382|          T|                0|                  0|         -inf|    3217473536|           inf|              0|   WINT-27|    MemAvail|\n|          1|1567408304| 1567408304|  3550937|     4303|          T|                0|                  0|            0|         14.07|           inf|              0|   WINT-01|    PctTotal|\n|          1|1567408304| 1567408304|  3550938|     4303|          T|                0|                  0|            0|          9.30|           inf|              0|   WINT-01|    PctTotal|\n|          1|1567408304| 1567408304|  3550939|     4303|          T|                0|                  0|            0|         11.27|           inf|              0|   WINT-01|    PctTotal|\n|          1|1567408304| 1567408304|  3550940|     4303|          T|                0|                  0|            0|         13.27|           inf|              0|   WINT-01|    PctTotal|\n|          1|1567408304| 1567408304|  3550945|     2740|          T|                0|                  0|            0|         32.26|           inf|              0|   WINT-02|     PctFree|\n|          1|1567408304| 1567408304|  3550946|     2740|          T|                0|                  0|            0|         99.30|           inf|              0|   WINT-02|     PctFree|\n|          1|1567408304| 1567408304|  3550947|     2740|          T|                0|                  0|            0|         89.58|           inf|              0|   WINT-02|     PctFree|\n|          1|1567408304| 1567408304|  3550948|     2740|          T|                0|                  0|            0|         87.06|           inf|              0|   WINT-02|     PctFree|\n|          1|1567408304| 1567408304|  3550949|     2740|          T|                0|                  0|            0|         86.89|           inf|              0|   WINT-02|     PctFree|\n|          1|1567408304| 1567408304|  3550950|     2222|          T|                0|                  0|         -inf|         67.10|           inf|              0|   WINT-02|     PctFree|\n|          1|1567408304| 1567408304|  3550951|     2740|          T|                0|                  0|            0|         16.02|           inf|              0|   WINT-02|     PctFree|\n|          1|1567408304| 1567408304|  3550952|     2740|          T|                0|                  0|            0|         84.81|           inf|              0|   WINT-02|     PctFree|\n|          1|1567408304| 1567408304|  1407391|     2227|          T|                0|                  0|         -inf|   10125307904|           inf|              0|   WINT-27|    MemAvail|\n|          1|1567408304| 1567408304|  1407391|     3943|          T|                0|                  0|         -inf|          2.30|           inf|              0|   WINT-01|    PctTotal|\n|          1|1567408304| 1567408304|  1407391|     4022|          T|                0|                  0|         -inf|       3111629|           inf|              0|   WINT-07|SystemUpTime|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+------------+\nonly showing top 20 rows\n\nevent_log_df: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 12 more fields]\nevent_log_df: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 12 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=17","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=18"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386165_-1378195101","id":"20200226-060855_595029811","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T15:30:58+0000","dateFinished":"2020-03-24T15:31:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20150"},{"text":"// get top customers from top_clients.csv\nvar top_clients_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/top_clients.csv\");\ntop_clients_df = top_clients_df.select(\n            top_clients_df.col(\"NEW_BUS_ID\").as(\"NEW_BUS_ID\"),\n            top_clients_df.col(\"RECONCILIATION_NUM\").as(\"NUM_CUST_DEVICES\"),\n            top_clients_df.col(\"PERCENT\").as(\"PERCENT\"),\n            top_clients_df.col(\"CUMULATIVE_PERCENT\").as(\"CUMULATIVE_PERCENT\"),\n            top_clients_df.col(\"RANK\").as(\"RANK\")\n    );\n\n\ntop_clients_df.show();","user":"anonymous","dateUpdated":"2020-03-24T16:28:20+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+----------------+-------+------------------+----+\n|NEW_BUS_ID|NUM_CUST_DEVICES|PERCENT|CUMULATIVE_PERCENT|RANK|\n+----------+----------------+-------+------------------+----+\n|     34807|            2778|  0.049|             0.049|   1|\n|     35574|            2601|  0.046|             0.095|   2|\n|     35140|            2336|  0.041|             0.136|   3|\n|      1914|            1863|  0.033|             0.169|   4|\n|     29710|            1376|  0.024|             0.193|   5|\n|     32890|            1308|  0.023|             0.216|   6|\n|     35383|            1174|  0.021|             0.237|   7|\n|     11838|             659|  0.012|             0.248|   8|\n|     35821|             615|  0.011|             0.259|   9|\n|     33554|             612|  0.011|             0.270|  10|\n|     33617|             603|  0.011|             0.281|  11|\n|     15804|             592|  0.010|             0.291|  12|\n|     35340|             554|  0.010|             0.301|  13|\n|     36973|             544|  0.010|             0.311|  14|\n|     35562|             521|  0.009|             0.320|  15|\n|     35698|             435|  0.008|             0.327|  16|\n|     11876|             429|  0.008|             0.335|  17|\n|     16715|             405|  0.007|             0.342|  18|\n|     35183|             373|  0.007|             0.349|  19|\n|     14748|             325|  0.006|             0.354|  20|\n+----------+----------------+-------+------------------+----+\nonly showing top 20 rows\n\ntop_clients_df: org.apache.spark.sql.DataFrame = [NEW_BUS_ID: string, NUM_CUST_DEVICES: string ... 3 more fields]\ntop_clients_df: org.apache.spark.sql.DataFrame = [NEW_BUS_ID: string, NUM_CUST_DEVICES: string ... 3 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=78","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=79"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386165_-480616775","id":"20200226-063855_62253060","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:28:20+0000","dateFinished":"2020-03-24T16:28:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20151"},{"text":"// Get EventCode and an associated intger mapping\nvar event_code_mapped = event_log_df.select(\"event_code\").distinct();\nevent_code_mapped = event_code_mapped.withColumn(\"event_code_id\", row_number().over(Window.orderBy(\"event_code\")));\nevent_code_mapped = event_code_mapped.select(\n         event_code_mapped.col(\"event_code_id\"),\n       event_code_mapped.col(\"event_code\").as(\"mapping_event_code\")\n    )\n    \nregexp_replace(event_code_mapped(\"mapping_event_code\"),\"\\\\s+\",\" \");","user":"anonymous","dateUpdated":"2020-03-24T15:31:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: int, mapping_event_code: string]\nevent_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: int, mapping_event_code: string]\nevent_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: int, mapping_event_code: string]\nres10: org.apache.spark.sql.Column = regexp_replace(mapping_event_code, \\s+,  )\n"}]},"apps":[],"jobName":"paragraph_1584717386166_-1741733152","id":"20200226-065423_868519549","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T15:31:14+0000","dateFinished":"2020-03-24T15:31:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20152"},{"text":"event_code_mapped.show()","user":"anonymous","dateUpdated":"2020-03-24T15:31:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+------------------+\n|event_code_id|mapping_event_code|\n+-------------+------------------+\n|            1|          CISCO-02|\n|            2|          CISCO-16|\n|            3|          CISCO-17|\n|            4|          CISCO-18|\n|            5|          CISCO-19|\n|            6|          CISCO-23|\n|            7|          CISCO-24|\n|            8|          COMPQ-02|\n|            9|          COMPQ-03|\n|           10|          COMPQ-10|\n|           11|          COMPQ-12|\n|           12|          COMPQ-17|\n|           13|          COMPQ-18|\n|           14|          COMPQ-19|\n|           15|          DBORA-13|\n|           16|           DELL-01|\n|           17|           DELL-02|\n|           18|           DELL-03|\n|           19|           DELL-07|\n|           20|           DELL-08|\n+-------------+------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=21"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386167_1437411166","id":"20200229-021209_2085882877","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T15:31:15+0000","dateFinished":"2020-03-24T15:33:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20153"},{"text":"var device_event_log = event_log_df.join(device_df, event_log_df.col(\"TARGET_ID\") === device_df.col(\"DEVICE_TARGET_ID\"), \"inner\")\n                            .drop(\"DEVICE_TARGET_ID\");\n// device_event_log.count();// : 47\n// device_event_log.show();","user":"anonymous","dateUpdated":"2020-03-24T16:29:17+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"device_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1584717386167_-1017995866","id":"20200226-072006_528594224","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:28:45+0000","dateFinished":"2020-03-24T16:28:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20154"},{"text":"var cust_device_event_log = device_event_log\n    .join(customer_df, device_event_log.col(\"RECON_ID\") === customer_df.col(\"RECONCILIATION_ID\"), \"inner\").drop(\"RECONCILIATION_ID\");\n//  cust_device_event_log.count(); // 47\n// cust_device_event_log.show();","user":"anonymous","dateUpdated":"2020-03-24T16:29:17+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cust_device_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 14 more fields]\n"}]},"apps":[],"jobName":"paragraph_1584717386168_-1254575494","id":"20200226-075401_853406802","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:28:51+0000","dateFinished":"2020-03-24T16:28:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20155"},{"text":"var cust_detail_device_event_log = cust_device_event_log\n    .join(bus_parent_df, cust_device_event_log.col(\"BUS_ID\") === bus_parent_df.col(\"HIER_BUS_ID\"), \"left_outer\").drop(\"HIER_BUS_ID\");\n//cust_detail_device_event_log.show();\n","user":"anonymous","dateUpdated":"2020-03-24T16:29:17+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cust_detail_device_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 15 more fields]\n"}]},"apps":[],"jobName":"paragraph_1584717386168_1348683663","id":"20200226-080124_1698475559","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:29:00+0000","dateFinished":"2020-03-24T16:29:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20156"},{"text":"var top_cust_detail_device_event_log = \ncust_detail_device_event_log.join(top_clients_df, cust_detail_device_event_log(\"BUS_ID\") === top_clients_df(\"NEW_BUS_ID\") || cust_detail_device_event_log(\"PARENT_BUS_ID\") === top_clients_df(\"NEW_BUS_ID\"), \"inner\").drop(\"CUMULATIVE_PERCENT\", \"RANK\", \"PERCENT\"); \n\n//top_cust_detail_device_event_log.show();","user":"anonymous","dateUpdated":"2020-03-24T16:29:17+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"top_cust_detail_device_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 17 more fields]\n"}]},"apps":[],"jobName":"paragraph_1584717386169_1779834290","id":"20200229-022405_11824168","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:29:05+0000","dateFinished":"2020-03-24T16:29:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20157"},{"text":"top_cust_detail_device_event_log.show();\ntop_cust_detail_device_event_log.count();","user":"anonymous","dateUpdated":"2020-03-24T15:51:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+--------------+--------------------+------+-------------+----------+----------------+\n|destination| core_time|poller_time|target_id|policy_id|policy_type|detected_severity|propagated_severity|low_threshold|measured_value|high_threshold|propagated_flag|event_code|   metric_name|            RECON_ID|BUS_ID|PARENT_BUS_ID|NEW_BUS_ID|NUM_CUST_DEVICES|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+--------------+--------------------+------+-------------+----------+----------------+\n|          1|1567408525| 1567408525|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567408825| 1567408825|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567409125| 1567409125|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567409425| 1567409425|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567409725| 1567409725|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567413325| 1567413325|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567413625| 1567413625|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567413925| 1567413925|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567414225| 1567414225|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567414525| 1567414525|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567418125| 1567418125|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567418425| 1567418425|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567418725| 1567418725|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567419025| 1567419025|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567419325| 1567419325|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567421425| 1567421425|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567421725| 1567421725|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567422025| 1567422025|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567422325| 1567422325|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n|          1|1567422625| 1567422625|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+--------------+--------------------+------+-------------+----------+----------------+\nonly showing top 20 rows\n\nres16: Long = 10497195\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=33","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=34","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=35","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=36","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=37","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=38","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=39","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=40"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386170_-1079033225","id":"20200229-024822_1508795478","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T15:51:14+0000","dateFinished":"2020-03-24T15:59:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20158"},{"text":"var top_cust_device_detail_event_log = top_cust_detail_device_event_log.join(device_location_df, top_cust_detail_device_event_log(\"RECON_ID\") === device_location_df(\"RECONCILIATION_ID\"), \"left_outer\").drop(\"BUS_ID_DEV\").drop(\"RECONCILIATION_ID\");\n\n// top_cust_device_detail_event_log.show();","user":"anonymous","dateUpdated":"2020-03-24T16:29:12+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"top_cust_device_detail_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 22 more fields]\n"}]},"apps":[],"jobName":"paragraph_1584717386170_1170527559","id":"20200229-024946_1459553842","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:29:12+0000","dateFinished":"2020-03-24T16:29:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20159"},{"text":"top_cust_device_detail_event_log.show();","user":"anonymous","dateUpdated":"2020-03-24T16:29:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+--------------+--------------------+------+-------------+----------+----------------+---------------+----------------+----------------+-------------------+----------+\n|destination| core_time|poller_time|target_id|policy_id|policy_type|detected_severity|propagated_severity|low_threshold|measured_value|high_threshold|propagated_flag|event_code|   metric_name|            RECON_ID|BUS_ID|PARENT_BUS_ID|NEW_BUS_ID|NUM_CUST_DEVICES|    DEVICE_TYPE|OPERATING_SYSTEM|            SITE|          SITE_DESC|IS_VIRTUAL|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+--------------+--------------------+------+-------------+----------+----------------+---------------+----------------+----------------+-------------------+----------+\n|          1|1567408525| 1567408525|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567408825| 1567408825|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567409125| 1567409125|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567409425| 1567409425|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567409725| 1567409725|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567414825| 1567414825|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567415125| 1567415125|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567415425| 1567415425|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567415725| 1567415725|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567416025| 1567416025|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567416325| 1567416325|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567421425| 1567421425|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567421725| 1567421725|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567422025| 1567422025|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567422325| 1567422325|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567422625| 1567422625|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567427725| 1567427725|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567428025| 1567428025|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567428325| 1567428325|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n|          1|1567428625| 1567428625|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142|Processing unit|            null|MM400MinutemanRd|MM-400 Minuteman Rd|         N|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+--------------+--------------------+------+-------------+----------+----------------+---------------+----------------+----------------+-------------------+----------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=81","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=82","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=83","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=84","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=85"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585066592677_675636754","id":"20200324-161632_1097792464","dateCreated":"2020-03-24T16:16:32+0000","dateStarted":"2020-03-24T16:29:25+0000","dateFinished":"2020-03-24T16:33:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20160"},{"text":"var top_cust_device_monitor_event_log \n= top_cust_device_detail_event_log.join(parent_df, top_cust_device_detail_event_log(\"TARGET_ID\") === parent_df(\"CHILD_TARGET_ID\"), \"left_outer\").drop(\"CHILD_TARGET_ID\");","user":"anonymous","dateUpdated":"2020-03-24T16:33:46+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"top_cust_device_monitor_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 23 more fields]\n"}]},"apps":[],"jobName":"paragraph_1584717386171_-878417654","id":"20200229-030552_960796511","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:33:46+0000","dateFinished":"2020-03-24T16:33:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20161"},{"text":"// top_cust_device_monitor_event_log.count();\ntop_cust_device_monitor_event_log.show();","user":"anonymous","dateUpdated":"2020-03-24T16:02:56+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+--------------+--------------------+------+-------------+----------+----------------+------+---------------+----------------+----------------+---------------+----------+----------------+\n|destination| core_time|poller_time|target_id|policy_id|policy_type|detected_severity|propagated_severity|low_threshold|measured_value|high_threshold|propagated_flag|event_code|   metric_name|            RECON_ID|BUS_ID|PARENT_BUS_ID|NEW_BUS_ID|NUM_CUST_DEVICES|BUS_ID|    DEVICE_TYPE|OPERATING_SYSTEM|            SITE|      TYPE_NAME|IS_VIRTUAL|PARENT_TARGET_ID|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+--------------+--------------------+------+-------------+----------+----------------+------+---------------+----------------+----------------+---------------+----------+----------------+\n|          1|1567411525| 1567411525|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567411825| 1567411825|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567412125| 1567412125|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567412425| 1567412425|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567412725| 1567412725|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567413025| 1567413025|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567414825| 1567414825|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567415125| 1567415125|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567415425| 1567415425|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567415725| 1567415725|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567416025| 1567416025|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567416325| 1567416325|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567419625| 1567419625|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567419925| 1567419925|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567420225| 1567420225|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567420525| 1567420525|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567420825| 1567420825|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567421125| 1567421125|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567426225| 1567426225|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n|          1|1567426525| 1567426525|  1006588|     2847|          T|                0|                  0|         -inf|             2|           inf|              0|  COMPQ-03|daPhyDrvStatus|OI-885C1AFC9CF011...| 35109|        35326|     35326|             142| 35109|Processing unit|            null|MM400MinutemanRd|Processing unit|         N|         1006383|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+--------------+--------------------+------+-------------+----------+----------------+------+---------------+----------------+----------------+---------------+----------+----------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=46","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=47","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=48","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=49","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=50"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386171_1429674743","id":"20200229-033940_2133138157","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:02:56+0000","dateFinished":"2020-03-24T16:09:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20162"},{"text":"var event_logs_desc\n= top_cust_device_monitor_event_log.join(type_df, top_cust_device_monitor_event_log(\"TARGET_ID\") === type_df(\"MONITOR_ID\"), \"left_outer\").drop(\"MONITOR_ID\");","user":"anonymous","dateUpdated":"2020-03-24T16:34:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_logs_desc: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 24 more fields]\n"}]},"apps":[],"jobName":"paragraph_1584717386172_-2124450769","id":"20200229-035222_303729447","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:34:08+0000","dateFinished":"2020-03-24T16:34:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20163"},{"text":"print(event_logs_desc.count());\nevent_logs_desc.show();\n","user":"anonymous","dateUpdated":"2020-03-24T16:09:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.SparkException: Job 55 cancelled part of cancelled job group zeppelin-2F6BBU9G1-20200229-035219_594502101\n  at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1661)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobCancellation(DAGScheduler.scala:1596)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply$mcVI$sp(DAGScheduler.scala:811)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:811)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:811)\n  at scala.collection.mutable.HashSet.foreach(HashSet.scala:78)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobGroupCancelled(DAGScheduler.scala:811)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1851)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1831)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1820)\n  at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n  at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:642)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2034)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2055)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2074)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2099)\n  at org.apache.spark.rdd.RDD$$anonfun$collect$1.apply(RDD.scala:945)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:363)\n  at org.apache.spark.rdd.RDD.collect(RDD.scala:944)\n  at org.apache.spark.sql.execution.SparkPlan.executeCollect(SparkPlan.scala:297)\n  at org.apache.spark.sql.Dataset$$anonfun$count$1.apply(Dataset.scala:2781)\n  at org.apache.spark.sql.Dataset$$anonfun$count$1.apply(Dataset.scala:2780)\n  at org.apache.spark.sql.Dataset$$anonfun$51.apply(Dataset.scala:3265)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n  at org.apache.spark.sql.Dataset.withAction(Dataset.scala:3264)\n  at org.apache.spark.sql.Dataset.count(Dataset.scala:2780)\n  ... 47 elided\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=51","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=52","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=53","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=54","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=55"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386172_40077872","id":"20200229-035219_594502101","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:09:04+0000","dateFinished":"2020-03-24T16:12:19+0000","status":"ABORT","progressUpdateIntervalMs":500,"$$hashKey":"object:20164"},{"text":"/*var event_logs_df = event_logs_desc.select(\n    col(\"DESTINATION\"),\n    col(\"CORE_TIME\"),\n    //col(\"CORE_TIME\").cast(\"TimestampType\").as(\"CORE_TIMESTAMP\"),\n    to_date(col(\"CORE_TIME\").cast(TimestampType)).as(\"CORE_TIMESTAMP\"),\n    to_date(from_unixtime($\"CORE_TIME\", \"dd-MM-yyyy\")).as(\"CORE_TIMESTAMP2\"),\n    unix_timestamp(col(\"CORE_TIME\")).as(\"CORE_TIMESTAMP3\"),\n    to_date(from_unixtime($\"CORE_TIME\")).as(\"CORE_TIMESTAMP4\"),  /////////////gold\n    to_date(from_unixtime($\"CORE_TIME\"), \"YYYY-MM-dd HH:mm:ss\").as(\"CORE_TIMESTAMP5\"),\n    // to_date(from_unixtime($\"CORE_TIME\", \"dd-MMM-yyyy HH:mm:ss\")).as(\"CORE_TIMESTAMP6\"),\n     to_timestamp(from_unixtime($\"CORE_TIME\")).as(\"CORE_TIMESTAMP7\"),  \n    col(\"POLLER_TIME\"),\n    col(\"POLLER_TIME\").cast(\"timestamp\").as(\"POLLER_TIMESTAMP\"),\n    col(\"TARGET_ID\"));\n    \nevent_logs_df.show();*/\nvar event_logs_df = event_logs_desc.select(\n    col(\"DESTINATION\"),\n    col(\"CORE_TIME\"),\n    to_timestamp(from_unixtime($\"CORE_TIME\")).as(\"CORE_TIMESTAMP\"),\n    col(\"POLLER_TIME\"),\n    to_timestamp(from_unixtime($\"POLLER_TIME\")).as(\"POLLER_TIMESTAMP\"),\n    col(\"TARGET_ID\"),\n    col(\"POLICY_ID\"),\n    col(\"POLICY_TYPE\"),\n    col(\"DETECTED_SEVERITY\"),\n    col(\"PROPAGATED_SEVERITY\"),\n    col(\"LOW_THRESHOLD\"),\n    col(\"MEASURED_VALUE\"),\n    col(\"HIGH_THRESHOLD\"),\n    col(\"PROPAGATED_FLAG\"),\n    col(\"EVENT_CODE\"),\n    col(\"METRIC_NAME\"),\n    col(\"RECON_ID\"),\n    col(\"BUS_ID\"),\n    col(\"PARENT_BUS_ID\"),\n    col(\"NEW_BUS_ID\"),\n    col(\"NUM_CUST_DEVICES\"),\n    col(\"DEVICE_TYPE\"),\n    col(\"OPERATING_SYSTEM\"),\n    col(\"SITE\"),\n    col(\"SITE_DESC\"),\n    col(\"IS_VIRTUAL\"),\n    col(\"PARENT_TARGET_ID\"),\n    col(\"MONITOR_DESC\")\n    ); \n    \n// event_logs_df.show();?","user":"anonymous","dateUpdated":"2020-03-24T16:34:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_logs_df: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 26 more fields]\n"}]},"apps":[],"jobName":"paragraph_1584717386173_-2142068276","id":"20200229-042344_1009022911","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:34:13+0000","dateFinished":"2020-03-24T16:34:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20165"},{"text":"event_logs_df.show();","user":"anonymous","dateUpdated":"2020-03-24T16:34:21+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.SparkException: Job 90 cancelled part of cancelled job group zeppelin-2F6BBU9G1-20200229-044633_490756168\n  at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1661)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobCancellation(DAGScheduler.scala:1596)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply$mcVI$sp(DAGScheduler.scala:811)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:811)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:811)\n  at scala.collection.mutable.HashSet.foreach(HashSet.scala:78)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobGroupCancelled(DAGScheduler.scala:811)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1851)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1831)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1820)\n  at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n  at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:642)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2034)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2055)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2074)\n  at org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:363)\n  at org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n  at org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collectFromPlan(Dataset.scala:3284)\n  at org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2495)\n  at org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2495)\n  at org.apache.spark.sql.Dataset$$anonfun$51.apply(Dataset.scala:3265)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n  at org.apache.spark.sql.Dataset.withAction(Dataset.scala:3264)\n  at org.apache.spark.sql.Dataset.head(Dataset.scala:2495)\n  at org.apache.spark.sql.Dataset.take(Dataset.scala:2709)\n  at org.apache.spark.sql.Dataset.showString(Dataset.scala:254)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:729)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:688)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:697)\n  ... 47 elided\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=86","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=87","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=88","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=89","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=90"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386174_169743128","id":"20200229-044633_490756168","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:34:21+0000","dateFinished":"2020-03-24T16:34:41+0000","status":"ABORT","progressUpdateIntervalMs":500,"$$hashKey":"object:20166"},{"text":"// S0 join event_log and device based on target id : OK\n// S1 join S0 and customer based on target id : OK\n// S2 join S1 and customer_parent based on bus_id : OK\n// S3 join S2 and top_customers where bus_id = custid or parent_bus_id = top_customers.bus_id :OK\n// S4 S3 join device_location_data :OK\n// add type and device hierarchy","user":"anonymous","dateUpdated":"2020-03-21T22:10:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1584717386174_15124928","id":"20200226-071605_293215532","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-21T22:10:04+0000","dateFinished":"2020-03-21T22:10:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20167"},{"text":"//Get the incident.csv into a dataframe \nvar incident_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/incidents.csv\");\n\nincident_df = incident_df.withColumn(\n      \"Is_Source_Monitor\",\n      when(incident_df.col(\"submitter\") === \"Other\", 0)\n        .otherwise(1)\n    );\n    \nincident_df = incident_df.select(\n            incident_df.col(\"incident_id\").as(\"INCIDENT_ID\"),\n            incident_df.col(\"submit_date\").as(\"SUBMIT_DATE\"),\n            incident_df.col(\"bus_id\").as(\"BUS_ID\"),\n            incident_df.col(\"event_code\").as(\"EVENT_CODE\"),\n            incident_df.col(\"Is_Source_Monitor\").as(\"Is_Source_Monitor\")\n    );    \nincident_df.show();","user":"anonymous","dateUpdated":"2020-03-24T16:34:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------------+------+----------+-----------------+\n|    INCIDENT_ID|         SUBMIT_DATE|BUS_ID|EVENT_CODE|Is_Source_Monitor|\n+---------------+--------------------+------+----------+-----------------+\n|CRQ001000044016|22-Aug-2019 04:29:38| 36944|    DDT-11|                0|\n|INC001000000002|14-Aug-2018 09:22:15|  9873|   APPL-85|                0|\n|INC001000000007|16-Aug-2018 12:10:16| 35574|   NAVI-32|                0|\n|INC001000000008|17-Aug-2018 11:50:12| 35574|    ESM-22|                0|\n|INC001000000009|17-Aug-2018 11:59:37| 35574|    ESM-22|                0|\n|INC001000000010|17-Aug-2018 14:26:09| 35574|    ESM-22|                0|\n|INC001000000011|17-Aug-2018 16:12:45| 35574|   NAVI-21|                0|\n|INC001000000012|18-Aug-2018 02:45:57| 35574|    ISM-50|                0|\n|INC001000000013|18-Aug-2018 12:34:06| 35574|    ISM-50|                0|\n|INC001000000015|18-Aug-2018 15:57:00| 35574|   NTWK-58|                0|\n|INC001000000016|19-Aug-2018 05:12:33| 35574|  WLLOG-06|                0|\n|INC001000000017|19-Aug-2018 11:59:18| 35574|   WINT-06|                0|\n|INC001000000018|19-Aug-2018 12:26:45| 35574|    APP-01|                0|\n|INC001000000019|19-Aug-2018 20:19:33| 35574|   WINT-07|                0|\n|INC001000000020|20-Aug-2018 03:24:16| 35574|    ISM-50|                0|\n|INC001000000021|20-Aug-2018 05:43:12| 35574|   WINT-07|                0|\n|INC001000000022|20-Aug-2018 09:36:33| 35574|   WINT-07|                0|\n|INC001000000023|20-Aug-2018 09:48:35| 35574|    APP-01|                0|\n|INC001000000024|20-Aug-2018 09:58:00| 35574|   NTWK-58|                0|\n|INC001000000025|20-Aug-2018 10:13:38| 35574|    APP-01|                0|\n+---------------+--------------------+------+----------+-----------------+\nonly showing top 20 rows\n\nincident_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 3 more fields]\nincident_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 3 more fields]\nincident_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 3 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=91","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=92"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386175_-40126587","id":"20200229-035705_296817465","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:34:47+0000","dateFinished":"2020-03-24T16:34:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20168"},{"text":"//Get the incident_device.csv into a dataframe \nvar incident_device_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"gs://rdx-cmu-2020-dataset/incident-device.csv\");\nincident_device_df = incident_device_df.select(\n            incident_device_df.col(\"incident_id\").as(\"INCIDENT_DEV_ID\"),\n            incident_device_df.col(\"recon_id\").as(\"RECON_ID\")\n    );\nincident_device_df.show();","user":"anonymous","dateUpdated":"2020-03-24T16:34:53+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------------+\n|INCIDENT_DEV_ID|            RECON_ID|\n+---------------+--------------------+\n|CRQ001000044016|OI-88A7FF529D1411...|\n|CRQ001000044016|OI-257C0BF49CF011...|\n|INC001000000002|OI-6C1981C69D1411...|\n|INC001000000002|OI-3C69EAF29CF011...|\n|INC001000000007|OI-64139C789D1411...|\n|INC001000000011|OI-764453A69D1411...|\n|INC001000000012|OI-51F629489D1411...|\n|INC001000000015|OI-059C5A0A9CF011...|\n|INC001000000018|OI-6D83470A9CF011...|\n|INC001000000018|OI-0ED62F4C9CF011...|\n|INC001000000020|OI-68D858669D1411...|\n|INC001000000021|OI-774EA86E9D1411...|\n|INC001000000023|OI-42156D329CF011...|\n|INC001000000024|OI-667027EE9CF011...|\n|INC001000000030|OI-68D858669D1411...|\n|INC001000000034|OI-E9C5499A9CEF11...|\n|INC001000000034|REGAA5V0GQ2KOAP33...|\n|INC001000000036|OI-68D858669D1411...|\n|INC001000000037|OI-64139C789D1411...|\n|INC001000000039|OI-68D858669D1411...|\n+---------------+--------------------+\nonly showing top 20 rows\n\nincident_device_df: org.apache.spark.sql.DataFrame = [INCIDENT_DEV_ID: string, RECON_ID: string]\nincident_device_df: org.apache.spark.sql.DataFrame = [INCIDENT_DEV_ID: string, RECON_ID: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=93","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=94"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386175_1142191698","id":"20200229-035841_148039032","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:34:53+0000","dateFinished":"2020-03-24T16:34:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20169"},{"text":"var incident_recon_df = incident_df.join(incident_device_df, incident_df(\"INCIDENT_ID\") === incident_device_df(\"INCIDENT_DEV_ID\"), \"inner\").drop(\"INCIDENT_DEV_ID\");","user":"anonymous","dateUpdated":"2020-03-24T16:35:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"incident_recon_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 4 more fields]\n"}]},"apps":[],"jobName":"paragraph_1584717386176_-1606810215","id":"20200229-035949_1007395544","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:35:00+0000","dateFinished":"2020-03-24T16:35:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20170"},{"text":"// incident_df.count();     //224770\n// incident_device_df.count(); //388200\nincident_recon_df.show();","user":"anonymous","dateUpdated":"2020-03-21T22:15:29+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------------+------+----------+-----------------+--------------------+\n|    INCIDENT_ID|         SUBMIT_DATE|BUS_ID|EVENT_CODE|Is_Source_Monitor|            RECON_ID|\n+---------------+--------------------+------+----------+-----------------+--------------------+\n|INC001000000289|12-Aug-2018 21:18:52| 11838|   MSQL-12|                1|OI-61BACA609CF011...|\n|INC001000000289|12-Aug-2018 21:18:52| 11838|   MSQL-12|                1|OI-6AEEC7F29D1411...|\n|INC001000000417|13-Aug-2018 04:42:21| 35376|   UNIX-02|                1|OI-596F5EA29CF011...|\n|INC001000000417|13-Aug-2018 04:42:21| 35376|   UNIX-02|                1|OI-563564EC9D1411...|\n|INC001000000445|13-Aug-2018 06:03:09| 37048|   SNMP-08|                1|OI-791C64849CF011...|\n|INC001000000445|13-Aug-2018 06:03:09| 37048|   SNMP-08|                1|OI-55DCCE9A9D1411...|\n|INC001000000670|13-Aug-2018 11:38:28| 35140|    ESX-01|                1|OI-209C10E89CF011...|\n|INC001000000670|13-Aug-2018 11:38:28| 35140|    ESX-01|                1|OI-6F7CA4BA9D1411...|\n|INC001000001313|14-Aug-2018 05:24:07| 36027|   UNIX-12|                1|OI-6FBCD6769CF011...|\n|INC001000001313|14-Aug-2018 05:24:07| 36027|   UNIX-12|                1|OI-857A2EF49D1411...|\n|INC001000001370|14-Aug-2018 09:30:34| 35383|    ATS-08|                1|OI-7F69431A9D1411...|\n|INC001000001370|14-Aug-2018 09:30:34| 35383|    ATS-08|                1|OI-278851969CF011...|\n|INC001000001452|14-Aug-2018 11:30:47| 35383|    ATS-08|                1|OI-7F69431A9D1411...|\n|INC001000001452|14-Aug-2018 11:30:47| 35383|    ATS-08|                1|OI-278851969CF011...|\n|INC001000001671|14-Aug-2018 15:43:20| 35383|    ESM-18|                1|OI-25D032889CF011...|\n|INC001000001671|14-Aug-2018 15:43:20| 35383|    ESM-18|                1|OI-591A411E9D1411...|\n|INC001000002000|15-Aug-2018 07:56:07| 16715|   FRCR-01|                1|OI-10A90B009CF011...|\n|INC001000002000|15-Aug-2018 07:56:07| 16715|   FRCR-01|                1|OI-5A10AF729D1411...|\n|INC001000002223|15-Aug-2018 15:29:24| 34611|    ACM-04|                0|OI-34A5D1FA9CF011...|\n|INC001000002223|15-Aug-2018 15:29:24| 34611|    ACM-04|                0|OI-59B19D8E9D1411...|\n+---------------+--------------------+------+----------+-----------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1584717386176_357569330","id":"20200229-040410_2031397542","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-21T22:15:29+0000","dateFinished":"2020-03-21T22:15:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20171"},{"text":"var incident_details = incident_recon_df.join(event_code_mapped, incident_recon_df(\"EVENT_CODE\") === event_code_mapped(\"mapping_event_code\"), \"left_outer\").drop(\"mapping_event_code\");","user":"anonymous","dateUpdated":"2020-03-24T16:35:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"incident_details: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1584717386177_1650849936","id":"20200229-040435_790463357","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:35:04+0000","dateFinished":"2020-03-24T16:35:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20172"},{"text":"incident_details.show();\n// incident_details.count();","user":"anonymous","dateUpdated":"2020-03-21T22:15:53+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------------+------+----------+-----------------+--------------------+-------------+\n|    INCIDENT_ID|         SUBMIT_DATE|BUS_ID|EVENT_CODE|Is_Source_Monitor|            RECON_ID|event_code_id|\n+---------------+--------------------+------+----------+-----------------+--------------------+-------------+\n|INC001000000289|12-Aug-2018 21:18:52| 11838|   MSQL-12|                1|OI-61BACA609CF011...|            9|\n|INC001000000289|12-Aug-2018 21:18:52| 11838|   MSQL-12|                1|OI-6AEEC7F29D1411...|            9|\n|INC001000000417|13-Aug-2018 04:42:21| 35376|   UNIX-02|                1|OI-596F5EA29CF011...|           23|\n|INC001000000417|13-Aug-2018 04:42:21| 35376|   UNIX-02|                1|OI-563564EC9D1411...|           23|\n|INC001000000445|13-Aug-2018 06:03:09| 37048|   SNMP-08|                1|OI-791C64849CF011...|         null|\n|INC001000000445|13-Aug-2018 06:03:09| 37048|   SNMP-08|                1|OI-55DCCE9A9D1411...|         null|\n|INC001000000670|13-Aug-2018 11:38:28| 35140|    ESX-01|                1|OI-209C10E89CF011...|         null|\n|INC001000000670|13-Aug-2018 11:38:28| 35140|    ESX-01|                1|OI-6F7CA4BA9D1411...|         null|\n|INC001000001313|14-Aug-2018 05:24:07| 36027|   UNIX-12|                1|OI-6FBCD6769CF011...|           28|\n|INC001000001313|14-Aug-2018 05:24:07| 36027|   UNIX-12|                1|OI-857A2EF49D1411...|           28|\n|INC001000001370|14-Aug-2018 09:30:34| 35383|    ATS-08|                1|OI-7F69431A9D1411...|         null|\n|INC001000001370|14-Aug-2018 09:30:34| 35383|    ATS-08|                1|OI-278851969CF011...|         null|\n|INC001000001452|14-Aug-2018 11:30:47| 35383|    ATS-08|                1|OI-7F69431A9D1411...|         null|\n|INC001000001452|14-Aug-2018 11:30:47| 35383|    ATS-08|                1|OI-278851969CF011...|         null|\n|INC001000001671|14-Aug-2018 15:43:20| 35383|    ESM-18|                1|OI-25D032889CF011...|         null|\n|INC001000001671|14-Aug-2018 15:43:20| 35383|    ESM-18|                1|OI-591A411E9D1411...|         null|\n|INC001000002000|15-Aug-2018 07:56:07| 16715|   FRCR-01|                1|OI-10A90B009CF011...|         null|\n|INC001000002000|15-Aug-2018 07:56:07| 16715|   FRCR-01|                1|OI-5A10AF729D1411...|         null|\n|INC001000002223|15-Aug-2018 15:29:24| 34611|    ACM-04|                0|OI-34A5D1FA9CF011...|         null|\n|INC001000002223|15-Aug-2018 15:29:24| 34611|    ACM-04|                0|OI-59B19D8E9D1411...|         null|\n+---------------+--------------------+------+----------+-----------------+--------------------+-------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1584717386177_932717605","id":"20200229-041807_1722846343","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-21T22:15:53+0000","dateFinished":"2020-03-21T22:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20173"},{"text":"var incident_details_df = incident_details.select(\n            col(\"INCIDENT_ID\"),\n            col(\"SUBMIT_DATE\"), \n            unix_timestamp(col(\"SUBMIT_DATE\"), \"dd-MMM-yyyy HH:mm:ss\").as(\"SUBMIT_DATE_MS\"),\n            col(\"BUS_ID\"),\n            col(\"EVENT_CODE\"),\n            col(\"RECON_ID\"),\n            col(\"event_code_id\").as(\"EVENT_CODE_ID\"),\n            col(\"Is_Source_Monitor\")\n            );\n// incident_details_df.show()","user":"anonymous","dateUpdated":"2020-03-24T16:35:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"incident_details_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 6 more fields]\n"}]},"apps":[],"jobName":"paragraph_1584717386178_-1284367313","id":"20200229-042419_1640347198","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:35:25+0000","dateFinished":"2020-03-24T16:35:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20174"},{"user":"anonymous","dateUpdated":"2020-03-21T22:10:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1584821887296_-56112025","id":"20200321-201807_873760104","dateCreated":"2020-03-21T20:18:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20175"},{"text":"/* TODO ::: \nDataframes to load to database :\n1. event_logs_df\n2. incident_details_df\n*/","user":"anonymous","dateUpdated":"2020-03-21T22:10:21+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1584717386179_-1140951591","id":"20200229-041934_1171294660","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-21T22:10:21+0000","dateFinished":"2020-03-21T22:10:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20176"},{"text":"//create properties object\nval prop = new java.util.Properties\nprop.setProperty(\"driver\", \"com.mysql.jdbc.Driver\")\nprop.setProperty(\"user\", \"root\")\nprop.setProperty(\"password\", \"rdx-mysql\") \n \nval mysqlDBName = \"\"\nval url = \"jdbc:mysql://localhost:3306/\" + mysqlDBName","user":"anonymous","dateUpdated":"2020-03-21T22:10:21+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"prop: java.util.Properties = {user=root, password=rdx-mysql, driver=com.mysql.jdbc.Driver}\nmysqlDBName: String = \"\"\nurl: String = jdbc:mysql://localhost:3306/\n"}]},"apps":[],"jobName":"paragraph_1584717386179_-1647949344","id":"20200229-041820_525116366","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-21T22:10:22+0000","dateFinished":"2020-03-21T22:10:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20177"},{"text":"// load(append) event_logs_df into table - \nval EventTableName = \"\"\nevent_logs_df.write.mode(\"append\").jdbc(url, EventTableName, prop)","user":"anonymous","dateUpdated":"2020-03-21T22:10:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.sql.SQLException: Access denied for user 'root'@'localhost' (using password: YES)\n  at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:964)\n  at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)\n  at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)\n  at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:873)\n  at com.mysql.jdbc.MysqlIO.proceedHandshakeWithPluggableAuthentication(MysqlIO.java:1710)\n  at com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:1226)\n  at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2194)\n  at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2225)\n  at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2024)\n  at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:779)\n  at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47)\n  at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n  at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n  at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n  at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n  at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)\n  at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:389)\n  at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:330)\n  at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$$anonfun$createConnectionFactory$1.apply(JdbcUtils.scala:63)\n  at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$$anonfun$createConnectionFactory$1.apply(JdbcUtils.scala:54)\n  at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:63)\n  at org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:45)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:86)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n  at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n  at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\n  at org.apache.spark.sql.DataFrameWriter.jdbc(DataFrameWriter.scala:501)\n  ... 47 elided\n"}]},"apps":[],"jobName":"paragraph_1584717386180_1490602529","id":"20200303-071026_1856232868","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-21T22:10:22+0000","dateFinished":"2020-03-21T22:10:23+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:20178"},{"text":"// load(append) incident_details_df into table - \nval IncidentTableName = \"\"\nevent_logs_df.write.mode(\"append\").jdbc(url, IncidentTableName, prop)","user":"anonymous","dateUpdated":"2020-03-20T15:16:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.sql.SQLException: Access denied for user 'root'@'localhost' (using password: YES)\n  at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:964)\n  at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)\n  at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)\n  at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:873)\n  at com.mysql.jdbc.MysqlIO.proceedHandshakeWithPluggableAuthentication(MysqlIO.java:1710)\n  at com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:1226)\n  at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2194)\n  at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2225)\n  at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2024)\n  at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:779)\n  at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47)\n  at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n  at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n  at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n  at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n  at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)\n  at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:389)\n  at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:330)\n  at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$$anonfun$createConnectionFactory$1.apply(JdbcUtils.scala:63)\n  at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$$anonfun$createConnectionFactory$1.apply(JdbcUtils.scala:54)\n  at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:63)\n  at org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:45)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:86)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n  at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n  at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\n  at org.apache.spark.sql.DataFrameWriter.jdbc(DataFrameWriter.scala:501)\n  ... 47 elided\n"}]},"apps":[],"jobName":"paragraph_1584717386180_343191144","id":"20200303-071159_1018100970","dateCreated":"2020-03-20T15:16:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20179"},{"text":"/************************\n * write dataframe to .csv\n ************************/","user":"anonymous","dateUpdated":"2020-03-20T15:16:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1584717386181_2001549885","id":"20200303-201022_2144387572","dateCreated":"2020-03-20T15:16:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20180"},{"text":"import org.apache.hadoop.conf.Configuration\nimport org.apache.hadoop.fs._","user":"anonymous","dateUpdated":"2020-03-24T16:35:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.hadoop.conf.Configuration\nimport org.apache.hadoop.fs._\n"}]},"apps":[],"jobName":"paragraph_1584717386181_931357332","id":"20200303-203837_1483383489","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:35:34+0000","dateFinished":"2020-03-24T16:35:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20181"},{"text":"// write event_logs_df to event-logs.csv\nevent_logs_df.write.format(\"com.databricks.spark.csv\").option(\"header\",\"true\").save(\"gs://rdx-cmu-2020-dataset/event-logs_test.csv\")","user":"anonymous","dateUpdated":"2020-03-24T16:37:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=100","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=101","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=102","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=103","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=104"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386182_2130347370","id":"20200303-201111_824696589","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:37:00+0000","dateFinished":"2020-03-24T16:47:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20182"},{"text":"// save output into a single csv file\nevent_logs_df.repartition(1).write.format(\"com.databricks.spark.csv\").option(\"header\",\"true\").save(\"gs://rdx-cmu-2020-dataset/event-logs-merged.csv\")","user":"anonymous","dateUpdated":"2020-03-24T16:47:18+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=105","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=106","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=107","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=108","http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=109"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386182_-1257774036","id":"20200303-210535_1445221666","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T16:47:18+0000","dateFinished":"2020-03-24T16:55:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20183"},{"text":"// write incident_details_df to incident-details.csv\n incident_details_df.coalesce(1).write.format(\"com.databricks.spark.csv\").option(\"header\",\"true\").save(\"gs://rdx-cmu-2020-dataset/incident-details.csv\")","user":"anonymous","dateUpdated":"2020-03-24T17:05:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.sql.AnalysisException: path gs://rdx-cmu-2020-dataset/incident-details.csv already exists.;\n  at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:109)\n  at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:104)\n  at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:102)\n  at org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:122)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n  at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n  at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:225)\n  ... 49 elided\n"}]},"apps":[],"jobName":"paragraph_1584717386183_-1254589187","id":"20200303-201550_647587879","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T17:05:14+0000","dateFinished":"2020-03-24T17:05:14+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:20184"},{"text":" // save output into a single csv file\n incident_details_df.repartition(1).coalesce(1).write.format(\"com.databricks.spark.csv\").option(\"header\",\"true\").save(\"gs://rdx-cmu-2020-dataset/incident-details-merged.csv\")","user":"anonymous","dateUpdated":"2020-03-24T17:05:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-f4be-m.us-central1-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=111"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1584717386183_-261721642","id":"20200303-210710_447329219","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-24T17:05:35+0000","dateFinished":"2020-03-24T17:08:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20185"},{"text":"event_logs_df.show()","user":"anonymous","dateUpdated":"2020-03-21T20:56:16+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+--------------+--------------------+------+-------------+----------+------------------+---------------+----------------+--------------------+-------------------+---------------+----------+----------------+-----------------+\n|DESTINATION| CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|   METRIC_NAME|            RECON_ID|BUS_ID|PARENT_BUS_ID|NEW_BUS_ID|RECONCILIATION_NUM|    DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|               SITE|      TYPE_NAME|IS_VIRTUAL|PARENT_TARGET_ID|     MONITOR_DESC|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+--------------+--------------------+------+-------------+----------+------------------+---------------+----------------+--------------------+-------------------+---------------+----------+----------------+-----------------+\n|          1|1567408305| 1567408305|  2079327|     4303|          T|                0|                  0|            0|         29.63|           inf|              0|   WINT-01|      PctTotal|OI-EF04FA369CEF11...| 35368|        11838|     11838|               659|Processing unit|            null|OI-EF04FA369CEF11...|MM-400 Minuteman Rd|Processing unit|         N|         2079182|   WMI: Processor|\n|          1|1567408304| 1567408304|  1196747|     4303|          T|                0|                  0|            0|          0.68|           inf|              0|   WINT-01|      PctTotal|OI-1CDF89629CF011...| 35508|        27070|     27070|               156|Processing unit|            null|OI-1CDF89629CF011...|MM-400 Minuteman Rd|Processing unit|         Y|         1180040|   WMI: Processor|\n|          1|1567408305| 1567408305|  2247726|     4726|          T|                0|                  0|         -inf|             1|           inf|              0|   UNIX-55|dskPercentNode|OI-B2291F929E4E11...| 35563|        35664|     35664|               155|Processing unit|            null|OI-B2291F929E4E11...|MM-400 Minuteman Rd|Processing unit|         Y|         2247668|             Disk|\n|          1|1567408305| 1567408305|  2247726|     1344|          T|                0|                  0|         -inf|            20|           inf|              0|   UNIX-02|    dskPercent|OI-B2291F929E4E11...| 35563|        35664|     35664|               155|Processing unit|            null|OI-B2291F929E4E11...|MM-400 Minuteman Rd|Processing unit|         Y|         2247668|             Disk|\n|          1|1567408304| 1567408304|  1868568|     4726|          T|                0|                  0|         -inf|             0|           inf|              0|   UNIX-55|dskPercentNode|OI-0B8933709CF011...| 36024|        35574|     35574|              2601|Processing unit|            null|OI-0B8933709CF011...|MM-400 Minuteman Rd|Processing unit|         Y|         1868540|             Disk|\n|          1|1567408304| 1567408304|  1868568|     1344|          T|                0|                  0|         -inf|             3|           inf|              0|   UNIX-02|    dskPercent|OI-0B8933709CF011...| 36024|        35574|     35574|              2601|Processing unit|            null|OI-0B8933709CF011...|MM-400 Minuteman Rd|Processing unit|         Y|         1868540|             Disk|\n|          1|1567408304| 1567408304|  1548007|     2222|          T|                0|                  0|         -inf|         65.66|           inf|              0|   WINT-02|       PctFree|OI-07D424569CF011...| 35672|         null|     35672|               111|Processing unit|            null|OI-07D424569CF011...|MM-400 Minuteman Rd|Processing unit|         Y|         1547990|WMI: Logical Disk|\n|          1|1567408305| 1567408305|  2079197|     2222|          T|                0|                  0|         -inf|         82.61|           inf|              0|   WINT-02|       PctFree|OI-EF04FA369CEF11...| 35368|        11838|     11838|               659|Processing unit|            null|OI-EF04FA369CEF11...|MM-400 Minuteman Rd|Processing unit|         N|         2079182|WMI: Logical Disk|\n|          1|1567408305| 1567408305|  2079202|     2222|          T|                0|                  0|         -inf|         53.61|           inf|              0|   WINT-02|       PctFree|OI-EF04FA369CEF11...| 35368|        11838|     11838|               659|Processing unit|            null|OI-EF04FA369CEF11...|MM-400 Minuteman Rd|Processing unit|         N|         2079182|WMI: Logical Disk|\n|          1|1567408304| 1567408304|  1868540|     1760|          T|                0|                  0|         -inf|     189427063|           inf|              0|   UNIX-10|     sysUptime|OI-0B8933709CF011...| 36024|        35574|     35574|              2601|Processing unit|            null|OI-0B8933709CF011...|MM-400 Minuteman Rd|Processing unit|         Y|            null|           Server|\n|          1|1567408304| 1567408304|  1868540|     1347|          T|                0|                  0|         -inf|      24181404|           inf|              0|   UNIX-03|  memAvailReal|OI-0B8933709CF011...| 36024|        35574|     35574|              2601|Processing unit|            null|OI-0B8933709CF011...|MM-400 Minuteman Rd|Processing unit|         Y|            null|           Server|\n|          1|1567408304| 1567408304|  1868540|     1346|          T|                0|                  0|         -inf|       8257528|           inf|              0|   UNIX-11|  memTotalSwap|OI-0B8933709CF011...| 36024|        35574|     35574|              2601|Processing unit|            null|OI-0B8933709CF011...|MM-400 Minuteman Rd|Processing unit|         Y|            null|           Server|\n|          1|1567408304| 1567408304|  1868540|     1063|          T|                0|                  0|         -inf|          0.50|           inf|              0|   UNIX-12|   utilization|OI-0B8933709CF011...| 36024|        35574|     35574|              2601|Processing unit|            null|OI-0B8933709CF011...|MM-400 Minuteman Rd|Processing unit|         Y|            null|           Server|\n|          1|1567408304| 1567408304|  1793911|     4303|          T|                0|                  0|            0|          1.36|           inf|              0|   WINT-01|      PctTotal|OI-84D85E229CF011...| 36024|        35574|     35574|              2601|Processing unit|            null|OI-84D85E229CF011...|MM-400 Minuteman Rd|Processing unit|         N|         1793904|   WMI: Processor|\n|          1|1567408305| 1567408305|  2247728|     4726|          T|                0|                  0|         -inf|             0|           inf|              0|   UNIX-55|dskPercentNode|OI-B2291F929E4E11...| 35563|        35664|     35664|               155|Processing unit|            null|OI-B2291F929E4E11...|MM-400 Minuteman Rd|Processing unit|         Y|         2247668|             Disk|\n|          1|1567408305| 1567408305|  2247728|     1344|          T|                0|                  0|         -inf|             9|           inf|              0|   UNIX-02|    dskPercent|OI-B2291F929E4E11...| 35563|        35664|     35664|               155|Processing unit|            null|OI-B2291F929E4E11...|MM-400 Minuteman Rd|Processing unit|         Y|         2247668|             Disk|\n|          1|1567408304| 1567408304|  1889003|     4726|          T|                0|                  0|         -inf|             0|           inf|              0|   UNIX-55|dskPercentNode|OI-0B8933709CF011...| 36024|        35574|     35574|              2601|Processing unit|            null|OI-0B8933709CF011...|MM-400 Minuteman Rd|Processing unit|         Y|         1868540|             Disk|\n|          1|1567408304| 1567408304|  1889003|     1344|          T|                0|                  0|         -inf|             0|           inf|              0|   UNIX-02|    dskPercent|OI-0B8933709CF011...| 36024|        35574|     35574|              2601|Processing unit|            null|OI-0B8933709CF011...|MM-400 Minuteman Rd|Processing unit|         Y|         1868540|             Disk|\n|          1|1567408304| 1567408304|  1180067|     2222|          T|                0|                  0|         -inf|         32.85|           inf|              0|   WINT-02|       PctFree|OI-1CDF89629CF011...| 35508|        27070|     27070|               156|Processing unit|            null|OI-1CDF89629CF011...|MM-400 Minuteman Rd|Processing unit|         Y|         1180040|WMI: Logical Disk|\n|          1|1567408304| 1567408304|  1793935|     2222|          T|                0|                  0|         -inf|         54.05|           inf|              0|   WINT-02|       PctFree|OI-84D85E229CF011...| 36024|        35574|     35574|              2601|Processing unit|            null|OI-84D85E229CF011...|MM-400 Minuteman Rd|Processing unit|         N|         1793904|WMI: Logical Disk|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+--------------+--------------------+------+-------------+----------+------------------+---------------+----------------+--------------------+-------------------+---------------+----------+----------------+-----------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1584717386184_-1262159201","id":"20200303-202316_674903915","dateCreated":"2020-03-20T15:16:26+0000","dateStarted":"2020-03-21T15:27:47+0000","dateFinished":"2020-03-21T15:28:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20186"},{"text":"incident_details_df.show();","user":"anonymous","dateUpdated":"2020-03-20T15:16:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------------+--------------+------+----------+--------------------+-------------+\n|    INCIDENT_ID|         SUBMIT_DATE|SUBMIT_DATE_MS|BUS_ID|EVENT_CODE|            RECON_ID|EVENT_CODE_ID|\n+---------------+--------------------+--------------+------+----------+--------------------+-------------+\n|INC001000000289|12-Aug-2018 21:18:52|    1534108732| 11838|   MSQL-12|OI-61BACA609CF011...|         null|\n|INC001000000289|12-Aug-2018 21:18:52|    1534108732| 11838|   MSQL-12|OI-6AEEC7F29D1411...|         null|\n|INC001000000417|13-Aug-2018 04:42:21|    1534135341| 35376|   UNIX-02|OI-596F5EA29CF011...|         null|\n|INC001000000417|13-Aug-2018 04:42:21|    1534135341| 35376|   UNIX-02|OI-563564EC9D1411...|         null|\n|INC001000000445|13-Aug-2018 06:03:09|    1534140189| 37048|   SNMP-08|OI-791C64849CF011...|           11|\n|INC001000000445|13-Aug-2018 06:03:09|    1534140189| 37048|   SNMP-08|OI-55DCCE9A9D1411...|           11|\n|INC001000000670|13-Aug-2018 11:38:28|    1534160308| 35140|    ESX-01|OI-209C10E89CF011...|         null|\n|INC001000000670|13-Aug-2018 11:38:28|    1534160308| 35140|    ESX-01|OI-6F7CA4BA9D1411...|         null|\n|INC001000001313|14-Aug-2018 05:24:07|    1534224247| 36027|   UNIX-12|OI-6FBCD6769CF011...|         null|\n|INC001000001313|14-Aug-2018 05:24:07|    1534224247| 36027|   UNIX-12|OI-857A2EF49D1411...|         null|\n|INC001000001370|14-Aug-2018 09:30:34|    1534239034| 35383|    ATS-08|OI-7F69431A9D1411...|         null|\n|INC001000001370|14-Aug-2018 09:30:34|    1534239034| 35383|    ATS-08|OI-278851969CF011...|         null|\n|INC001000001452|14-Aug-2018 11:30:47|    1534246247| 35383|    ATS-08|OI-7F69431A9D1411...|         null|\n|INC001000001452|14-Aug-2018 11:30:47|    1534246247| 35383|    ATS-08|OI-278851969CF011...|         null|\n|INC001000001671|14-Aug-2018 15:43:20|    1534261400| 35383|    ESM-18|OI-25D032889CF011...|            1|\n|INC001000001671|14-Aug-2018 15:43:20|    1534261400| 35383|    ESM-18|OI-591A411E9D1411...|            1|\n|INC001000002000|15-Aug-2018 07:56:07|    1534319767| 16715|   FRCR-01|OI-10A90B009CF011...|         null|\n|INC001000002000|15-Aug-2018 07:56:07|    1534319767| 16715|   FRCR-01|OI-5A10AF729D1411...|         null|\n|INC001000002223|15-Aug-2018 15:29:24|    1534346964| 34611|    ACM-04|OI-34A5D1FA9CF011...|         null|\n|INC001000002223|15-Aug-2018 15:29:24|    1534346964| 34611|    ACM-04|OI-59B19D8E9D1411...|         null|\n+---------------+--------------------+--------------+------+----------+--------------------+-------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1584717386184_-707079062","id":"20200305-010108_1433163181","dateCreated":"2020-03-20T15:16:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20187"},{"user":"anonymous","dateUpdated":"2020-03-20T15:16:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1584717386185_-1599075392","id":"20200304-231013_509642549","dateCreated":"2020-03-20T15:16:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20188"}],"name":"ETL2_v2","id":"2F6BBU9G1","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}