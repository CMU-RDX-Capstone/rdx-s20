{"paragraphs":[{"text":"//Get the bus_parent.csv into a dataframe \n val bus_parent_df = spark.read.option(\"header\", \"true\").csv(\"gs://rdx-cmu-2020-dataset/bus_parent.csv\")\n bus_parent_df.show()","user":"anonymous","dateUpdated":"2020-02-26T05:43:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+---------+\n|BUS_ID|PARENT_ID|\n+------+---------+\n|  5793|     1914|\n|  9873|    14748|\n| 10354|     1914|\n| 10615|     1914|\n| 11376|     1914|\n| 11839|    29710|\n| 11840|    29710|\n| 11841|     1914|\n| 11895|     1914|\n| 11896|    34872|\n| 12175|     1914|\n| 13615|     1914|\n| 14035|     1914|\n| 14655|     1914|\n| 14912|    29710|\n| 14913|    29710|\n| 14923|    29710|\n| 14924|    29710|\n| 14925|    29710|\n| 14929|    29710|\n+------+---------+\nonly showing top 20 rows\n\nbus_parent_df: org.apache.spark.sql.DataFrame = [BUS_ID: string, PARENT_ID: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=124","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=125"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582594307616_1903823402","id":"20200225-013147_1265739322","dateCreated":"2020-02-25T01:31:47+0000","dateStarted":"2020-02-26T05:43:40+0000","dateFinished":"2020-02-26T05:43:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4281"},{"text":"//Get the Event_log*.csv into a dataframe\nvar event_log_df = spark.read.option(\"header\", \"true\").option(\"delimiter\", \",\").option(\"ignoreLeadingWhiteSpace\",true)\n .csv(\"gs://rdx-cmu-2020-dataset/event.log.20190902031144_20000.csv\")\n\n//Filter data without policy_type = T and without metric_name = Started\nevent_log_df = event_log_df.filter(\"policy_type != 'T'\" ).filter(\"metric_name != 'Started'\")\n\n\nregexp_replace(event_log_df(\"policy_type\"),\"\\\\s+\",\" \");\n\n\n// Add a unique id to each row in event_log under the column name event_id\nevent_log_df = event_log_df.withColumn(\"event_id\", monotonically_increasing_id);\n\nevent_log_df.show();","user":"anonymous","dateUpdated":"2020-02-26T06:04:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+\n|DESTINATION| CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|event_id|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+\n|          1|1567408304| 1567408303|  3357744|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|       0|\n|          1|1567408304| 1567408303|  2641395|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|       1|\n|          1|1567408304| 1567408304|  3550849|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|       2|\n|          1|1567408304| 1567408244|  2951000|     3200|          A|                5|                  5|          110|           110|           110|              1|    ESM-18|       None|       3|\n|          1|1567408304| 1567408304|  1407391|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|       4|\n|       None|1567408304| 1567408302|  2993413|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|       5|\n|       None|1567408304| 1567408303|  3568045|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|       6|\n|          1|1567408304| 1567408303|  2933116|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|       7|\n|          1|1567408304| 1567408304|  2137931|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|       8|\n|          1|1567408304| 1567408304|  2042082|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|       9|\n|          1|1567408304| 1567408304|  2916860|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      10|\n|          1|1567408304| 1567408304|  1657284|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|      11|\n|          1|1567408304| 1567408304|  1871569|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      12|\n|          1|1567408304| 1567408304|  2882864|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      13|\n|          1|1567408304| 1567408300|  2262378|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|      14|\n|          1|1567408304| 1567408304|  2626944|     4959|          A|                0|                  0|            0|             0|             0|              0| NCDISM-30|       None|      15|\n|          1|1567408304| 1567408304|  3373974|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      16|\n|          1|1567408304| 1567408304|  2522185|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      17|\n|          1|1567408304| 1567408304|  2948366|     3141|          A|                0|                  0|            0|             0|             0|              0|    ESM-70|       None|      18|\n|          1|1567408304| 1567408304|  1614961|     1062|          A|                0|                  0|            0|             0|             0|              0|    ISM-05|       None|      19|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+\nonly showing top 20 rows\n\nevent_log_df: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 13 more fields]\nevent_log_df: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 13 more fields]\nevent_log_df: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 13 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=167","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=168"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582594331058_1973604006","id":"20200225-013211_995507733","dateCreated":"2020-02-25T01:32:11+0000","dateStarted":"2020-02-26T06:04:29+0000","dateFinished":"2020-02-26T06:04:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4282"},{"text":"//Get the type.csv into a dataframe\n// Renaming monitor_target_id to drop it once we join with event\nvar monitor_type = spark.read.option(\"header\", \"true\").option(\"delimiter\", \",\").option(\"ignoreLeadingWhiteSpace\",true)\n        .csv(\"gs://rdx-cmu-2020-dataset/type.csv\")\nmonitor_type = monitor_type.select(\n        monitor_type.col(\"TYPE\"),\n        monitor_type.col(\"TARGET_ID\").as(\"Monitor_target_id\")\n      )\nmonitor_type.show()","user":"anonymous","dateUpdated":"2020-02-26T05:50:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+-----------------+\n|             TYPE|Monitor_target_id|\n+-----------------+-----------------+\n|Network Interface|             2777|\n|Network Interface|             2778|\n|Network Interface|             2779|\n|Network Interface|             2780|\n|Network Interface|             2781|\n|Network Interface|             2782|\n|Network Interface|             2783|\n|Network Interface|             2784|\n|Network Interface|             2785|\n|Network Interface|             2786|\n|Network Interface|             2787|\n|Network Interface|             2788|\n|Network Interface|             2789|\n|Network Interface|             2790|\n|Network Interface|             2791|\n|Network Interface|             2792|\n|Network Interface|             2793|\n|Network Interface|             2794|\n|Network Interface|             2795|\n|Network Interface|             2796|\n+-----------------+-----------------+\nonly showing top 20 rows\n\nmonitor_type: org.apache.spark.sql.DataFrame = [TYPE: string, Monitor_target_id: string]\nmonitor_type: org.apache.spark.sql.DataFrame = [TYPE: string, Monitor_target_id: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=155","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=156"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582594706033_1029238484","id":"20200225-013826_333107678","dateCreated":"2020-02-25T01:38:26+0000","dateStarted":"2020-02-26T05:50:39+0000","dateFinished":"2020-02-26T05:50:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4283"},{"text":"// Get EventCode and an associated intger mapping\nvar event_code_mapped = event_log_df.select(\"event_code\").distinct();\nevent_code_mapped = event_code_mapped.withColumn(\"event_code_id\", monotonically_increasing_id);\nevent_code_mapped = event_code_mapped.select(\n         event_code_mapped.col(\"event_code_id\"),\n       event_code_mapped.col(\"event_code\").as(\"mapping_event_code\")\n    )\n    \nregexp_replace(event_code_mapped(\"mapping_event_code\"),\"\\\\s+\",\" \");\n\nevent_code_mapped.show();","user":"anonymous","dateUpdated":"2020-02-26T06:05:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+------------------+\n|event_code_id|mapping_event_code|\n+-------------+------------------+\n| 214748364800|            NLB-01|\n| 274877906944|            ESM-72|\n| 395136991232|            ISM-04|\n| 575525617664|           SNMP-08|\n| 635655159808|            ISM-30|\n| 704374636544|            ESM-70|\n| 747324309504|         NCDISM-30|\n| 755914244096|            ISM-05|\n| 867583393792|            ESM-73|\n|1151051235328|            ESM-18|\n|1151051235329|            ESM-71|\n+-------------+------------------+\n\nevent_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: bigint, mapping_event_code: string]\nevent_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: bigint, mapping_event_code: string]\nevent_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: bigint, mapping_event_code: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=171","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=172","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=173","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=174","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=175","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=176"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582600313339_-1799640798","id":"20200225-031153_1003314194","dateCreated":"2020-02-25T03:11:53+0000","dateStarted":"2020-02-26T06:05:16+0000","dateFinished":"2020-02-26T06:05:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4284"},{"text":"event_log_df = event_log_df.join(event_code_mapped, event_code_mapped.col(\"mapping_event_code\") === event_log_df.col(\"event_code\"), \"inner\").\ndrop(\"mapping_event_code\")\nevent_log_df.show()","user":"anonymous","dateUpdated":"2020-02-26T06:05:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+-------------+\n|DESTINATION| CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|event_id|event_code_id|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+-------------+\n|          1|1567408304| 1567408304|  2548383|     4802|          A|                0|                  0|            0|             0|             0|              0|    NLB-01|       None|      51| 214748364800|\n|          1|1567408305| 1567408304|  2391751|     3742|          A|                0|                  0|            0|             0|             0|              0|    ESM-72|       None|      59| 274877906944|\n|          1|1567408304| 1567408303|  2477481|     3742|          A|                0|                  0|            0|             0|             0|              0|    ESM-72|       None|      29| 274877906944|\n|          1|1567408305| 1567408305|  2534512|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|     123| 395136991232|\n|          1|1567408305| 1567408305|  2367643|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|     104| 395136991232|\n|          1|1567408305| 1567408304|  3380737|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|      88| 395136991232|\n|          1|1567408304| 1567408304|  1590408|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|      53| 395136991232|\n|          1|1567408304| 1567408304|  2347073|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|      49| 395136991232|\n|          1|1567408304| 1567408304|  2714582|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|      26| 395136991232|\n|          1|1567408304| 1567408300|  2262378|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|      14| 395136991232|\n|          1|1567408304| 1567408304|  2137931|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|       8| 395136991232|\n|          1|1567408305| 1567408305|  2631175|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|     141| 575525617664|\n|          1|1567408305| 1567408305|  2877532|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|     130| 575525617664|\n|          1|1567408305| 1567408305|  3134392|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|     109| 575525617664|\n|          1|1567408305| 1567408305|  2651238|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|     106| 575525617664|\n|          1|1567408305| 1567408305|  2591726|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|      94| 575525617664|\n|          1|1567408305| 1567408305|  1027003|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|      89| 575525617664|\n|          1|1567408305| 1567408305|  2666380|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|      81| 575525617664|\n|          1|1567408305| 1567408305|  2247668|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|      74| 575525617664|\n|          1|1567408305| 1567408305|  2694666|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|      66| 575525617664|\n+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+-------------+\nonly showing top 20 rows\n\nevent_log_df: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 14 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=177","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=178","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=179","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=180","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=181","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=182"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582601896439_2020983642","id":"20200225-033816_27887335","dateCreated":"2020-02-25T03:38:16+0000","dateStarted":"2020-02-26T06:05:28+0000","dateFinished":"2020-02-26T06:05:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4285"},{"text":"var event_log_monitor_type_join_df = monitor_type\n                .join(event_log_df, event_log_df.col(\"TARGET_ID\") === monitor_type.col(\"Monitor_target_id\"), \"right_outer\")\n\nevent_log_monitor_type_join_df.show()","user":"anonymous","dateUpdated":"2020-02-26T06:06:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----------------+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+-------------+\n|                TYPE|Monitor_target_id|DESTINATION| CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|event_id|event_code_id|\n+--------------------+-----------------+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+-------------+\n|                Ping|          2522185|          1|1567408304| 1567408304|  2522185|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      17| 635655159808|\n|WMI: Service Monitor|          2978236|       None|1567408304| 1567408304|  2978236|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|      48|1151051235328|\n|              Server|          1868540|          1|1567408304| 1567408304|  1868540|     3857|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|      47| 575525617664|\n|WMI: Service Monitor|          3240032|          1|1567408305| 1567408305|  3240032|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|     127|1151051235328|\n|          BMC: MSSQL|          2477481|          1|1567408304| 1567408303|  2477481|     3742|          A|                0|                  0|            0|             0|             0|              0|    ESM-72|       None|      29| 274877906944|\n|  HTTP Page Download|          2262378|          1|1567408304| 1567408300|  2262378|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|      14| 395136991232|\n|                Ping|          2131840|          1|1567408304| 1567408304|  2131840|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      37| 635655159808|\n|                Ping|          2350296|          1|1567408305| 1567408304|  2350296|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      65| 635655159808|\n|          BMC: MSSQL|          2391751|          1|1567408305| 1567408304|  2391751|     3742|          A|                0|                  0|            0|             0|             0|              0|    ESM-72|       None|      59| 274877906944|\n|                Ping|          2643561|          1|1567408305| 1567408305|  2643561|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     118| 635655159808|\n|                Ping|          2930525|          1|1567408304| 1567408304|  2930525|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      42| 635655159808|\n|         WMI: Server|          1547990|          1|1567408304| 1567408304|  1547990|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|      34|1151051235328|\n|                Ping|          2916860|          1|1567408304| 1567408304|  2916860|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      10| 635655159808|\n|                Ping|          3661892|          1|1567408305| 1567408304|  3661892|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      79| 635655159808|\n|                Ping|          2084968|          1|1567408304| 1567408303|  2084968|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      22| 635655159808|\n|                Ping|          2669180|          1|1567408305| 1567408305|  2669180|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     140| 635655159808|\n|WMI: Service Monitor|          1924187|          1|1567408304| 1567408304|  1924187|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|      35|1151051235328|\n|                Ping|          1522543|          1|1567408304| 1567408304|  1522543|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      38| 635655159808|\n|                Ping|          2072090|          1|1567408305| 1567408305|  2072090|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     132| 635655159808|\n|                Ping|          2454304|          1|1567408305| 1567408305|  2454304|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      93| 635655159808|\n+--------------------+-----------------+-----------+----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+-------------+\nonly showing top 20 rows\n\nevent_log_monitor_type_join_df: org.apache.spark.sql.DataFrame = [TYPE: string, Monitor_target_id: string ... 16 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=188","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=189","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=190","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=191","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=192","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=193"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582595284188_-107503849","id":"20200225-014804_1277291501","dateCreated":"2020-02-25T01:48:04+0000","dateStarted":"2020-02-26T06:06:40+0000","dateFinished":"2020-02-26T06:06:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4286"},{"text":"event_log_monitor_type_join_df = event_log_monitor_type_join_df.drop(\"Monitor_target_id\")\nevent_log_monitor_type_join_df.show()","user":"anonymous","dateUpdated":"2020-02-26T04:39:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----------+-----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+-------------+\n|TYPE|DESTINATION|  CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|event_id|event_code_id|\n+----+-----------+-----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+-------------+\n|null|          1| 1567408304| 1567408304|  1932727|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|      43| 154618822656|\n|null|          1| 1567408304| 1567408304|  2714582|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|      26|1614907703296|\n|null|          1| 1567408305| 1567408303|  1958790|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      78|1279900254208|\n|null|          1| 1567408306| 1567408305|  3002718|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     144|1279900254208|\n|null|          1| 1567408305| 1567408305|  1027003|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|      89|1288490188800|\n|null|          1| 1567408305| 1567408305|  2522489|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|     120| 154618822656|\n|null|          1| 1567408305| 1567408304|  2391751|     3742|          A|                0|                  0|            0|             0|             0|              0|    ESM-72|       None|      59| 781684047872|\n|null|          1| 1567408305| 1567408305|  2678591|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|     108| 154618822656|\n|null|          1| 1567408305| 1567408305|  2684702|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|     105| 154618822656|\n|null|          1| 1567408305| 1567408305|  2155209|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      80|1279900254208|\n|null|          1| 1567408304| 1567408304|  1466342|     3181|          A|                0|                  0|            0|             0|             0|              0|   SNMP-08|       None|      31|1288490188800|\n|null|          1| 1567408305| 1567408305|  2534512|     1012|          A|                0|                  0|            0|             0|             0|              0|    ISM-04|       None|     123|1614907703296|\n|null|          1| 1567408305| 1567408305|  2454304|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      93|1279900254208|\n|null|          1| 1567408304| 1567408304|  1924187|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|      35| 154618822656|\n|null|          1| 1567408305| 1567408304|  2095816|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|      76| 154618822656|\n|null|          1| 1567408305| 1567408305|  2423984|     2341|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|     101| 154618822656|\n|null|          1| 1567408305| 1567408304|  4033277|     3200|          A|                0|                  0|            0|             0|             0|              0|    ESM-18|       None|      91| 154618822656|\n|null|          1| 1567408305| 1567408303|  2660831|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|      84|1279900254208|\n|null|          1| 1567408304| 1567408304|  2948366|     3141|          A|                0|                  0|            0|             0|             0|              0|    ESM-70|       None|      18|1236950581248|\n|null|          1| 1567408305| 1567408305|  2666805|     1060|          A|                0|                  0|            0|             0|             0|              0|    ISM-30|       None|     110|1279900254208|\n+----+-----------+-----------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+-------------+\nonly showing top 20 rows\n\nevent_log_monitor_type_join_df: org.apache.spark.sql.DataFrame = [TYPE: string, DESTINATION: string ... 15 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=56","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=57","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=58","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=59","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=60","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=61"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582613654114_1825202925","id":"20200225-065414_1895787521","dateCreated":"2020-02-25T06:54:14+0000","dateStarted":"2020-02-26T04:39:39+0000","dateFinished":"2020-02-26T04:39:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4287"},{"text":"//Joining event_log_df with device.csv \nvar device_event_df = spark.read.option(\"header\", \"true\").csv(\"gs://rdx-cmu-2020-dataset/device.csv\")\ndevice_event_df = device_event_df.select(\n                            device_event_df.col(\"TARGET_ID\").as(\"trgt\"),\n                            device_event_df.col(\"RECON_ID\").as(\"device_recon_id\")\n                          )\ndevice_event_df.show()\n\n","user":"anonymous","dateUpdated":"2020-02-26T04:43:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+---------------+\n|trgt|device_recon_id|\n+----+---------------+\n|2777| PREATLAS_22811|\n|2778| PREATLAS_22811|\n|2779| PREATLAS_22811|\n|2780| PREATLAS_22811|\n|2781| PREATLAS_22811|\n|2782| PREATLAS_22811|\n|2783| PREATLAS_22811|\n|2784| PREATLAS_22811|\n|2785| PREATLAS_22811|\n|2786| PREATLAS_22811|\n|2787| PREATLAS_22811|\n|2788| PREATLAS_22811|\n|2789| PREATLAS_22811|\n|2790| PREATLAS_22811|\n|2791| PREATLAS_22811|\n|2792| PREATLAS_22811|\n|2793| PREATLAS_22811|\n|2794| PREATLAS_22811|\n|2795| PREATLAS_22811|\n|2796| PREATLAS_22811|\n+----+---------------+\nonly showing top 20 rows\n\ndevice_event_df: org.apache.spark.sql.DataFrame = [trgt: string, device_recon_id: string]\ndevice_event_df: org.apache.spark.sql.DataFrame = [trgt: string, device_recon_id: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=71","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=72"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582595675886_-87179072","id":"20200225-015435_2040688096","dateCreated":"2020-02-25T01:54:35+0000","dateStarted":"2020-02-26T04:43:44+0000","dateFinished":"2020-02-26T04:43:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4288"},{"text":"device_event_df = event_log_monitor_type_join_df.join(device_event_df, \n                        device_event_df.col(\"trgt\") === event_log_monitor_type_join_df.col(\"TARGET_ID\"))\n.drop(\"trgt\")\ndevice_event_df.show()","user":"anonymous","dateUpdated":"2020-02-26T04:44:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----------+---------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+-------------+---------------+\n|TYPE|DESTINATION|CORE_TIME|POLLER_TIME|TARGET_ID|POLICY_ID|POLICY_TYPE|DETECTED_SEVERITY|PROPAGATED_SEVERITY|LOW_THRESHOLD|MEASURED_VALUE|HIGH_THRESHOLD|PROPAGATED_FLAG|EVENT_CODE|METRIC_NAME|event_id|event_code_id|device_recon_id|\n+----+-----------+---------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+-------------+---------------+\n+----+-----------+---------+-----------+---------+---------+-----------+-----------------+-------------------+-------------+--------------+--------------+---------------+----------+-----------+--------+-------------+---------------+\n\ndevice_event_df: org.apache.spark.sql.DataFrame = [TYPE: string, DESTINATION: string ... 16 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=73","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=74","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=75","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=76","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=77","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=78","http://etl-m.us-east4-a.c.cmu-rdx-2020.internal:4040/jobs/job?id=79"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1582615515494_-551378310","id":"20200225-072515_242094076","dateCreated":"2020-02-25T07:25:15+0000","dateStarted":"2020-02-26T04:44:09+0000","dateFinished":"2020-02-26T04:44:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4289"},{"text":"var device_details_df = spark.read.option(\"header\", \"true\").csv(\"gs://rdx-cmu-2020-dataset/device_location.csv\")\r\ndevice_details_df = device_details_df.select(\r\n                            device_details_df.col(\"BUS_ID\").as(\"device_bus_id\"),\r\n                            device_details_df.col(\"DEVICE_TYPE\"),\r\n                            device_details_df.col(\"OPERATING_SYSTEM\"),\r\n                            device_details_df.col(\"RECONCILIATION_ID\"),\r\n                            device_details_df.col(\"SITE\"),\r\n                            device_details_df.col(\"TYPE_NAME\"),\r\n                            device_details_df.col(\"IS_VIRTUAL\")\r\n                          )\r\ndevice_details_df.show()","user":"anonymous","dateUpdated":"2020-02-25T09:02:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582606356400_-2137621509","id":"20200225-045236_1288301094","dateCreated":"2020-02-25T04:52:36+0000","dateStarted":"2020-02-25T09:02:05+0000","dateFinished":"2020-02-25T09:02:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4290"},{"text":"var device_detail_event_df = event_log_monitor_type_join_df\n        .join(device_details_df, event_log_monitor_type_join_df.col(\"device_recon_id\") === device_details_df.col(\"RECONCILIATION_ID\"), \"left_outer\")\n        .drop(\"RECONCILIATION_ID\")\ndevice_detail_event_df.show()","user":"anonymous","dateUpdated":"2020-02-25T09:22:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582621003116_41095324","id":"20200225-085643_1417775286","dateCreated":"2020-02-25T08:56:43+0000","dateStarted":"2020-02-25T09:22:33+0000","dateFinished":"2020-02-25T09:23:37+0000","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4291"},{"text":"","user":"anonymous","dateUpdated":"2020-02-25T09:10:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1582620981586_-59539022","id":"20200225-085621_72750128","dateCreated":"2020-02-25T08:56:21+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4292"}],"name":"ETL","id":"2F3253QMV","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}