{"paragraphs":[{"text":"%dep\nz.load(\"/home/hadoop/mysql-connector-java-8.0.19.jar\")","user":"anonymous","dateUpdated":"2020-03-24T19:09:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.lang.NullPointerException\n\tat org.sonatype.aether.impl.internal.DefaultRepositorySystem.resolveDependencies(DefaultRepositorySystem.java:352)\n\tat org.apache.zeppelin.spark.dep.SparkDependencyContext.fetchArtifactWithDep(SparkDependencyContext.java:171)\n\tat org.apache.zeppelin.spark.dep.SparkDependencyContext.fetch(SparkDependencyContext.java:121)\n\tat org.apache.zeppelin.spark.DepInterpreter.interpret(DepInterpreter.java:247)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.interpret(LazyOpenInterpreter.java:103)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterServer$InterpretJob.jobRun(RemoteInterpreterServer.java:632)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:188)\n\tat org.apache.zeppelin.scheduler.FIFOScheduler$1.run(FIFOScheduler.java:140)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n"}]},"apps":[],"jobName":"paragraph_1585065829651_-265653010","id":"20200324-160349_1178563826","dateCreated":"2020-03-24T16:03:49+0000","dateStarted":"2020-03-24T16:25:11+0000","dateFinished":"2020-03-24T16:25:12+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12453"},{"text":"import org.apache.spark.sql.expressions.Window;\r\nimport org.apache.spark.sql.types.TimestampType;\r\n// import org.apache.spark.sql.expressions.Window","user":"anonymous","dateUpdated":"2020-03-24T19:09:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.expressions.Window\nimport org.apache.spark.sql.types.TimestampType\n"}]},"apps":[],"jobName":"paragraph_1585062673040_-643905403","id":"20200229-023639_871760853","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:09:59+0000","dateFinished":"2020-03-24T19:09:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12454"},{"text":"//Get the bus_parent.csv into a dataframe \nvar bus_parent_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"s3://navisite-dataset-test/bus_parent.csv\");\nbus_parent_df = bus_parent_df.select(\n            bus_parent_df.col(\"PARENT_ID\").as(\"PARENT_BUS_ID\"),\n            bus_parent_df.col(\"BUS_ID\").as(\"HIER_BUS_ID\")\n    );\nbus_parent_df.show();","user":"anonymous","dateUpdated":"2020-03-24T19:09:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-----------+\n|PARENT_BUS_ID|HIER_BUS_ID|\n+-------------+-----------+\n|         1914|       5793|\n|        14748|       9873|\n|         1914|      10354|\n|         1914|      10615|\n|         1914|      11376|\n|        29710|      11839|\n|        29710|      11840|\n|         1914|      11841|\n|         1914|      11895|\n|        34872|      11896|\n|         1914|      12175|\n|         1914|      13615|\n|         1914|      14035|\n|         1914|      14655|\n|        29710|      14912|\n|        29710|      14913|\n|        29710|      14923|\n|        29710|      14924|\n|        29710|      14925|\n|        29710|      14929|\n+-------------+-----------+\nonly showing top 20 rows\n\nbus_parent_df: org.apache.spark.sql.DataFrame = [PARENT_BUS_ID: string, HIER_BUS_ID: string]\nbus_parent_df: org.apache.spark.sql.DataFrame = [PARENT_BUS_ID: string, HIER_BUS_ID: string]\n"}]},"apps":[],"jobName":"paragraph_1585062673044_415838252","id":"20200226-060757_2141589333","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:09:59+0000","dateFinished":"2020-03-24T19:10:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12455"},{"text":"//Get the customer.csv into a dataframe \nvar customer_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"s3://navisite-dataset-test/customer.csv\");\ncustomer_df = customer_df.select(\n            customer_df.col(\"RECONCILIATION_ID\"),\n            customer_df.col(\"BUS_ID\").as(\"BUS_ID\")\n    );\ncustomer_df.show();","user":"anonymous","dateUpdated":"2020-03-24T19:10:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------+\n|   RECONCILIATION_ID|BUS_ID|\n+--------------------+------+\n|OI-FDF0CAB69CEF11...| 37146|\n|OI-D723D6129D9911...| 38023|\n|OI-6E3509E09CF011...| 16715|\n|OI-343704B49CF011...| 19922|\n|OI-6F5224DE9CF011...| 37373|\n|OI-3170ECAE9CF011...| 35140|\n|OI-7E74093C9CF011...| 35663|\n|OI-64074C4E9CF011...| 34807|\n|OI-8A2BBAF49DA411...| 38177|\n|OI-498348969CF011...| 35562|\n|OI-6D8C65069CF011...| 34821|\n|OI-8698CEEA9CF011...| 27010|\n|OI-1A354A3A9CF011...| 35574|\n|OI-6BD775709CF011...| 36024|\n|OI-3F5DC0F89CF011...| 35310|\n|OI-7F198BE69DA411...| 32710|\n|OI-8943417A9DA411...| 35383|\n|OI-39EFEBAA9CF011...| 35376|\n|OI-0406791E9CF011...| 37018|\n|OI-1AEC4C3A9CF011...| 10615|\n+--------------------+------+\nonly showing top 20 rows\n\ncustomer_df: org.apache.spark.sql.DataFrame = [RECONCILIATION_ID: string, BUS_ID: string]\ncustomer_df: org.apache.spark.sql.DataFrame = [RECONCILIATION_ID: string, BUS_ID: string]\n"}]},"apps":[],"jobName":"paragraph_1585062673045_1456001705","id":"20200226-060821_1073898764","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:10:00+0000","dateFinished":"2020-03-24T19:10:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12456"},{"text":"//Get the device.csv into a dataframe \nvar device_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"s3://navisite-dataset-test/device.csv\");\ndevice_df = device_df.select(\n            device_df.col(\"TARGET_ID\").as(\"DEVICE_TARGET_ID\"),\n            device_df.col(\"RECON_ID\")\n    )\ndevice_df.show();","user":"anonymous","dateUpdated":"2020-03-24T19:10:01+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+--------------+\n|DEVICE_TARGET_ID|      RECON_ID|\n+----------------+--------------+\n|            2777|PREATLAS_22811|\n|            2778|PREATLAS_22811|\n|            2779|PREATLAS_22811|\n|            2780|PREATLAS_22811|\n|            2781|PREATLAS_22811|\n|            2782|PREATLAS_22811|\n|            2783|PREATLAS_22811|\n|            2784|PREATLAS_22811|\n|            2785|PREATLAS_22811|\n|            2786|PREATLAS_22811|\n|            2787|PREATLAS_22811|\n|            2788|PREATLAS_22811|\n|            2789|PREATLAS_22811|\n|            2790|PREATLAS_22811|\n|            2791|PREATLAS_22811|\n|            2792|PREATLAS_22811|\n|            2793|PREATLAS_22811|\n|            2794|PREATLAS_22811|\n|            2795|PREATLAS_22811|\n|            2796|PREATLAS_22811|\n+----------------+--------------+\nonly showing top 20 rows\n\ndevice_df: org.apache.spark.sql.DataFrame = [DEVICE_TARGET_ID: string, RECON_ID: string]\ndevice_df: org.apache.spark.sql.DataFrame = [DEVICE_TARGET_ID: string, RECON_ID: string]\n"}]},"apps":[],"jobName":"paragraph_1585062673045_917859987","id":"20200226-060859_2104217724","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:10:01+0000","dateFinished":"2020-03-24T19:10:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12457"},{"text":"//Get the device_location.csv into a dataframe \nvar device_location_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"s3://navisite-dataset-test/device_location.csv\");\ndevice_location_df = device_location_df.select(\n    col(\"BUS_ID\").as(\"BUS_ID_DEV\"),\n    col(\"DEVICE_TYPE\"),\n    col(\"OPERATING_SYSTEM\"),\n    col(\"RECONCILIATION_ID\"),\n    col(\"SITE\"),\n    col(\"SITE\").as(\"SITE_DESC\"),\n    col(\"IS_VIRTUAL\")\n    );\ndevice_location_df.show();","user":"anonymous","dateUpdated":"2020-03-24T19:10:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\n|BUS_ID_DEV|         DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|                SITE|           SITE_DESC|IS_VIRTUAL|\n+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\n|     37146|   RAIDStorageDevice|            null|OI-FDF0CAB69CEF11...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     38023|              Server|            null|OI-D723D6129D9911...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         Y|\n|     16715|              Server|            null|OI-6E3509E09CF011...|    RHUK01-Unit 3 St|    RHUK01-Unit 3 St|         Y|\n|     19922|              Router|            null|OI-343704B49CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     37373|              Server|            null|OI-6F5224DE9CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         Y|\n|     35140|              Switch|            null|OI-3170ECAE9CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     35663|       Load Balancer|            null|OI-7E74093C9CF011...|WOKING-Digital Re...|WOKING-Digital Re...|         Y|\n|     34807|              Server|            null|OI-64074C4E9CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         Y|\n|     38177|Link Aggregation Tap|            null|OI-8A2BBAF49DA411...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     35562|              Server|            null|OI-498348969CF011...|SCCA130-2805 Lafa...|SCCA130-2805 Lafa...|         Y|\n|     34821|              Switch|            null|OI-6D8C65069CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     27010|              Server|            null|OI-8698CEEA9CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     35574|             Network|            null|OI-1A354A3A9CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     36024|              Server|            null|OI-6BD775709CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         Y|\n|     35310|              Server|            null|OI-3F5DC0F89CF011...|    RHUK01-Unit 3 St|    RHUK01-Unit 3 St|         N|\n|     32710|            Firewall|            null|OI-7F198BE69DA411...|LOUK01-East India...|LOUK01-East India...|         N|\n|     35383|              Router|            null|OI-8943417A9DA411...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     35376|     Processing unit|            null|OI-39EFEBAA9CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n|     37018|              Server|            null|OI-0406791E9CF011...|SCCA120-2805 Lafa...|SCCA120-2805 Lafa...|         Y|\n|     10615|              Server|            null|OI-1AEC4C3A9CF011...| MM-400 Minuteman Rd| MM-400 Minuteman Rd|         N|\n+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\ndevice_location_df: org.apache.spark.sql.DataFrame = [BUS_ID_DEV: string, DEVICE_TYPE: string ... 5 more fields]\ndevice_location_df: org.apache.spark.sql.DataFrame = [BUS_ID_DEV: string, DEVICE_TYPE: string ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673046_-25629993","id":"20200226-060859_1373866278","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:10:02+0000","dateFinished":"2020-03-24T19:10:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12458"},{"text":"// clean SITE values\ndevice_location_df =  device_location_df.withColumn(\"SITE\" ,regexp_replace(col(\"SITE\"), \"[^0-9a-zA-Z]+\", \"\"));\ndevice_location_df.show();","user":"anonymous","dateUpdated":"2020-03-24T19:10:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\n|BUS_ID_DEV|         DEVICE_TYPE|OPERATING_SYSTEM|   RECONCILIATION_ID|                SITE|           SITE_DESC|IS_VIRTUAL|\n+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\n|     37146|   RAIDStorageDevice|            null|OI-FDF0CAB69CEF11...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     38023|              Server|            null|OI-D723D6129D9911...|    MM400MinutemanRd| MM-400 Minuteman Rd|         Y|\n|     16715|              Server|            null|OI-6E3509E09CF011...|       RHUK01Unit3St|    RHUK01-Unit 3 St|         Y|\n|     19922|              Router|            null|OI-343704B49CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     37373|              Server|            null|OI-6F5224DE9CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         Y|\n|     35140|              Switch|            null|OI-3170ECAE9CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     35663|       Load Balancer|            null|OI-7E74093C9CF011...| WOKINGDigitalRealty|WOKING-Digital Re...|         Y|\n|     34807|              Server|            null|OI-64074C4E9CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         Y|\n|     38177|Link Aggregation Tap|            null|OI-8A2BBAF49DA411...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     35562|              Server|            null|OI-498348969CF011...|SCCA1302805Lafaye...|SCCA130-2805 Lafa...|         Y|\n|     34821|              Switch|            null|OI-6D8C65069CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     27010|              Server|            null|OI-8698CEEA9CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     35574|             Network|            null|OI-1A354A3A9CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     36024|              Server|            null|OI-6BD775709CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         Y|\n|     35310|              Server|            null|OI-3F5DC0F89CF011...|       RHUK01Unit3St|    RHUK01-Unit 3 St|         N|\n|     32710|            Firewall|            null|OI-7F198BE69DA411...|LOUK01EastIndiaDo...|LOUK01-East India...|         N|\n|     35383|              Router|            null|OI-8943417A9DA411...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     35376|     Processing unit|            null|OI-39EFEBAA9CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n|     37018|              Server|            null|OI-0406791E9CF011...|SCCA1202805Lafaye...|SCCA120-2805 Lafa...|         Y|\n|     10615|              Server|            null|OI-1AEC4C3A9CF011...|    MM400MinutemanRd| MM-400 Minuteman Rd|         N|\n+----------+--------------------+----------------+--------------------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\ndevice_location_df: org.apache.spark.sql.DataFrame = [BUS_ID_DEV: string, DEVICE_TYPE: string ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673046_-906853630","id":"20200320-151848_49424552","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:10:03+0000","dateFinished":"2020-03-24T19:10:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12459"},{"text":"//Get the parent.csv into a dataframe \nvar parent_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"s3://navisite-dataset-test/parent.csv\");\n\nparent_df = parent_df.select(\n            parent_df.col(\"PARENT_ID\").as(\"PARENT_TARGET_ID\"),\n            parent_df.col(\"TARGET_ID\").as(\"CHILD_TARGET_ID\")\n    );","user":"anonymous","dateUpdated":"2020-03-24T19:10:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"parent_df: org.apache.spark.sql.DataFrame = [PARENT_TARGET_ID: string, CHILD_TARGET_ID: string]\nparent_df: org.apache.spark.sql.DataFrame = [PARENT_TARGET_ID: string, CHILD_TARGET_ID: string]\n"}]},"apps":[],"jobName":"paragraph_1585062673046_1878728173","id":"20200226-060858_614673072","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:10:04+0000","dateFinished":"2020-03-24T19:10:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12460"},{"text":"//Get the type.csv into a dataframe \nvar type_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"s3://navisite-dataset-test/type.csv\");\n\ntype_df = type_df.select(\n            type_df.col(\"TARGET_ID\").as(\"MONITOR_ID\"),\n            type_df.col(\"TYPE\").as(\"MONITOR_DESC\")\n    );\n    ","user":"anonymous","dateUpdated":"2020-03-24T19:10:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"type_df: org.apache.spark.sql.DataFrame = [MONITOR_ID: string, MONITOR_DESC: string]\ntype_df: org.apache.spark.sql.DataFrame = [MONITOR_ID: string, MONITOR_DESC: string]\n"}]},"apps":[],"jobName":"paragraph_1585062673047_-2133025334","id":"20200226-060858_967312711","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:10:05+0000","dateFinished":"2020-03-24T19:10:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12461"},{"text":"val test = type_df.select(\"MONITOR_DESC\").distinct();\ntest.show()","user":"anonymous","dateUpdated":"2020-03-24T19:10:05+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|        MONITOR_DESC|\n+--------------------+\n|        Power Supply|\n|   WMI: Logical Disk|\n|      Dynamo Process|\n|         Memory Pool|\n|      INSYNC Monitor|\n|BMC: Network Inte...|\n|                Ping|\n|Apache Server Status|\n|   Network Interface|\n|            Firewall|\n|   Generic Component|\n|WMI: Service Monitor|\n|       Voltage Probe|\n|      Protocol (NTP)|\n|             Disk IO|\n|      PeopleSoft Job|\n|   Temperature Probe|\n|           BMC: Disk|\n|   Dynamo SNMP Probe|\n|Alteon ISD Enviro...|\n+--------------------+\nonly showing top 20 rows\n\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [MONITOR_DESC: string]\n"}]},"apps":[],"jobName":"paragraph_1585062673047_-390855286","id":"20200304-235146_648570979","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:10:05+0000","dateFinished":"2020-03-24T19:10:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12462"},{"text":"import org.apache.spark.sql.types.{StructType, StructField, StringType, IntegerType};","user":"anonymous","dateUpdated":"2020-03-24T19:10:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types.{StructType, StructField, StringType, IntegerType}\n"}]},"apps":[],"jobName":"paragraph_1585062673047_1297161082","id":"20200324-080615_258843398","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:10:10+0000","dateFinished":"2020-03-24T19:10:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12463"},{"text":"//Get the event_log.csv into a dataframe \nval schema = StructType(Array(StructField(\"destination\", StringType, true), \n                                    StructField(\"core_time\", StringType, true),\n                                    StructField(\"poller_time\", StringType, true),\n                                    StructField(\"target_id\", StringType, true), \n                                    StructField(\"policy_id\", StringType, true),\n                                    StructField(\"policy_type\", StringType, true),\n                                    StructField(\"detected_severity\", StringType, true), \n                                    StructField(\"propagated_severity\", StringType, true),\n                                    StructField(\"low_threshold\", StringType, true),\n                                    StructField(\"measured_value\", StringType, true), \n                                    StructField(\"high_threshold\", StringType, true),\n                                    StructField(\"propagated_flag\", StringType, true),\n                                    StructField(\"event_code\", StringType, true), \n                                    StructField(\"metric_name\", StringType, true)\n                                    ))\nvar event_log_df = sqlContext.read.format(\"com.databricks.spark.csv\").\n                         option(\"mode\", \"DROPMALFORMED\").\n                         schema(schema).load(\"s3://navisite-dataset-test/event.log.20190902031144.csv.gz\",\n                         \"s3://navisite-dataset-test/event.log.20190903032153.csv.gz\",\n                         \"s3://navisite-dataset-test/event.log.20190904031750.csv.gz\",\n                         \"s3://navisite-dataset-test/event.log.20190905033050.csv.gz\",\n                         \"s3://navisite-dataset-test/event.log.20190906033242.csv.gz\",\n                         \"s3://navisite-dataset-test/event.log.20190907031748.csv.gz\",\n                         \"s3://navisite-dataset-test/event.log.20190908033253.csv.gz\")\nevent_log_df = event_log_df.filter(\"policy_type == 'T'\" ).filter(\"metric_name != 'Started'\");\nevent_log_df.count();\n","user":"anonymous","dateUpdated":"2020-03-24T19:10:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"schema: org.apache.spark.sql.types.StructType = StructType(StructField(destination,StringType,true), StructField(core_time,StringType,true), StructField(poller_time,StringType,true), StructField(target_id,StringType,true), StructField(policy_id,StringType,true), StructField(policy_type,StringType,true), StructField(detected_severity,StringType,true), StructField(propagated_severity,StringType,true), StructField(low_threshold,StringType,true), StructField(measured_value,StringType,true), StructField(high_threshold,StringType,true), StructField(propagated_flag,StringType,true), StructField(event_code,StringType,true), StructField(metric_name,StringType,true))\nevent_log_df: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 12 more fields]\nevent_log_df: org.apache..."}]},"apps":[],"jobName":"paragraph_1585062673048_-1820736044","id":"20200226-060855_595029811","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:10:10+0000","dateFinished":"2020-03-24T19:15:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12464"},{"text":"// get top customers from top_clients.csv\nvar top_clients_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"s3://navisite-dataset-test/top_clients.csv\");\ntop_clients_df = top_clients_df.select(\n            top_clients_df.col(\"NEW_BUS_ID\").as(\"NEW_BUS_ID\"),\n            top_clients_df.col(\"RECONCILIATION_NUM\").as(\"NUM_CUST_DEVICES\"),\n            top_clients_df.col(\"PERCENT\").as(\"PERCENT\"),\n            top_clients_df.col(\"CUMULATIVE_PERCENT\").as(\"CUMULATIVE_PERCENT\"),\n            top_clients_df.col(\"RANK\").as(\"RANK\")\n    );\n\n\ntop_clients_df.show();","user":"anonymous","dateUpdated":"2020-03-24T19:15:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+----------------+-------+------------------+----+\n|NEW_BUS_ID|NUM_CUST_DEVICES|PERCENT|CUMULATIVE_PERCENT|RANK|\n+----------+----------------+-------+------------------+----+\n|     34807|            2778|  0.049|             0.049|   1|\n|     35574|            2601|  0.046|             0.095|   2|\n|     35140|            2336|  0.041|             0.136|   3|\n|      1914|            1863|  0.033|             0.169|   4|\n|     29710|            1376|  0.024|             0.193|   5|\n|     32890|            1308|  0.023|             0.216|   6|\n|     35383|            1174|  0.021|             0.237|   7|\n|     11838|             659|  0.012|             0.248|   8|\n|     35821|             615|  0.011|             0.259|   9|\n|     33554|             612|  0.011|             0.270|  10|\n|     33617|             603|  0.011|             0.281|  11|\n|     15804|             592|  0.010|             0.291|  12|\n|     35340|             554|  0.010|             0.301|  13|\n|     36973|             544|  0.010|             0.311|  14|\n|     35562|             521|  0.009|             0.320|  15|\n|     35698|             435|  0.008|             0.327|  16|\n|     11876|             429|  0.008|             0.335|  17|\n|     16715|             405|  0.007|             0.342|  18|\n|     35183|             373|  0.007|             0.349|  19|\n|     14748|             325|  0.006|             0.354|  20|\n+----------+----------------+-------+------------------+----+\nonly showing top 20 rows\n\ntop_clients_df: org.apache.spark.sql.DataFrame = [NEW_BUS_ID: string, NUM_CUST_DEVICES: string ... 3 more fields]\ntop_clients_df: org.apache.spark.sql.DataFrame = [NEW_BUS_ID: string, NUM_CUST_DEVICES: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673048_-797441392","id":"20200226-063855_62253060","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:30+0000","dateFinished":"2020-03-24T19:15:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12465"},{"text":"// Get EventCode and an associated intger mapping\nvar event_code_mapped = event_log_df.select(\"event_code\").distinct();\nevent_code_mapped = event_code_mapped.withColumn(\"event_code_id\", row_number().over(Window.orderBy(\"event_code\")));\nevent_code_mapped = event_code_mapped.select(\n         event_code_mapped.col(\"event_code_id\"),\n       event_code_mapped.col(\"event_code\").as(\"mapping_event_code\")\n    )\n    \nregexp_replace(event_code_mapped(\"mapping_event_code\"),\"\\\\s+\",\" \");","user":"anonymous","dateUpdated":"2020-03-24T19:15:31+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: int, mapping_event_code: string]\nevent_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: int, mapping_event_code: string]\nevent_code_mapped: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [event_code_id: int, mapping_event_code: string]\nres43: org.apache.spark.sql.Column = regexp_replace(mapping_event_code, \\s+,  )\n"}]},"apps":[],"jobName":"paragraph_1585062673048_2138795966","id":"20200226-065423_868519549","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:31+0000","dateFinished":"2020-03-24T19:15:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12466"},{"text":"// event_code_mapped.show()","user":"anonymous","dateUpdated":"2020-03-24T19:15:31+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585062673049_-2028887370","id":"20200229-021209_2085882877","dateCreated":"2020-03-24T15:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:12467"},{"text":"var device_event_log = event_log_df.join(device_df, event_log_df.col(\"TARGET_ID\") === device_df.col(\"DEVICE_TARGET_ID\"), \"inner\")\n                            .drop(\"DEVICE_TARGET_ID\");\n// device_event_log.count();// : 47\n// device_event_log.show();","user":"anonymous","dateUpdated":"2020-03-24T19:15:31+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"device_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673049_1541617109","id":"20200226-072006_528594224","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:31+0000","dateFinished":"2020-03-24T19:15:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12468"},{"text":"var cust_device_event_log = device_event_log\n    .join(customer_df, device_event_log.col(\"RECON_ID\") === customer_df.col(\"RECONCILIATION_ID\"), \"inner\").drop(\"RECONCILIATION_ID\");\n//  cust_device_event_log.count(); // 47\n// cust_device_event_log.show();","user":"anonymous","dateUpdated":"2020-03-24T19:15:31+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cust_device_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 14 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673049_494431739","id":"20200226-075401_853406802","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:31+0000","dateFinished":"2020-03-24T19:15:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12469"},{"text":"var cust_detail_device_event_log = cust_device_event_log\n    .join(bus_parent_df, cust_device_event_log.col(\"BUS_ID\") === bus_parent_df.col(\"HIER_BUS_ID\"), \"left_outer\").drop(\"HIER_BUS_ID\");\n// cust_detail_device_event_log.show();\n","user":"anonymous","dateUpdated":"2020-03-24T19:15:31+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cust_detail_device_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 15 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673050_711680112","id":"20200226-080124_1698475559","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:31+0000","dateFinished":"2020-03-24T19:15:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12470"},{"text":"var top_cust_detail_device_event_log = \ncust_detail_device_event_log.join(top_clients_df, cust_detail_device_event_log(\"BUS_ID\") === top_clients_df(\"NEW_BUS_ID\") || cust_detail_device_event_log(\"PARENT_BUS_ID\") === top_clients_df(\"NEW_BUS_ID\"), \"inner\").drop(\"CUMULATIVE_PERCENT\", \"RANK\", \"PERCENT\"); \n\n// top_cust_detail_device_event_log.show();","user":"anonymous","dateUpdated":"2020-03-24T19:15:32+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"top_cust_detail_device_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 17 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673050_-182584632","id":"20200229-022405_11824168","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:32+0000","dateFinished":"2020-03-24T19:15:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12471"},{"text":"// top_cust_detail_device_event_log.show();\n// top_cust_detail_device_event_log.count();","user":"anonymous","dateUpdated":"2020-03-24T19:15:32+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585062673050_-1970571460","id":"20200229-024822_1508795478","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:32+0000","dateFinished":"2020-03-24T19:15:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12472"},{"text":"var top_cust_device_detail_event_log = top_cust_detail_device_event_log.join(device_location_df, top_cust_detail_device_event_log(\"RECON_ID\") === device_location_df(\"RECONCILIATION_ID\"), \"left_outer\").drop(\"BUS_ID_DEV\").drop(\"RECONCILIATION_ID\");\n\n// top_cust_device_detail_event_log.show();","user":"anonymous","dateUpdated":"2020-03-24T19:15:32+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"top_cust_device_detail_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 22 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673051_-1145837056","id":"20200229-024946_1459553842","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:32+0000","dateFinished":"2020-03-24T19:15:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12473"},{"text":"var top_cust_device_monitor_event_log \n= top_cust_device_detail_event_log.join(parent_df, top_cust_device_detail_event_log(\"TARGET_ID\") === parent_df(\"CHILD_TARGET_ID\"), \"left_outer\").drop(\"CHILD_TARGET_ID\");","user":"anonymous","dateUpdated":"2020-03-24T19:15:32+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"top_cust_device_monitor_event_log: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 23 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673051_-777826738","id":"20200229-030552_960796511","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:32+0000","dateFinished":"2020-03-24T19:15:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12474"},{"text":"// top_cust_device_monitor_event_log.count();\n// top_cust_device_monitor_event_log.show();","user":"anonymous","dateUpdated":"2020-03-24T19:15:32+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585062673051_88347904","id":"20200229-033940_2133138157","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:33+0000","dateFinished":"2020-03-24T19:15:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12475"},{"text":"var event_logs_desc\n= top_cust_device_monitor_event_log.join(type_df, top_cust_device_monitor_event_log(\"TARGET_ID\") === type_df(\"MONITOR_ID\"), \"left_outer\").drop(\"MONITOR_ID\");","user":"anonymous","dateUpdated":"2020-03-24T19:15:33+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_logs_desc: org.apache.spark.sql.DataFrame = [destination: string, core_time: string ... 24 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673051_-593867247","id":"20200229-035222_303729447","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:33+0000","dateFinished":"2020-03-24T19:15:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12476"},{"text":"// print(event_logs_desc.count());\n// event_logs_desc.show();\n","user":"anonymous","dateUpdated":"2020-03-24T19:15:33+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585062673052_-292970728","id":"20200229-035219_594502101","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:33+0000","dateFinished":"2020-03-24T19:15:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12477"},{"text":"/*var event_logs_df = event_logs_desc.select(\n    col(\"DESTINATION\"),\n    col(\"CORE_TIME\"),\n    //col(\"CORE_TIME\").cast(\"TimestampType\").as(\"CORE_TIMESTAMP\"),\n    to_date(col(\"CORE_TIME\").cast(TimestampType)).as(\"CORE_TIMESTAMP\"),\n    to_date(from_unixtime($\"CORE_TIME\", \"dd-MM-yyyy\")).as(\"CORE_TIMESTAMP2\"),\n    unix_timestamp(col(\"CORE_TIME\")).as(\"CORE_TIMESTAMP3\"),\n    to_date(from_unixtime($\"CORE_TIME\")).as(\"CORE_TIMESTAMP4\"),  /////////////gold\n    to_date(from_unixtime($\"CORE_TIME\"), \"YYYY-MM-dd HH:mm:ss\").as(\"CORE_TIMESTAMP5\"),\n    // to_date(from_unixtime($\"CORE_TIME\", \"dd-MMM-yyyy HH:mm:ss\")).as(\"CORE_TIMESTAMP6\"),\n     to_timestamp(from_unixtime($\"CORE_TIME\")).as(\"CORE_TIMESTAMP7\"),  \n    col(\"POLLER_TIME\"),\n    col(\"POLLER_TIME\").cast(\"timestamp\").as(\"POLLER_TIMESTAMP\"),\n    col(\"TARGET_ID\"));\n    \nevent_logs_df.show();*/\nvar event_logs_df = event_logs_desc.select(\n    col(\"DESTINATION\"),\n    col(\"CORE_TIME\"),\n    to_timestamp(from_unixtime($\"CORE_TIME\")).as(\"CORE_TIMESTAMP\"),\n    col(\"POLLER_TIME\"),\n    to_timestamp(from_unixtime($\"POLLER_TIME\")).as(\"POLLER_TIMESTAMP\"),\n    col(\"TARGET_ID\"),\n    col(\"POLICY_ID\"),\n    col(\"POLICY_TYPE\"),\n    col(\"DETECTED_SEVERITY\"),\n    col(\"PROPAGATED_SEVERITY\"),\n    col(\"LOW_THRESHOLD\"),\n    col(\"MEASURED_VALUE\"),\n    col(\"HIGH_THRESHOLD\"),\n    col(\"PROPAGATED_FLAG\"),\n    col(\"EVENT_CODE\"),\n    col(\"METRIC_NAME\"),\n    col(\"RECON_ID\"),\n    col(\"BUS_ID\"),\n    col(\"PARENT_BUS_ID\"),\n    col(\"NEW_BUS_ID\"),\n    col(\"NUM_CUST_DEVICES\"),\n    col(\"DEVICE_TYPE\"),\n    col(\"OPERATING_SYSTEM\"),\n    col(\"SITE\"),\n    col(\"SITE_DESC\"),\n    col(\"IS_VIRTUAL\"),\n    col(\"PARENT_TARGET_ID\"),\n    col(\"MONITOR_DESC\")\n    ); ","user":"anonymous","dateUpdated":"2020-03-24T19:15:33+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"event_logs_df: org.apache.spark.sql.DataFrame = [DESTINATION: string, CORE_TIME: string ... 26 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673053_943578113","id":"20200229-042344_1009022911","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:33+0000","dateFinished":"2020-03-24T19:15:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12478"},{"text":"// event_logs_df.show();","user":"anonymous","dateUpdated":"2020-03-24T19:15:33+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585062673053_-1603614516","id":"20200229-044633_490756168","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:33+0000","dateFinished":"2020-03-24T19:15:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12479"},{"text":"// S0 join event_log and device based on target id : OK\n// S1 join S0 and customer based on target id : OK\n// S2 join S1 and customer_parent based on bus_id : OK\n// S3 join S2 and top_customers where bus_id = custid or parent_bus_id = top_customers.bus_id :OK\n// S4 S3 join device_location_data :OK\n// add type and device hierarchy","user":"anonymous","dateUpdated":"2020-03-24T19:15:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585062673053_1258776319","id":"20200226-071605_293215532","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:34+0000","dateFinished":"2020-03-24T19:15:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12480"},{"text":"//Get the incident.csv into a dataframe \nvar incident_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"s3://navisite-dataset-test/incidents.csv\");\n\nincident_df = incident_df.withColumn(\n      \"Is_Source_Monitor\",\n      when(incident_df.col(\"submitter\") === \"Other\", 0)\n        .otherwise(1)\n    );\n    \nincident_df = incident_df.select(\n            incident_df.col(\"incident_id\").as(\"INCIDENT_ID\"),\n            incident_df.col(\"submit_date\").as(\"SUBMIT_DATE\"),\n            incident_df.col(\"bus_id\").as(\"BUS_ID\"),\n            incident_df.col(\"event_code\").as(\"EVENT_CODE\"),\n            incident_df.col(\"Is_Source_Monitor\").as(\"Is_Source_Monitor\")\n    );    \n// incident_df.show();","user":"anonymous","dateUpdated":"2020-03-24T19:15:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"incident_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 3 more fields]\nincident_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 3 more fields]\nincident_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673053_417572382","id":"20200229-035705_296817465","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:34+0000","dateFinished":"2020-03-24T19:15:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12481"},{"text":"//Get the incident_device.csv into a dataframe \nvar incident_device_df = spark.read.option(\"header\", \"true\").option(\"ignoreLeadingWhiteSpace\",true).csv(\"s3://navisite-dataset-test/incident-device.csv\");\nincident_device_df = incident_device_df.select(\n            incident_device_df.col(\"incident_id\").as(\"INCIDENT_DEV_ID\"),\n            incident_device_df.col(\"recon_id\").as(\"RECON_ID\")\n    );\n// incident_device_df.show();","user":"anonymous","dateUpdated":"2020-03-24T19:15:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"incident_device_df: org.apache.spark.sql.DataFrame = [INCIDENT_DEV_ID: string, RECON_ID: string]\nincident_device_df: org.apache.spark.sql.DataFrame = [INCIDENT_DEV_ID: string, RECON_ID: string]\n"}]},"apps":[],"jobName":"paragraph_1585062673054_1093892900","id":"20200229-035841_148039032","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:34+0000","dateFinished":"2020-03-24T19:15:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12482"},{"text":"var incident_recon_df = incident_df.join(incident_device_df, incident_df(\"INCIDENT_ID\") === incident_device_df(\"INCIDENT_DEV_ID\"), \"inner\").drop(\"INCIDENT_DEV_ID\");","user":"anonymous","dateUpdated":"2020-03-24T19:15:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"incident_recon_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 4 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673054_169665634","id":"20200229-035949_1007395544","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:35+0000","dateFinished":"2020-03-24T19:15:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12483"},{"text":"// incident_df.count();     //224770\n// incident_device_df.count(); //388200\n// incident_recon_df.show();","user":"anonymous","dateUpdated":"2020-03-24T19:15:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585062673054_-1593495909","id":"20200229-040410_2031397542","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:35+0000","dateFinished":"2020-03-24T19:15:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12484"},{"text":"var incident_details = incident_recon_df.join(event_code_mapped, incident_recon_df(\"EVENT_CODE\") === event_code_mapped(\"mapping_event_code\"), \"left_outer\").drop(\"mapping_event_code\");","user":"anonymous","dateUpdated":"2020-03-24T19:15:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"incident_details: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673055_-1642691665","id":"20200229-040435_790463357","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:35+0000","dateFinished":"2020-03-24T19:15:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12485"},{"text":"// incident_details.show();\n// incident_details.count();","user":"anonymous","dateUpdated":"2020-03-24T19:15:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585062673055_-165114982","id":"20200229-041807_1722846343","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:36+0000","dateFinished":"2020-03-24T19:15:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12486"},{"text":"var incident_details_df = incident_details.select(\n            col(\"INCIDENT_ID\"),\n            col(\"SUBMIT_DATE\"), \n            unix_timestamp(col(\"SUBMIT_DATE\"), \"dd-MMM-yyyy HH:mm:ss\").as(\"SUBMIT_DATE_MS\"),\n            col(\"BUS_ID\"),\n            col(\"EVENT_CODE\"),\n            col(\"RECON_ID\"),\n            col(\"event_code_id\").as(\"EVENT_CODE_ID\"),\n            col(\"Is_Source_Monitor\")\n            );\n// incident_details_df.show()","user":"anonymous","dateUpdated":"2020-03-24T19:15:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"incident_details_df: org.apache.spark.sql.DataFrame = [INCIDENT_ID: string, SUBMIT_DATE: string ... 6 more fields]\n"}]},"apps":[],"jobName":"paragraph_1585062673055_317401488","id":"20200229-042419_1640347198","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:36+0000","dateFinished":"2020-03-24T19:15:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12487"},{"text":"/* TODO ::: \nDataframes to load to database :\n1. event_logs_df\n2. incident_details_df\n*/","user":"anonymous","dateUpdated":"2020-03-24T19:15:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585062673056_2049858553","id":"20200229-041934_1171294660","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:36+0000","dateFinished":"2020-03-24T19:15:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12488"},{"text":"import java.util. Properties\nimport java.sql.{Connection, DriverManager}","user":"anonymous","dateUpdated":"2020-03-24T19:15:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import java.util.Properties\nimport java.sql.{Connection, DriverManager}\n"}]},"apps":[],"jobName":"paragraph_1585062673056_-805519275","id":"20200324-091118_1872924207","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T16:30:52+0000","dateFinished":"2020-03-24T16:30:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12489"},{"text":"//create properties object\nval prop = new java.util.Properties\nprop.setProperty(\"driver\", \"com.mysql.jdbc.Driver\")\nprop.setProperty(\"user\", \"admin\")\nprop.setProperty(\"password\", \"rdx-mysql\") \n\nval mysqlDBName = \"rdx\"\nval mysqlHost = \"rdx.ccbb7nilplok.us-east-1.rds.amazonaws.com\"\nval url = \"jdbc:mysql://\" + mysqlHost + \":3306/\" + mysqlDBName","user":"anonymous","dateUpdated":"2020-03-24T19:15:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"prop: java.util.Properties = {user=admin, password=rdx-mysql, driver=com.mysql.jdbc.Driver}\nmysqlDBName: String = rdx\nmysqlHost: String = rdx.ccbb7nilplok.us-east-1.rds.amazonaws.com\nurl: String = jdbc:mysql://rdx.ccbb7nilplok.us-east-1.rds.amazonaws.com:3306/rdx\n"}]},"apps":[],"jobName":"paragraph_1585062673057_692190727","id":"20200229-041820_525116366","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T16:30:52+0000","dateFinished":"2020-03-24T16:30:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12490"},{"text":"// load(append) event_logs_df into table - \nval EventTableName = \"event_logs\"\nevent_logs_df.write.mode(\"append\").jdbc(url, EventTableName, prop)","user":"anonymous","dateUpdated":"2020-03-24T19:15:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.lang.ClassNotFoundException: com.mysql.jdbc.Driver\n  at scala.reflect.internal.util.AbstractFileClassLoader.findClass(AbstractFileClassLoader.scala:62)\n  at java.lang.ClassLoader.loadClass(ClassLoader.java:419)\n  at java.lang.ClassLoader.loadClass(ClassLoader.java:352)\n  at org.apache.spark.sql.execution.datasources.jdbc.DriverRegistry$.register(DriverRegistry.scala:45)\n  at org.apache.spark.sql.execution.datasources.jdbc.JDBCOptions$$anonfun$5.apply(JDBCOptions.scala:99)\n  at org.apache.spark.sql.execution.datasources.jdbc.JDBCOptions$$anonfun$5.apply(JDBCOptions.scala:99)\n  at scala.Option.foreach(Option.scala:257)\n  at org.apache.spark.sql.execution.datasources.jdbc.JDBCOptions.<init>(JDBCOptions.scala:99)\n  at org.apache.spark.sql.execution.datasources.jdbc.JdbcOptionsInWrite.<init>(JDBCOptions.scala:197)\n  at org.apache.spark.sql.execution.datasources.jdbc.JdbcOptionsInWrite.<init>(JDBCOptions.scala:201)\n  at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:45)\n  at org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:45)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:86)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:156)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n  at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:83)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:83)\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:676)\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:676)\n  at org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:84)\n  at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:165)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:74)\n  at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:676)\n  at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:285)\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:271)\n  at org.apache.spark.sql.DataFrameWriter.jdbc(DataFrameWriter.scala:515)\n  ... 48 elided\n"}]},"apps":[],"jobName":"paragraph_1585062673057_1032045614","id":"20200303-071026_1856232868","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T16:30:53+0000","dateFinished":"2020-03-24T16:30:53+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:12491"},{"text":"// load(append) incident_details_df into table - \nval IncidentTableName = \"incident_details\"\nevent_logs_df.write.mode(\"append\").jdbc(url, IncidentTableName, prop)","user":"anonymous","dateUpdated":"2020-03-24T19:15:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585062673057_-91192545","id":"20200303-071159_1018100970","dateCreated":"2020-03-24T15:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:12492"},{"text":"/************************\n * write dataframe to .csv\n ************************/","user":"anonymous","dateUpdated":"2020-03-24T19:15:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585062673058_886213057","id":"20200303-201022_2144387572","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:36+0000","dateFinished":"2020-03-24T19:15:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12493"},{"text":"import org.apache.hadoop.conf.Configuration\nimport org.apache.hadoop.fs._","user":"anonymous","dateUpdated":"2020-03-24T19:15:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.hadoop.conf.Configuration\nimport org.apache.hadoop.fs._\n"}]},"apps":[],"jobName":"paragraph_1585062673058_626721893","id":"20200303-203837_1483383489","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:36+0000","dateFinished":"2020-03-24T19:15:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12494"},{"text":"// write event_logs_df to event-logs.csv\nevent_logs_df.write.format(\"com.databricks.spark.csv\").option(\"header\",\"true\").save(\"s3://navisite-dataset-test/event-logs_test.csv\")","user":"anonymous","dateUpdated":"2020-03-24T19:15:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585062673058_1059297258","id":"20200303-201111_824696589","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:15:37+0000","dateFinished":"2020-03-24T19:58:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12495"},{"text":"// save output into a single csv file\nevent_logs_df.repartition(1).write.format(\"com.databricks.spark.csv\").option(\"header\",\"true\").save(\"s3://navisite-dataset-test/event-logs-merged.csv\")","user":"anonymous","dateUpdated":"2020-03-24T19:58:53+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585062673059_119401719","id":"20200303-210535_1445221666","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T19:58:53+0000","dateFinished":"2020-03-24T20:58:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12496"},{"text":"// write incident_details_df to incident-details.csv\n incident_details_df.coalesce(1).write.format(\"com.databricks.spark.csv\").option(\"header\",\"true\").save(\"s3://navisite-dataset-test/incident-details.csv\")","user":"anonymous","dateUpdated":"2020-03-24T20:58:17+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585062673059_1190324852","id":"20200303-201550_647587879","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T20:58:17+0000","dateFinished":"2020-03-24T21:04:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12497"},{"text":" // save output into a single csv file\n incident_details_df.repartition(1).coalesce(1).write.format(\"com.databricks.spark.csv\").option(\"header\",\"true\").save(\"s3://navisite-dataset-test/incident-details-merged.csv\")","user":"anonymous","dateUpdated":"2020-03-24T21:04:43+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585062673059_1431298667","id":"20200303-210710_447329219","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T21:04:43+0000","dateFinished":"2020-03-24T21:11:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12498"},{"text":"event_logs_df.show()","user":"anonymous","dateUpdated":"2020-03-24T21:11:12+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585062673059_1637963221","id":"20200303-202316_674903915","dateCreated":"2020-03-24T15:11:13+0000","dateStarted":"2020-03-24T21:11:13+0000","status":"ABORT","progressUpdateIntervalMs":500,"$$hashKey":"object:12499","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.SparkException: Job 64 cancelled part of cancelled job group zeppelin-anonymous-2F53JBJWB-20200303-202316_674903915\n  at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:2041)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobCancellation(DAGScheduler.scala:1976)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply$mcVI$sp(DAGScheduler.scala:946)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:946)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:946)\n  at scala.collection.mutable.HashSet.foreach(HashSet.scala:78)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobGroupCancelled(DAGScheduler.scala:946)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:2231)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2211)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2200)\n  at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)\n  at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:777)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2061)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2082)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2101)\n  at org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:401)\n  at org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n  at org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collectFromPlan(Dataset.scala:3389)\n  at org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2550)\n  at org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2550)\n  at org.apache.spark.sql.Dataset$$anonfun$52.apply(Dataset.scala:3370)\n  at org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:84)\n  at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:165)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:74)\n  at org.apache.spark.sql.Dataset.withAction(Dataset.scala:3369)\n  at org.apache.spark.sql.Dataset.head(Dataset.scala:2550)\n  at org.apache.spark.sql.Dataset.take(Dataset.scala:2764)\n  at org.apache.spark.sql.Dataset.getRows(Dataset.scala:254)\n  at org.apache.spark.sql.Dataset.showString(Dataset.scala:291)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:751)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:710)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:719)\n  ... 51 elided\n"}]},"dateFinished":"2020-03-24T21:34:22+0000"},{"text":"incident_details_df.show();","user":"anonymous","dateUpdated":"2020-03-24T15:11:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585062673060_110048875","id":"20200305-010108_1433163181","dateCreated":"2020-03-24T15:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:12500"},{"user":"anonymous","dateUpdated":"2020-03-24T15:11:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585062673060_-799484002","id":"20200304-231013_509642549","dateCreated":"2020-03-24T15:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:12501"}],"name":"ETL2_v2","id":"2F53JBJWB","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}